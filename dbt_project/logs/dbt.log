[0m14:35:13.981876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002056C018E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002056B71FD50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002056F426F10>]}


============================== 14:35:13.986883 | aa152c01-34e5-4261-a6d8-62a998310121 ==============================
[0m14:35:13.986883 [info ] [MainThread]: Running with dbt=1.10.15
[0m14:35:13.987876 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug --profiles-dir .', 'target_path': 'None', 'cache_selected_only': 'False', 'warn_error': 'None', 'log_path': 'logs', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m14:35:14.013011 [info ] [MainThread]: dbt version: 1.10.15
[0m14:35:14.014010 [info ] [MainThread]: python version: 3.11.9
[0m14:35:14.014010 [info ] [MainThread]: python path: C:\Users\alexm\AppData\Local\Programs\Python\Python311\python.exe
[0m14:35:14.015003 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m14:35:16.310582 [info ] [MainThread]: Using profiles dir at .
[0m14:35:16.311582 [info ] [MainThread]: Using profiles.yml file at .\profiles.yml
[0m14:35:16.312583 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\dbt_project.yml
[0m14:35:16.312583 [info ] [MainThread]: adapter type: sqlserver
[0m14:35:16.313577 [info ] [MainThread]: adapter version: 1.9.0
[0m14:35:16.313577 [info ] [MainThread]: Configuration:
[0m14:35:16.314585 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:35:16.314585 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m14:35:16.315582 [info ] [MainThread]: Required dependencies:
[0m14:35:16.315582 [debug] [MainThread]: Executing "git --help"
[0m14:35:16.342351 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:35:16.343361 [debug] [MainThread]: STDERR: "b''"
[0m14:35:16.344359 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:35:16.344359 [info ] [MainThread]: Connection:
[0m14:35:16.345359 [info ] [MainThread]:   server: YOUR_SERVER_NAME.database.windows.net
[0m14:35:16.345359 [info ] [MainThread]:   database: sqldb-taxi-platform
[0m14:35:16.346353 [info ] [MainThread]:   schema: bronze
[0m14:35:16.346353 [info ] [MainThread]:   UID: YOUR_SQL_USERNAME
[0m14:35:16.346353 [info ] [MainThread]:   client_id: None
[0m14:35:16.347358 [info ] [MainThread]:   authentication: sql
[0m14:35:16.347358 [info ] [MainThread]:   encrypt: True
[0m14:35:16.347358 [info ] [MainThread]:   trust_cert: False
[0m14:35:16.348569 [info ] [MainThread]:   retries: 3
[0m14:35:16.348569 [info ] [MainThread]:   login_timeout: 0
[0m14:35:16.349575 [info ] [MainThread]:   query_timeout: 0
[0m14:35:16.350577 [info ] [MainThread]:   trace_flag: False
[0m14:35:16.350577 [info ] [MainThread]:   port: 1433
[0m14:35:16.350577 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m14:35:16.639638 [debug] [MainThread]: Acquiring new sqlserver connection 'debug'
[0m14:35:16.640637 [debug] [MainThread]: Using sqlserver connection "debug"
[0m14:35:16.640637 [debug] [MainThread]: On debug: select 1 as id
[0m14:35:16.640637 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:35:16.641607 [debug] [MainThread]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=YOUR_SERVER_NAME.database.windows.net,1433;Database=sqldb-taxi-platform;UID={YOUR_SQL_USERNAME};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m14:35:31.700322 [debug] [MainThread]: sqlserver adapter: Got a retryable error when attempting to open a sqlserver connection.
3 attempts remaining. Retrying in 1 seconds.
Error:
('08001', '[08001] [Microsoft][ODBC Driver 18 for SQL Server]TCP Provider: Este anfitri√£o n√£o √© conhecido.\r\n (11001) (SQLDriverConnect); [08001] [Microsoft][ODBC Driver 18 for SQL Server]Login timeout expired (0); [08001] [Microsoft][ODBC Driver 18 for SQL Server]A network-related or instance-specific error has occurred while establishing a connection to YOUR_SERVER_NAME.database.windows.net,1433. Server is not found or not accessible. Check if instance name is correct and if SQL Server is configured to allow remote connections. For more information see SQL Server Books Online. (11001)')
[0m14:35:32.701226 [debug] [MainThread]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=YOUR_SERVER_NAME.database.windows.net,1433;Database=sqldb-taxi-platform;UID={YOUR_SQL_USERNAME};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m14:35:47.717720 [debug] [MainThread]: sqlserver adapter: Got a retryable error when attempting to open a sqlserver connection.
2 attempts remaining. Retrying in 1 seconds.
Error:
('08001', '[08001] [Microsoft][ODBC Driver 18 for SQL Server]TCP Provider: Este anfitri√£o n√£o √© conhecido.\r\n (11001) (SQLDriverConnect); [08001] [Microsoft][ODBC Driver 18 for SQL Server]Login timeout expired (0); [08001] [Microsoft][ODBC Driver 18 for SQL Server]A network-related or instance-specific error has occurred while establishing a connection to YOUR_SERVER_NAME.database.windows.net,1433. Server is not found or not accessible. Check if instance name is correct and if SQL Server is configured to allow remote connections. For more information see SQL Server Books Online. (11001)')
[0m14:35:48.719823 [debug] [MainThread]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=YOUR_SERVER_NAME.database.windows.net,1433;Database=sqldb-taxi-platform;UID={YOUR_SQL_USERNAME};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m14:36:06.494017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC5A1CE9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC56B55950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC5A1D0E90>]}


============================== 14:36:06.497026 | 24ee4014-c050-4679-b6cc-ad982eb2ad17 ==============================
[0m14:36:06.497026 [info ] [MainThread]: Running with dbt=1.10.15
[0m14:36:06.498025 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'log_format': 'default', 'profiles_dir': '.', 'use_colors': 'True', 'target_path': 'None', 'warn_error': 'None', 'log_path': 'logs', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt debug --profiles-dir .', 'printer_width': '80', 'write_json': 'True'}
[0m14:36:06.513890 [info ] [MainThread]: dbt version: 1.10.15
[0m14:36:06.514902 [info ] [MainThread]: python version: 3.11.9
[0m14:36:06.514902 [info ] [MainThread]: python path: C:\Users\alexm\AppData\Local\Programs\Python\Python311\python.exe
[0m14:36:06.515900 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m14:36:06.515900 [info ] [MainThread]: Using profiles dir at .
[0m14:36:06.516898 [info ] [MainThread]: Using profiles.yml file at .\profiles.yml
[0m14:36:06.516898 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\dbt_project.yml
[0m14:36:06.517898 [info ] [MainThread]: Configuration:
[0m14:36:06.517898 [info ] [MainThread]:   profiles.yml file [[31mERROR not found[0m]
[0m14:36:06.517898 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m14:36:06.518890 [info ] [MainThread]: Required dependencies:
[0m14:36:06.518890 [debug] [MainThread]: Executing "git --help"
[0m14:36:06.543890 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:36:06.543890 [debug] [MainThread]: STDERR: "b''"
[0m14:36:06.544890 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:36:06.544890 [info ] [MainThread]: Connection test skipped since no profile was found
[0m14:36:06.545891 [info ] [MainThread]: [31m2 checks failed:[0m
[0m14:36:06.545891 [info ] [MainThread]: dbt looked for a profiles.yml file in .\profiles.yml, but did
not find one. For more information on configuring your profile, consult the
documentation:

https://docs.getdbt.com/docs/configure-your-profile


[0m14:36:06.546890 [info ] [MainThread]: Project loading failed for the following reason:
 project path <C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\dbt_project.yml> not found

[0m14:36:06.546890 [debug] [MainThread]: Command `dbt debug` failed at 14:36:06.546890 after 0.11 seconds
[0m14:36:06.547898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC59F76E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC53768FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC5A1CDA10>]}
[0m14:36:06.547898 [debug] [MainThread]: Flushing usage events
[0m14:36:07.359178 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:36:18.686289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027178A26710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027178C7E8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027178CDF810>]}


============================== 14:36:18.689820 | 53e77d54-f901-411f-8230-3a51a64e194a ==============================
[0m14:36:18.689820 [info ] [MainThread]: Running with dbt=1.10.15
[0m14:36:18.689820 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'profiles_dir': '.', 'cache_selected_only': 'False', 'invocation_command': 'dbt debug --profiles-dir .', 'no_print': 'None', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': 'logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m14:36:18.706846 [info ] [MainThread]: dbt version: 1.10.15
[0m14:36:18.707845 [info ] [MainThread]: python version: 3.11.9
[0m14:36:18.707845 [info ] [MainThread]: python path: C:\Users\alexm\AppData\Local\Programs\Python\Python311\python.exe
[0m14:36:18.708844 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m14:36:18.921926 [info ] [MainThread]: Using profiles dir at .
[0m14:36:18.922923 [info ] [MainThread]: Using profiles.yml file at .\profiles.yml
[0m14:36:18.922923 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\dbt_project.yml
[0m14:36:18.923917 [info ] [MainThread]: adapter type: sqlserver
[0m14:36:18.924917 [info ] [MainThread]: adapter version: 1.9.0
[0m14:36:18.924917 [info ] [MainThread]: Configuration:
[0m14:36:18.924917 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:36:18.925927 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m14:36:18.925927 [info ] [MainThread]: Required dependencies:
[0m14:36:18.926927 [debug] [MainThread]: Executing "git --help"
[0m14:36:18.951099 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:36:18.952091 [debug] [MainThread]: STDERR: "b''"
[0m14:36:18.952091 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:36:18.953101 [info ] [MainThread]: Connection:
[0m14:36:18.953101 [info ] [MainThread]:   server: YOUR_SERVER_NAME.database.windows.net
[0m14:36:18.954101 [info ] [MainThread]:   database: sqldb-taxi-platform
[0m14:36:18.954101 [info ] [MainThread]:   schema: bronze
[0m14:36:18.954101 [info ] [MainThread]:   UID: YOUR_SQL_USERNAME
[0m14:36:18.955090 [info ] [MainThread]:   client_id: None
[0m14:36:18.955090 [info ] [MainThread]:   authentication: sql
[0m14:36:18.956090 [info ] [MainThread]:   encrypt: True
[0m14:36:18.956090 [info ] [MainThread]:   trust_cert: False
[0m14:36:18.956090 [info ] [MainThread]:   retries: 3
[0m14:36:18.957099 [info ] [MainThread]:   login_timeout: 0
[0m14:36:18.957099 [info ] [MainThread]:   query_timeout: 0
[0m14:36:18.958091 [info ] [MainThread]:   trace_flag: False
[0m14:36:18.958091 [info ] [MainThread]:   port: 1433
[0m14:36:18.959090 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m14:36:19.175225 [debug] [MainThread]: Acquiring new sqlserver connection 'debug'
[0m14:36:19.175225 [debug] [MainThread]: Using sqlserver connection "debug"
[0m14:36:19.175225 [debug] [MainThread]: On debug: select 1 as id
[0m14:36:19.176218 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:36:19.176218 [debug] [MainThread]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=YOUR_SERVER_NAME.database.windows.net,1433;Database=sqldb-taxi-platform;UID={YOUR_SQL_USERNAME};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m14:36:34.208215 [debug] [MainThread]: sqlserver adapter: Got a retryable error when attempting to open a sqlserver connection.
3 attempts remaining. Retrying in 1 seconds.
Error:
('08001', '[08001] [Microsoft][ODBC Driver 18 for SQL Server]TCP Provider: Este anfitri√£o n√£o √© conhecido.\r\n (11001) (SQLDriverConnect); [08001] [Microsoft][ODBC Driver 18 for SQL Server]Login timeout expired (0); [08001] [Microsoft][ODBC Driver 18 for SQL Server]A network-related or instance-specific error has occurred while establishing a connection to YOUR_SERVER_NAME.database.windows.net,1433. Server is not found or not accessible. Check if instance name is correct and if SQL Server is configured to allow remote connections. For more information see SQL Server Books Online. (11001)')
[0m14:36:35.209921 [debug] [MainThread]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=YOUR_SERVER_NAME.database.windows.net,1433;Database=sqldb-taxi-platform;UID={YOUR_SQL_USERNAME};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m14:36:50.218159 [debug] [MainThread]: sqlserver adapter: Got a retryable error when attempting to open a sqlserver connection.
2 attempts remaining. Retrying in 1 seconds.
Error:
('08001', '[08001] [Microsoft][ODBC Driver 18 for SQL Server]TCP Provider: Este anfitri√£o n√£o √© conhecido.\r\n (11001) (SQLDriverConnect); [08001] [Microsoft][ODBC Driver 18 for SQL Server]Login timeout expired (0); [08001] [Microsoft][ODBC Driver 18 for SQL Server]A network-related or instance-specific error has occurred while establishing a connection to YOUR_SERVER_NAME.database.windows.net,1433. Server is not found or not accessible. Check if instance name is correct and if SQL Server is configured to allow remote connections. For more information see SQL Server Books Online. (11001)')
[0m14:36:51.219371 [debug] [MainThread]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=YOUR_SERVER_NAME.database.windows.net,1433;Database=sqldb-taxi-platform;UID={YOUR_SQL_USERNAME};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m14:37:34.465023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A839D1090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A83A29ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A83A2A710>]}


============================== 14:37:34.469024 | e61e12a6-6872-4dbd-82e5-f85afd029dd7 ==============================
[0m14:37:34.469024 [info ] [MainThread]: Running with dbt=1.10.15
[0m14:37:34.470023 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'profiles_dir': '.', 'target_path': 'None', 'invocation_command': 'dbt run --models gold --profiles-dir .', 'no_print': 'None', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'log_path': 'logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m14:37:34.470023 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m14:37:34.471024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e61e12a6-6872-4dbd-82e5-f85afd029dd7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A83A29F90>]}
[0m14:37:34.471024 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m14:37:34.472024 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m14:37:34.473023 [debug] [MainThread]: Command `dbt run` failed at 14:37:34.473023 after 0.09 seconds
[0m14:37:34.473023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028AFCF7F850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A83A353D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A83A343D0>]}
[0m14:37:34.474024 [debug] [MainThread]: Flushing usage events
[0m14:37:35.231223 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:40:04.830988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD20CA3690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD20CA2310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD20CA2ED0>]}


============================== 14:40:04.834988 | 61bb8826-ba62-4ece-894f-b9ba205d35e5 ==============================
[0m14:40:04.834988 [info ] [MainThread]: Running with dbt=1.10.15
[0m14:40:04.834988 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'profiles_dir': '.', 'use_colors': 'True', 'log_format': 'default', 'cache_selected_only': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\alexm\\Desktop\\python\\azure-taxi-platform\\dbt_project\\logs', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt debug --profiles-dir .', 'printer_width': '80', 'write_json': 'True'}
[0m14:40:04.854988 [info ] [MainThread]: dbt version: 1.10.15
[0m14:40:04.854988 [info ] [MainThread]: python version: 3.11.9
[0m14:40:04.855988 [info ] [MainThread]: python path: C:\Users\alexm\AppData\Local\Programs\Python\Python311\python.exe
[0m14:40:04.855988 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m14:40:05.089531 [info ] [MainThread]: Using profiles dir at .
[0m14:40:05.090531 [info ] [MainThread]: Using profiles.yml file at .\profiles.yml
[0m14:40:05.091531 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\dbt_project.yml
[0m14:40:05.091531 [info ] [MainThread]: adapter type: sqlserver
[0m14:40:05.092531 [info ] [MainThread]: adapter version: 1.9.0
[0m14:40:05.165192 [info ] [MainThread]: Configuration:
[0m14:40:05.166147 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:40:05.167133 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:40:05.167133 [info ] [MainThread]: Required dependencies:
[0m14:40:05.168147 [debug] [MainThread]: Executing "git --help"
[0m14:40:05.193208 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:40:05.194197 [debug] [MainThread]: STDERR: "b''"
[0m14:40:05.194197 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:40:05.195197 [info ] [MainThread]: Connection:
[0m14:40:05.196198 [info ] [MainThread]:   server: sqlserver-taxi-alex.database.windows.net
[0m14:40:05.196198 [info ] [MainThread]:   database: sqldb-taxi-platform
[0m14:40:05.197197 [info ] [MainThread]:   schema: bronze
[0m14:40:05.197197 [info ] [MainThread]:   UID: sqladmin
[0m14:40:05.197197 [info ] [MainThread]:   client_id: None
[0m14:40:05.198198 [info ] [MainThread]:   authentication: sql
[0m14:40:05.198198 [info ] [MainThread]:   encrypt: True
[0m14:40:05.198198 [info ] [MainThread]:   trust_cert: False
[0m14:40:05.199198 [info ] [MainThread]:   retries: 3
[0m14:40:05.199198 [info ] [MainThread]:   login_timeout: 0
[0m14:40:05.200198 [info ] [MainThread]:   query_timeout: 0
[0m14:40:05.200198 [info ] [MainThread]:   trace_flag: False
[0m14:40:05.200198 [info ] [MainThread]:   port: 1433
[0m14:40:05.201197 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m14:40:05.427534 [debug] [MainThread]: Acquiring new sqlserver connection 'debug'
[0m14:40:05.428541 [debug] [MainThread]: Using sqlserver connection "debug"
[0m14:40:05.428541 [debug] [MainThread]: On debug: select 1 as id
[0m14:40:05.429541 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:40:05.429541 [debug] [MainThread]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m14:40:06.091963 [debug] [MainThread]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m14:40:06.141330 [debug] [MainThread]: SQL status: OK in 1.000 seconds
[0m14:40:06.142341 [debug] [MainThread]: On debug: Close
[0m14:40:06.142341 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:40:06.143342 [info ] [MainThread]: [32mAll checks passed![0m
[0m14:40:06.144341 [debug] [MainThread]: Command `dbt debug` succeeded at 14:40:06.144341 after 1.39 seconds
[0m14:40:06.144341 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:40:06.145340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD1A29F6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD224CA390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BD20939C10>]}
[0m14:40:06.145340 [debug] [MainThread]: Flushing usage events
[0m14:40:06.881045 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:41:19.381135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018569391F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018568318F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018569391550>]}


============================== 14:41:19.384134 | f9eb6e23-40f7-4c60-bd3a-085161bc8c86 ==============================
[0m14:41:19.384134 [info ] [MainThread]: Running with dbt=1.10.15
[0m14:41:19.385134 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'write_json': 'True', 'use_colors': 'True', 'no_print': 'None', 'profiles_dir': '.', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'log_path': 'C:\\Users\\alexm\\Desktop\\python\\azure-taxi-platform\\dbt_project\\logs', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models bronze.stg_trips --profiles-dir .', 'printer_width': '80', 'target_path': 'None'}
[0m14:41:19.385757 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m14:41:19.385757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f9eb6e23-40f7-4c60-bd3a-085161bc8c86', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001856938E610>]}
[0m14:41:19.739984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f9eb6e23-40f7-4c60-bd3a-085161bc8c86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001856AB098D0>]}
[0m14:41:19.783607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f9eb6e23-40f7-4c60-bd3a-085161bc8c86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018568399490>]}
[0m14:41:19.784607 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m14:41:20.031706 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m14:41:20.032710 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:41:20.033707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f9eb6e23-40f7-4c60-bd3a-085161bc8c86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001856AC13390>]}
[0m14:41:21.986876 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.taxi_nyc_project.gold
- models.taxi_nyc_project.silver
[0m14:41:21.991877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f9eb6e23-40f7-4c60-bd3a-085161bc8c86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001856AD0AD90>]}
[0m14:41:22.034381 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\manifest.json
[0m14:41:22.036381 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\semantic_manifest.json
[0m14:41:22.059382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f9eb6e23-40f7-4c60-bd3a-085161bc8c86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001856B1AF0D0>]}
[0m14:41:22.059382 [info ] [MainThread]: Found 1 model, 535 macros
[0m14:41:22.060383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9eb6e23-40f7-4c60-bd3a-085161bc8c86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001856AF83990>]}
[0m14:41:22.061382 [info ] [MainThread]: 
[0m14:41:22.062383 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:41:22.062383 [info ] [MainThread]: 
[0m14:41:22.063382 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m14:41:22.064396 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_sqldb-taxi-platform'
[0m14:41:22.075910 [debug] [ThreadPool]: dbt-sqlserver
[0m14:41:22.076910 [debug] [ThreadPool]: Using sqlserver connection "list_sqldb-taxi-platform"
[0m14:41:22.076910 [debug] [ThreadPool]: On list_sqldb-taxi-platform: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "list_sqldb-taxi-platform"} */
USE [sqldb-taxi-platform];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m14:41:22.076910 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:41:22.077911 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m14:41:22.686615 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m14:41:22.733727 [debug] [ThreadPool]: SQL status: OK in 1.000 seconds
[0m14:41:22.735757 [debug] [ThreadPool]: On list_sqldb-taxi-platform: Close
[0m14:41:22.737036 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sqldb-taxi-platform, now create_sqldb-taxi-platform_bronze_bronze)
[0m14:41:22.737036 [debug] [ThreadPool]: Creating schema "database: "sqldb-taxi-platform"
schema: "bronze_bronze"
"
[0m14:41:22.741041 [debug] [ThreadPool]: Using sqlserver connection "create_sqldb-taxi-platform_bronze_bronze"
[0m14:41:22.741041 [debug] [ThreadPool]: On create_sqldb-taxi-platform_bronze_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "create_sqldb-taxi-platform_bronze_bronze"} */
USE [sqldb-taxi-platform];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'bronze_bronze')
    BEGIN
    EXEC('CREATE SCHEMA [bronze_bronze]')
    END
  
[0m14:41:22.742041 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:41:22.742041 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m14:41:22.742041 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m14:41:22.811783 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:41:22.812780 [debug] [ThreadPool]: On create_sqldb-taxi-platform_bronze_bronze: COMMIT
[0m14:41:22.812780 [debug] [ThreadPool]: On create_sqldb-taxi-platform_bronze_bronze: Close
[0m14:41:22.814780 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_sqldb-taxi-platform_bronze_bronze'
[0m14:41:22.819787 [debug] [ThreadPool]: dbt-sqlserver
[0m14:41:22.820781 [debug] [ThreadPool]: Using sqlserver connection "list_sqldb-taxi-platform_bronze_bronze"
[0m14:41:22.820781 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "list_sqldb-taxi-platform_bronze_bronze"} */
USE [sqldb-taxi-platform];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze_bronze'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m14:41:22.820781 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:41:22.821781 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m14:41:22.821781 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m14:41:22.893468 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:41:22.895476 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_bronze: ROLLBACK
[0m14:41:22.896617 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_bronze: Close
[0m14:41:22.896617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9eb6e23-40f7-4c60-bd3a-085161bc8c86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001856AFED3D0>]}
[0m14:41:22.897617 [debug] [MainThread]: On master: COMMIT
[0m14:41:22.901617 [debug] [Thread-1 (]: Began running node model.taxi_nyc_project.stg_trips
[0m14:41:22.902629 [info ] [Thread-1 (]: 1 of 1 START sql table model bronze_bronze.stg_trips ........................... [RUN]
[0m14:41:22.902629 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.taxi_nyc_project.stg_trips'
[0m14:41:22.903630 [debug] [Thread-1 (]: Began compiling node model.taxi_nyc_project.stg_trips
[0m14:41:22.909624 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_nyc_project.stg_trips"
[0m14:41:22.911617 [debug] [Thread-1 (]: Began executing node model.taxi_nyc_project.stg_trips
[0m14:41:22.941510 [debug] [Thread-1 (]: dbt-sqlserver
[0m14:41:22.946512 [debug] [Thread-1 (]: Applying DROP to: "sqldb-taxi-platform"."bronze_bronze"."stg_trips__dbt_tmp__dbt_tmp_vw"
[0m14:41:22.951511 [debug] [Thread-1 (]: dbt-sqlserver
[0m14:41:22.951511 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.stg_trips"
[0m14:41:22.952504 [debug] [Thread-1 (]: On model.taxi_nyc_project.stg_trips: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.stg_trips"} */

        USE [sqldb-taxi-platform];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'sqldb-taxi-platform'
        and refs.referenced_schema_name = 'bronze_bronze'
        and refs.referenced_entity_name = 'stg_trips__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m14:41:22.952504 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:41:22.952504 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m14:41:22.953511 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m14:41:23.011275 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:41:23.013299 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.stg_trips"
[0m14:41:23.013299 [debug] [Thread-1 (]: On model.taxi_nyc_project.stg_trips: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.stg_trips"} */

      
      
    
    USE [sqldb-taxi-platform];
    EXEC('DROP view IF EXISTS "bronze_bronze"."stg_trips__dbt_tmp__dbt_tmp_vw";');

[0m14:41:23.057213 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:41:23.067218 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_nyc_project.stg_trips"
[0m14:41:23.070222 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.stg_trips"
[0m14:41:23.070222 [debug] [Thread-1 (]: On model.taxi_nyc_project.stg_trips: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.stg_trips"} */

  
    USE [sqldb-taxi-platform];
    USE [sqldb-taxi-platform];
    
    

    

    
    USE [sqldb-taxi-platform];
    EXEC('
        create view "bronze_bronze"."stg_trips__dbt_tmp__dbt_tmp_vw" as 

select
    cast(VendorID as int)                             as vendor_id,
    cast(tpep_pickup_datetime as datetime2)           as pickup_datetime,
    cast(tpep_dropoff_datetime as datetime2)          as dropoff_datetime,
    cast(passenger_count as int)                      as passenger_count,
    cast(trip_distance as float)                      as trip_distance,
    cast(RatecodeID as int)                           as rate_code_id,
    upper(store_and_fwd_flag)                         as store_and_fwd_flag,
    cast(PULocationID as int)                         as pu_location_id,
    cast(DOLocationID as int)                         as do_location_id,
    cast(payment_type as int)                         as payment_type,
    cast(fare_amount as decimal(10,2))                as fare_amount,
    cast(extra as decimal(10,2))                      as extra,
    cast(mta_tax as decimal(10,2))                    as mta_tax,
    cast(tip_amount as decimal(10,2))                 as tip_amount,
    cast(tolls_amount as decimal(10,2))               as tolls_amount,
    cast(improvement_surcharge as decimal(10,2))      as improvement_surcharge,
    cast(total_amount as decimal(10,2))               as total_amount,
    cast(congestion_surcharge as decimal(10,2))       as congestion_surcharge,
    cast(Airport_fee as decimal(10,2))                as airport_fee,
    cast(cbd_congestion_fee as decimal(10,2))         as cbd_congestion_fee
from raw.yellow_trips_2025_08
where
    trip_distance >= 0
    and fare_amount >= 0
    and total_amount >= 0
    and tpep_pickup_datetime is not null
    and tpep_dropoff_datetime is not null
    and tpep_dropoff_datetime >= tpep_pickup_datetime;;
    ')

EXEC('
            SELECT * INTO "sqldb-taxi-platform"."bronze_bronze"."stg_trips__dbt_tmp" FROM "sqldb-taxi-platform"."bronze_bronze"."stg_trips__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS bronze_bronze.stg_trips__dbt_tmp__dbt_tmp_vw')



    
    use [sqldb-taxi-platform];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'bronze_bronze_stg_trips__dbt_tmp_cci'
        AND object_id=object_id('bronze_bronze_stg_trips__dbt_tmp')
    )
    DROP index "bronze_bronze"."stg_trips__dbt_tmp".bronze_bronze_stg_trips__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX bronze_bronze_stg_trips__dbt_tmp_cci
    ON "bronze_bronze"."stg_trips__dbt_tmp"

   


  
[0m14:41:46.808908 [debug] [Thread-1 (]: SQL status: OK in 24.000 seconds
[0m14:41:46.814910 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.stg_trips"
[0m14:41:46.814910 [debug] [Thread-1 (]: On model.taxi_nyc_project.stg_trips: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.stg_trips"} */
USE [sqldb-taxi-platform];
      EXEC sp_rename 'bronze_bronze.stg_trips__dbt_tmp', 'stg_trips'
[0m14:41:47.119744 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:41:47.133387 [debug] [Thread-1 (]: On model.taxi_nyc_project.stg_trips: COMMIT
[0m14:41:47.135963 [debug] [Thread-1 (]: Applying DROP to: "sqldb-taxi-platform"."bronze_bronze"."stg_trips__dbt_backup"
[0m14:41:47.137056 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.stg_trips"
[0m14:41:47.137056 [debug] [Thread-1 (]: On model.taxi_nyc_project.stg_trips: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.stg_trips"} */

      
    USE [sqldb-taxi-platform];
    EXEC('DROP table IF EXISTS "bronze_bronze"."stg_trips__dbt_backup";');

[0m14:41:47.182851 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:41:47.185426 [debug] [Thread-1 (]: On model.taxi_nyc_project.stg_trips: Close
[0m14:41:47.187451 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9eb6e23-40f7-4c60-bd3a-085161bc8c86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001856AEDC050>]}
[0m14:41:47.188453 [info ] [Thread-1 (]: 1 of 1 OK created sql table model bronze_bronze.stg_trips ...................... [[32mOK[0m in 24.28s]
[0m14:41:47.189452 [debug] [Thread-1 (]: Finished running node model.taxi_nyc_project.stg_trips
[0m14:41:47.190518 [debug] [MainThread]: On master: COMMIT
[0m14:41:47.191070 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:41:47.191632 [debug] [MainThread]: Connection 'create_sqldb-taxi-platform_bronze_bronze' was properly closed.
[0m14:41:47.192178 [debug] [MainThread]: Connection 'list_sqldb-taxi-platform_bronze_bronze' was properly closed.
[0m14:41:47.192178 [debug] [MainThread]: Connection 'model.taxi_nyc_project.stg_trips' was properly closed.
[0m14:41:47.192178 [info ] [MainThread]: 
[0m14:41:47.193154 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 25.13 seconds (25.13s).
[0m14:41:47.193154 [debug] [MainThread]: Command end result
[0m14:41:47.213596 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\manifest.json
[0m14:41:47.216349 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\semantic_manifest.json
[0m14:41:47.221215 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\run_results.json
[0m14:41:47.221800 [info ] [MainThread]: 
[0m14:41:47.222336 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:41:47.222863 [info ] [MainThread]: 
[0m14:41:47.223388 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m14:41:47.224383 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m14:41:47.225391 [debug] [MainThread]: Command `dbt run` succeeded at 14:41:47.225391 after 27.91 seconds
[0m14:41:47.225391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001856295F8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185693F3490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001856938DB10>]}
[0m14:41:47.225391 [debug] [MainThread]: Flushing usage events
[0m14:41:48.004365 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:46:37.033854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BD87036D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BD84A63D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BD8735A90>]}


============================== 14:46:37.036863 | a928549b-7f8b-4241-92ab-778588441f52 ==============================
[0m14:46:37.036863 [info ] [MainThread]: Running with dbt=1.10.15
[0m14:46:37.037863 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'log_format': 'default', 'cache_selected_only': 'False', 'write_json': 'True', 'use_colors': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\alexm\\Desktop\\python\\azure-taxi-platform\\dbt_project\\logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': '.', 'invocation_command': 'dbt run --models silver.fact_trips --profiles-dir .', 'printer_width': '80', 'target_path': 'None'}
[0m14:46:37.037863 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m14:46:37.038862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a928549b-7f8b-4241-92ab-778588441f52', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BD87696D0>]}
[0m14:46:37.348604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a928549b-7f8b-4241-92ab-778588441f52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BD5DF8710>]}
[0m14:46:37.392190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a928549b-7f8b-4241-92ab-778588441f52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BD9F91AD0>]}
[0m14:46:37.392190 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m14:46:37.623185 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m14:46:37.742553 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:46:37.742553 [debug] [MainThread]: Partial parsing: added file: taxi_nyc_project://models\silver\fact_trips.sql
[0m14:46:37.943748 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.taxi_nyc_project.gold
[0m14:46:37.947772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a928549b-7f8b-4241-92ab-778588441f52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BD8748950>]}
[0m14:46:37.991260 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\manifest.json
[0m14:46:37.993259 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\semantic_manifest.json
[0m14:46:38.014005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a928549b-7f8b-4241-92ab-778588441f52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BDA2CFB90>]}
[0m14:46:38.014005 [info ] [MainThread]: Found 2 models, 535 macros
[0m14:46:38.015013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a928549b-7f8b-4241-92ab-778588441f52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BDA4BADD0>]}
[0m14:46:38.016013 [info ] [MainThread]: 
[0m14:46:38.017006 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:46:38.017006 [info ] [MainThread]: 
[0m14:46:38.018013 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m14:46:38.019005 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_sqldb-taxi-platform'
[0m14:46:38.031017 [debug] [ThreadPool]: dbt-sqlserver
[0m14:46:38.031017 [debug] [ThreadPool]: Using sqlserver connection "list_sqldb-taxi-platform"
[0m14:46:38.031017 [debug] [ThreadPool]: On list_sqldb-taxi-platform: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "list_sqldb-taxi-platform"} */
USE [sqldb-taxi-platform];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m14:46:38.032017 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:46:38.032017 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m14:46:38.666817 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m14:46:38.717044 [debug] [ThreadPool]: SQL status: OK in 1.000 seconds
[0m14:46:38.718305 [debug] [ThreadPool]: On list_sqldb-taxi-platform: Close
[0m14:46:38.719043 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sqldb-taxi-platform, now create_sqldb-taxi-platform_bronze_silver)
[0m14:46:38.719043 [debug] [ThreadPool]: Creating schema "database: "sqldb-taxi-platform"
schema: "bronze_silver"
"
[0m14:46:38.723050 [debug] [ThreadPool]: Using sqlserver connection "create_sqldb-taxi-platform_bronze_silver"
[0m14:46:38.723050 [debug] [ThreadPool]: On create_sqldb-taxi-platform_bronze_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "create_sqldb-taxi-platform_bronze_silver"} */
USE [sqldb-taxi-platform];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'bronze_silver')
    BEGIN
    EXEC('CREATE SCHEMA [bronze_silver]')
    END
  
[0m14:46:38.723050 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:46:38.724054 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m14:46:38.724054 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m14:46:38.792274 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:46:38.793273 [debug] [ThreadPool]: On create_sqldb-taxi-platform_bronze_silver: COMMIT
[0m14:46:38.793273 [debug] [ThreadPool]: On create_sqldb-taxi-platform_bronze_silver: Close
[0m14:46:38.794274 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_sqldb-taxi-platform_bronze_bronze'
[0m14:46:38.799273 [debug] [ThreadPool]: dbt-sqlserver
[0m14:46:38.799273 [debug] [ThreadPool]: Using sqlserver connection "list_sqldb-taxi-platform_bronze_bronze"
[0m14:46:38.799273 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "list_sqldb-taxi-platform_bronze_bronze"} */
USE [sqldb-taxi-platform];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze_bronze'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m14:46:38.800274 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:46:38.800274 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m14:46:38.801266 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m14:46:38.852908 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:46:38.853900 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_bronze: ROLLBACK
[0m14:46:38.853900 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_bronze: Close
[0m14:46:38.855065 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sqldb-taxi-platform_bronze_bronze, now list_sqldb-taxi-platform_bronze_silver)
[0m14:46:38.857024 [debug] [ThreadPool]: dbt-sqlserver
[0m14:46:38.857024 [debug] [ThreadPool]: Using sqlserver connection "list_sqldb-taxi-platform_bronze_silver"
[0m14:46:38.857024 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "list_sqldb-taxi-platform_bronze_silver"} */
USE [sqldb-taxi-platform];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze_silver'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m14:46:38.858034 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:46:38.858034 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m14:46:38.858034 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m14:46:38.930162 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:46:38.931176 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_silver: ROLLBACK
[0m14:46:38.931176 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_silver: Close
[0m14:46:38.932174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a928549b-7f8b-4241-92ab-778588441f52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BDA5124D0>]}
[0m14:46:38.932174 [debug] [MainThread]: On master: COMMIT
[0m14:46:38.936176 [debug] [Thread-1 (]: Began running node model.taxi_nyc_project.fact_trips
[0m14:46:38.937229 [info ] [Thread-1 (]: 1 of 1 START sql table model bronze_silver.fact_trips .......................... [RUN]
[0m14:46:38.937229 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.taxi_nyc_project.fact_trips'
[0m14:46:38.938175 [debug] [Thread-1 (]: Began compiling node model.taxi_nyc_project.fact_trips
[0m14:46:38.944180 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_nyc_project.fact_trips"
[0m14:46:38.945176 [debug] [Thread-1 (]: Began executing node model.taxi_nyc_project.fact_trips
[0m14:46:38.976176 [debug] [Thread-1 (]: dbt-sqlserver
[0m14:46:38.981176 [debug] [Thread-1 (]: Applying DROP to: "sqldb-taxi-platform"."bronze_silver"."fact_trips__dbt_tmp__dbt_tmp_vw"
[0m14:46:38.985186 [debug] [Thread-1 (]: dbt-sqlserver
[0m14:46:38.986187 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.fact_trips"
[0m14:46:38.986187 [debug] [Thread-1 (]: On model.taxi_nyc_project.fact_trips: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.fact_trips"} */

        USE [sqldb-taxi-platform];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'sqldb-taxi-platform'
        and refs.referenced_schema_name = 'bronze_silver'
        and refs.referenced_entity_name = 'fact_trips__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m14:46:38.986187 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:46:38.987186 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m14:46:38.987186 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m14:46:39.047865 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:46:39.049808 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.fact_trips"
[0m14:46:39.049808 [debug] [Thread-1 (]: On model.taxi_nyc_project.fact_trips: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.fact_trips"} */

      
      
    
    USE [sqldb-taxi-platform];
    EXEC('DROP view IF EXISTS "bronze_silver"."fact_trips__dbt_tmp__dbt_tmp_vw";');

[0m14:46:39.098416 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:46:39.108354 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_nyc_project.fact_trips"
[0m14:46:39.114355 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.fact_trips"
[0m14:46:39.114355 [debug] [Thread-1 (]: On model.taxi_nyc_project.fact_trips: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.fact_trips"} */

  
    USE [sqldb-taxi-platform];
    USE [sqldb-taxi-platform];
    
    

    

    
    USE [sqldb-taxi-platform];
    EXEC('
        create view "bronze_silver"."fact_trips__dbt_tmp__dbt_tmp_vw" as 

with base as (

    select
        -- simple surrogate key
        cast(
            row_number() over (
                order by pickup_datetime, pu_location_id, do_location_id
            ) as bigint
        )                                           as trip_id,

        -- time fields
        pickup_datetime,
        dropoff_datetime,
        datediff(minute, pickup_datetime, dropoff_datetime)
                                                    as trip_duration_minutes,
        cast(pickup_datetime as date)               as pickup_date,
        datepart(hour, pickup_datetime)             as pickup_hour,
        datename(weekday, pickup_datetime)          as pickup_day_name,
        datepart(weekday, pickup_datetime)          as pickup_day_of_week,

        -- original numeric fields
        passenger_count,
        trip_distance,
        rate_code_id,
        pu_location_id,
        do_location_id,
        payment_type,
        fare_amount,
        extra,
        mta_tax,
        tip_amount,
        tolls_amount,
        improvement_surcharge,
        total_amount,
        congestion_surcharge,
        airport_fee,
        cbd_congestion_fee

    from "sqldb-taxi-platform"."bronze_bronze"."stg_trips"

)

select
    *,
    case 
        when fare_amount > 0 
            then cast(tip_amount / fare_amount * 100.0 as float)
        else null
    end                                             as tip_pct
from base;;
    ')

EXEC('
            SELECT * INTO "sqldb-taxi-platform"."bronze_silver"."fact_trips__dbt_tmp" FROM "sqldb-taxi-platform"."bronze_silver"."fact_trips__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS bronze_silver.fact_trips__dbt_tmp__dbt_tmp_vw')



    
    use [sqldb-taxi-platform];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'bronze_silver_fact_trips__dbt_tmp_cci'
        AND object_id=object_id('bronze_silver_fact_trips__dbt_tmp')
    )
    DROP index "bronze_silver"."fact_trips__dbt_tmp".bronze_silver_fact_trips__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX bronze_silver_fact_trips__dbt_tmp_cci
    ON "bronze_silver"."fact_trips__dbt_tmp"

   


  
[0m14:47:09.594078 [debug] [Thread-1 (]: SQL status: OK in 30.000 seconds
[0m14:47:09.600086 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.fact_trips"
[0m14:47:09.600086 [debug] [Thread-1 (]: On model.taxi_nyc_project.fact_trips: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.fact_trips"} */
USE [sqldb-taxi-platform];
      EXEC sp_rename 'bronze_silver.fact_trips__dbt_tmp', 'fact_trips'
[0m14:47:09.653393 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:47:09.665990 [debug] [Thread-1 (]: On model.taxi_nyc_project.fact_trips: COMMIT
[0m14:47:09.668992 [debug] [Thread-1 (]: Applying DROP to: "sqldb-taxi-platform"."bronze_silver"."fact_trips__dbt_backup"
[0m14:47:09.668992 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.fact_trips"
[0m14:47:09.669990 [debug] [Thread-1 (]: On model.taxi_nyc_project.fact_trips: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.fact_trips"} */

      
    USE [sqldb-taxi-platform];
    EXEC('DROP table IF EXISTS "bronze_silver"."fact_trips__dbt_backup";');

[0m14:47:09.718352 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:47:09.720351 [debug] [Thread-1 (]: On model.taxi_nyc_project.fact_trips: Close
[0m14:47:09.722717 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a928549b-7f8b-4241-92ab-778588441f52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BDA4DAF90>]}
[0m14:47:09.722717 [info ] [Thread-1 (]: 1 of 1 OK created sql table model bronze_silver.fact_trips ..................... [[32mOK[0m in 30.78s]
[0m14:47:09.723786 [debug] [Thread-1 (]: Finished running node model.taxi_nyc_project.fact_trips
[0m14:47:09.725734 [debug] [MainThread]: On master: COMMIT
[0m14:47:09.725734 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:47:09.725734 [debug] [MainThread]: Connection 'create_sqldb-taxi-platform_bronze_silver' was properly closed.
[0m14:47:09.726731 [debug] [MainThread]: Connection 'list_sqldb-taxi-platform_bronze_silver' was properly closed.
[0m14:47:09.726731 [debug] [MainThread]: Connection 'model.taxi_nyc_project.fact_trips' was properly closed.
[0m14:47:09.726731 [info ] [MainThread]: 
[0m14:47:09.727723 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 31.71 seconds (31.71s).
[0m14:47:09.728386 [debug] [MainThread]: Command end result
[0m14:47:09.747405 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\manifest.json
[0m14:47:09.750405 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\semantic_manifest.json
[0m14:47:09.755397 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\run_results.json
[0m14:47:09.755397 [info ] [MainThread]: 
[0m14:47:09.756397 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:47:09.756397 [info ] [MainThread]: 
[0m14:47:09.757397 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m14:47:09.758404 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m14:47:09.759398 [debug] [MainThread]: Command `dbt run` succeeded at 14:47:09.759398 after 32.79 seconds
[0m14:47:09.759398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BD1D0F8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BD5CCA790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BD1C991D0>]}
[0m14:47:09.760398 [debug] [MainThread]: Flushing usage events
[0m14:47:10.539226 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:50:24.479280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002178480C190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002178480DFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002178480FA90>]}


============================== 14:50:24.483280 | dfdeafe6-d3bf-4d1c-bfbb-216798b15cee ==============================
[0m14:50:24.483280 [info ] [MainThread]: Running with dbt=1.10.15
[0m14:50:24.483280 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '.', 'use_colors': 'True', 'no_print': 'None', 'printer_width': '80', 'write_json': 'True', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\alexm\\Desktop\\python\\azure-taxi-platform\\dbt_project\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models gold --profiles-dir .', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m14:50:24.484280 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m14:50:24.484280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'dfdeafe6-d3bf-4d1c-bfbb-216798b15cee', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021784841F90>]}
[0m14:50:24.812846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dfdeafe6-d3bf-4d1c-bfbb-216798b15cee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021786142410>]}
[0m14:50:24.857544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dfdeafe6-d3bf-4d1c-bfbb-216798b15cee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217838094D0>]}
[0m14:50:24.858544 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m14:50:25.084680 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m14:50:25.218926 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 4 files added, 0 files changed.
[0m14:50:25.218926 [debug] [MainThread]: Partial parsing: added file: taxi_nyc_project://models\gold\mart_zone_revenue.sql
[0m14:50:25.219927 [debug] [MainThread]: Partial parsing: added file: taxi_nyc_project://models\gold\mart_trips_by_hour.sql
[0m14:50:25.219927 [debug] [MainThread]: Partial parsing: added file: taxi_nyc_project://models\gold\mart_daily_revenue.sql
[0m14:50:25.219927 [debug] [MainThread]: Partial parsing: added file: taxi_nyc_project://models\gold\mart_tip_by_payment_type.sql
[0m14:50:25.433444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dfdeafe6-d3bf-4d1c-bfbb-216798b15cee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217863AC6D0>]}
[0m14:50:25.475533 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\manifest.json
[0m14:50:25.477533 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\semantic_manifest.json
[0m14:50:25.499073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dfdeafe6-d3bf-4d1c-bfbb-216798b15cee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217863E8C10>]}
[0m14:50:25.499073 [info ] [MainThread]: Found 6 models, 535 macros
[0m14:50:25.500064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dfdeafe6-d3bf-4d1c-bfbb-216798b15cee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002178667F750>]}
[0m14:50:25.502071 [info ] [MainThread]: 
[0m14:50:25.502071 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:50:25.503072 [info ] [MainThread]: 
[0m14:50:25.503072 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m14:50:25.507624 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_sqldb-taxi-platform'
[0m14:50:25.519766 [debug] [ThreadPool]: dbt-sqlserver
[0m14:50:25.520275 [debug] [ThreadPool]: Using sqlserver connection "list_sqldb-taxi-platform"
[0m14:50:25.520275 [debug] [ThreadPool]: On list_sqldb-taxi-platform: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "list_sqldb-taxi-platform"} */
USE [sqldb-taxi-platform];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m14:50:25.520275 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:25.521275 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m14:50:26.084893 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m14:50:26.128891 [debug] [ThreadPool]: SQL status: OK in 1.000 seconds
[0m14:50:26.130884 [debug] [ThreadPool]: On list_sqldb-taxi-platform: Close
[0m14:50:26.131884 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sqldb-taxi-platform, now create_sqldb-taxi-platform_bronze_gold)
[0m14:50:26.132884 [debug] [ThreadPool]: Creating schema "database: "sqldb-taxi-platform"
schema: "bronze_gold"
"
[0m14:50:26.135885 [debug] [ThreadPool]: Using sqlserver connection "create_sqldb-taxi-platform_bronze_gold"
[0m14:50:26.136896 [debug] [ThreadPool]: On create_sqldb-taxi-platform_bronze_gold: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "create_sqldb-taxi-platform_bronze_gold"} */
USE [sqldb-taxi-platform];
    IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'bronze_gold')
    BEGIN
    EXEC('CREATE SCHEMA [bronze_gold]')
    END
  
[0m14:50:26.136896 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:50:26.136896 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m14:50:26.137893 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m14:50:26.198585 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:50:26.199576 [debug] [ThreadPool]: On create_sqldb-taxi-platform_bronze_gold: COMMIT
[0m14:50:26.200583 [debug] [ThreadPool]: On create_sqldb-taxi-platform_bronze_gold: Close
[0m14:50:26.201577 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_sqldb-taxi-platform_bronze_gold'
[0m14:50:26.206583 [debug] [ThreadPool]: dbt-sqlserver
[0m14:50:26.206583 [debug] [ThreadPool]: Using sqlserver connection "list_sqldb-taxi-platform_bronze_gold"
[0m14:50:26.207577 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_gold: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "list_sqldb-taxi-platform_bronze_gold"} */
USE [sqldb-taxi-platform];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze_gold'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m14:50:26.207577 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:26.207577 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m14:50:26.208586 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m14:50:26.275302 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:50:26.276315 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_gold: ROLLBACK
[0m14:50:26.276315 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_gold: Close
[0m14:50:26.277314 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sqldb-taxi-platform_bronze_gold, now list_sqldb-taxi-platform_bronze_silver)
[0m14:50:26.279314 [debug] [ThreadPool]: dbt-sqlserver
[0m14:50:26.279314 [debug] [ThreadPool]: Using sqlserver connection "list_sqldb-taxi-platform_bronze_silver"
[0m14:50:26.280314 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "list_sqldb-taxi-platform_bronze_silver"} */
USE [sqldb-taxi-platform];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze_silver'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m14:50:26.280314 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:50:26.280314 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m14:50:26.281315 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m14:50:26.328047 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:50:26.329046 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_silver: ROLLBACK
[0m14:50:26.330045 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_silver: Close
[0m14:50:26.330045 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sqldb-taxi-platform_bronze_silver, now list_sqldb-taxi-platform_bronze_bronze)
[0m14:50:26.332194 [debug] [ThreadPool]: dbt-sqlserver
[0m14:50:26.333198 [debug] [ThreadPool]: Using sqlserver connection "list_sqldb-taxi-platform_bronze_bronze"
[0m14:50:26.333198 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "list_sqldb-taxi-platform_bronze_bronze"} */
USE [sqldb-taxi-platform];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze_bronze'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m14:50:26.333198 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:50:26.334179 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m14:50:26.334179 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m14:50:26.380979 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:50:26.382961 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_bronze: ROLLBACK
[0m14:50:26.382961 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_bronze: Close
[0m14:50:26.383928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dfdeafe6-d3bf-4d1c-bfbb-216798b15cee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217865BDE50>]}
[0m14:50:26.383928 [debug] [MainThread]: On master: COMMIT
[0m14:50:26.387901 [debug] [Thread-1 (]: Began running node model.taxi_nyc_project.mart_daily_revenue
[0m14:50:26.388909 [info ] [Thread-1 (]: 1 of 4 START sql table model bronze_gold.mart_daily_revenue .................... [RUN]
[0m14:50:26.389901 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.taxi_nyc_project.mart_daily_revenue'
[0m14:50:26.389901 [debug] [Thread-1 (]: Began compiling node model.taxi_nyc_project.mart_daily_revenue
[0m14:50:26.396907 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_nyc_project.mart_daily_revenue"
[0m14:50:26.397907 [debug] [Thread-1 (]: Began executing node model.taxi_nyc_project.mart_daily_revenue
[0m14:50:26.439127 [debug] [Thread-1 (]: dbt-sqlserver
[0m14:50:26.444152 [debug] [Thread-1 (]: Applying DROP to: "sqldb-taxi-platform"."bronze_gold"."mart_daily_revenue__dbt_tmp__dbt_tmp_vw"
[0m14:50:26.451152 [debug] [Thread-1 (]: dbt-sqlserver
[0m14:50:26.451152 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_daily_revenue"
[0m14:50:26.451152 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_daily_revenue"} */

        USE [sqldb-taxi-platform];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'sqldb-taxi-platform'
        and refs.referenced_schema_name = 'bronze_gold'
        and refs.referenced_entity_name = 'mart_daily_revenue__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m14:50:26.452147 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:50:26.452147 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m14:50:26.453144 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m14:50:26.508640 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:50:26.509704 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_daily_revenue"
[0m14:50:26.510645 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_daily_revenue"} */

      
      
    
    USE [sqldb-taxi-platform];
    EXEC('DROP view IF EXISTS "bronze_gold"."mart_daily_revenue__dbt_tmp__dbt_tmp_vw";');

[0m14:50:26.554765 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:50:26.565309 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_nyc_project.mart_daily_revenue"
[0m14:50:26.566302 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_daily_revenue"
[0m14:50:26.566302 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_daily_revenue"} */

  
    USE [sqldb-taxi-platform];
    USE [sqldb-taxi-platform];
    
    

    

    
    USE [sqldb-taxi-platform];
    EXEC('
        create view "bronze_gold"."mart_daily_revenue__dbt_tmp__dbt_tmp_vw" as 

select
    pickup_date                as trip_date,
    count(*)                   as trip_count,
    sum(total_amount)          as total_revenue,
    avg(total_amount)          as avg_revenue_per_trip
from "sqldb-taxi-platform"."bronze_silver"."fact_trips"
group by
    pickup_date;;
    ')

EXEC('
            SELECT * INTO "sqldb-taxi-platform"."bronze_gold"."mart_daily_revenue__dbt_tmp" FROM "sqldb-taxi-platform"."bronze_gold"."mart_daily_revenue__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS bronze_gold.mart_daily_revenue__dbt_tmp__dbt_tmp_vw')



    
    use [sqldb-taxi-platform];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'bronze_gold_mart_daily_revenue__dbt_tmp_cci'
        AND object_id=object_id('bronze_gold_mart_daily_revenue__dbt_tmp')
    )
    DROP index "bronze_gold"."mart_daily_revenue__dbt_tmp".bronze_gold_mart_daily_revenue__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX bronze_gold_mart_daily_revenue__dbt_tmp_cci
    ON "bronze_gold"."mart_daily_revenue__dbt_tmp"

   


  
[0m14:50:26.889390 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:50:26.894458 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_daily_revenue"
[0m14:50:26.895462 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_daily_revenue"} */
USE [sqldb-taxi-platform];
      EXEC sp_rename 'bronze_gold.mart_daily_revenue__dbt_tmp', 'mart_daily_revenue'
[0m14:50:26.943900 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:50:26.956931 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_daily_revenue: COMMIT
[0m14:50:26.958929 [debug] [Thread-1 (]: Applying DROP to: "sqldb-taxi-platform"."bronze_gold"."mart_daily_revenue__dbt_backup"
[0m14:50:26.958929 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_daily_revenue"
[0m14:50:26.959930 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_daily_revenue"} */

      
    USE [sqldb-taxi-platform];
    EXEC('DROP table IF EXISTS "bronze_gold"."mart_daily_revenue__dbt_backup";');

[0m14:50:27.003697 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:50:27.005716 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_daily_revenue: Close
[0m14:50:27.007761 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfdeafe6-d3bf-4d1c-bfbb-216798b15cee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002178662EED0>]}
[0m14:50:27.008815 [info ] [Thread-1 (]: 1 of 4 OK created sql table model bronze_gold.mart_daily_revenue ............... [[32mOK[0m in 0.62s]
[0m14:50:27.008815 [debug] [Thread-1 (]: Finished running node model.taxi_nyc_project.mart_daily_revenue
[0m14:50:27.009713 [debug] [Thread-1 (]: Began running node model.taxi_nyc_project.mart_tip_by_payment_type
[0m14:50:27.009713 [info ] [Thread-1 (]: 2 of 4 START sql table model bronze_gold.mart_tip_by_payment_type .............. [RUN]
[0m14:50:27.010717 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_nyc_project.mart_daily_revenue, now model.taxi_nyc_project.mart_tip_by_payment_type)
[0m14:50:27.010717 [debug] [Thread-1 (]: Began compiling node model.taxi_nyc_project.mart_tip_by_payment_type
[0m14:50:27.013707 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_nyc_project.mart_tip_by_payment_type"
[0m14:50:27.014715 [debug] [Thread-1 (]: Began executing node model.taxi_nyc_project.mart_tip_by_payment_type
[0m14:50:27.017714 [debug] [Thread-1 (]: dbt-sqlserver
[0m14:50:27.019739 [debug] [Thread-1 (]: Applying DROP to: "sqldb-taxi-platform"."bronze_gold"."mart_tip_by_payment_type__dbt_tmp__dbt_tmp_vw"
[0m14:50:27.020740 [debug] [Thread-1 (]: dbt-sqlserver
[0m14:50:27.021739 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_tip_by_payment_type"
[0m14:50:27.021739 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_tip_by_payment_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_tip_by_payment_type"} */

        USE [sqldb-taxi-platform];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'sqldb-taxi-platform'
        and refs.referenced_schema_name = 'bronze_gold'
        and refs.referenced_entity_name = 'mart_tip_by_payment_type__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m14:50:27.021739 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:50:27.022739 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m14:50:27.022739 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m14:50:27.079228 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:50:27.080227 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_tip_by_payment_type"
[0m14:50:27.080227 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_tip_by_payment_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_tip_by_payment_type"} */

      
      
    
    USE [sqldb-taxi-platform];
    EXEC('DROP view IF EXISTS "bronze_gold"."mart_tip_by_payment_type__dbt_tmp__dbt_tmp_vw";');

[0m14:50:27.123870 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:50:27.125880 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_nyc_project.mart_tip_by_payment_type"
[0m14:50:27.126877 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_tip_by_payment_type"
[0m14:50:27.127869 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_tip_by_payment_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_tip_by_payment_type"} */

  
    USE [sqldb-taxi-platform];
    USE [sqldb-taxi-platform];
    
    

    

    
    USE [sqldb-taxi-platform];
    EXEC('
        create view "bronze_gold"."mart_tip_by_payment_type__dbt_tmp__dbt_tmp_vw" as 

select
    payment_type,
    avg(tip_pct)               as avg_tip_pct
from "sqldb-taxi-platform"."bronze_silver"."fact_trips"
where tip_pct is not null
group by
    payment_type;;
    ')

EXEC('
            SELECT * INTO "sqldb-taxi-platform"."bronze_gold"."mart_tip_by_payment_type__dbt_tmp" FROM "sqldb-taxi-platform"."bronze_gold"."mart_tip_by_payment_type__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS bronze_gold.mart_tip_by_payment_type__dbt_tmp__dbt_tmp_vw')



    
    use [sqldb-taxi-platform];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'bronze_gold_mart_tip_by_payment_type__dbt_tmp_cci'
        AND object_id=object_id('bronze_gold_mart_tip_by_payment_type__dbt_tmp')
    )
    DROP index "bronze_gold"."mart_tip_by_payment_type__dbt_tmp".bronze_gold_mart_tip_by_payment_type__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX bronze_gold_mart_tip_by_payment_type__dbt_tmp_cci
    ON "bronze_gold"."mart_tip_by_payment_type__dbt_tmp"

   


  
[0m14:50:27.658579 [debug] [Thread-1 (]: SQL status: OK in 1.000 seconds
[0m14:50:27.661591 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_tip_by_payment_type"
[0m14:50:27.661591 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_tip_by_payment_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_tip_by_payment_type"} */
USE [sqldb-taxi-platform];
      EXEC sp_rename 'bronze_gold.mart_tip_by_payment_type__dbt_tmp', 'mart_tip_by_payment_type'
[0m14:50:27.709853 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:50:27.710866 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_tip_by_payment_type: COMMIT
[0m14:50:27.712865 [debug] [Thread-1 (]: Applying DROP to: "sqldb-taxi-platform"."bronze_gold"."mart_tip_by_payment_type__dbt_backup"
[0m14:50:27.713864 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_tip_by_payment_type"
[0m14:50:27.713864 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_tip_by_payment_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_tip_by_payment_type"} */

      
    USE [sqldb-taxi-platform];
    EXEC('DROP table IF EXISTS "bronze_gold"."mart_tip_by_payment_type__dbt_backup";');

[0m14:50:27.757729 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:50:27.758749 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_tip_by_payment_type: Close
[0m14:50:27.758749 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfdeafe6-d3bf-4d1c-bfbb-216798b15cee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002178486B310>]}
[0m14:50:27.759728 [info ] [Thread-1 (]: 2 of 4 OK created sql table model bronze_gold.mart_tip_by_payment_type ......... [[32mOK[0m in 0.75s]
[0m14:50:27.760684 [debug] [Thread-1 (]: Finished running node model.taxi_nyc_project.mart_tip_by_payment_type
[0m14:50:27.760684 [debug] [Thread-1 (]: Began running node model.taxi_nyc_project.mart_trips_by_hour
[0m14:50:27.761691 [info ] [Thread-1 (]: 3 of 4 START sql table model bronze_gold.mart_trips_by_hour .................... [RUN]
[0m14:50:27.761691 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_nyc_project.mart_tip_by_payment_type, now model.taxi_nyc_project.mart_trips_by_hour)
[0m14:50:27.762684 [debug] [Thread-1 (]: Began compiling node model.taxi_nyc_project.mart_trips_by_hour
[0m14:50:27.765250 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_nyc_project.mart_trips_by_hour"
[0m14:50:27.770243 [debug] [Thread-1 (]: Began executing node model.taxi_nyc_project.mart_trips_by_hour
[0m14:50:27.772249 [debug] [Thread-1 (]: dbt-sqlserver
[0m14:50:27.774252 [debug] [Thread-1 (]: Applying DROP to: "sqldb-taxi-platform"."bronze_gold"."mart_trips_by_hour__dbt_tmp__dbt_tmp_vw"
[0m14:50:27.775251 [debug] [Thread-1 (]: dbt-sqlserver
[0m14:50:27.776252 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_trips_by_hour"
[0m14:50:27.776252 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_trips_by_hour: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_trips_by_hour"} */

        USE [sqldb-taxi-platform];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'sqldb-taxi-platform'
        and refs.referenced_schema_name = 'bronze_gold'
        and refs.referenced_entity_name = 'mart_trips_by_hour__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m14:50:27.776252 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:50:27.777250 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m14:50:27.777250 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m14:50:27.833736 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:50:27.834729 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_trips_by_hour"
[0m14:50:27.835736 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_trips_by_hour: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_trips_by_hour"} */

      
      
    
    USE [sqldb-taxi-platform];
    EXEC('DROP view IF EXISTS "bronze_gold"."mart_trips_by_hour__dbt_tmp__dbt_tmp_vw";');

[0m14:50:27.879562 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:50:27.880635 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_nyc_project.mart_trips_by_hour"
[0m14:50:27.882575 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_trips_by_hour"
[0m14:50:27.882575 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_trips_by_hour: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_trips_by_hour"} */

  
    USE [sqldb-taxi-platform];
    USE [sqldb-taxi-platform];
    
    

    

    
    USE [sqldb-taxi-platform];
    EXEC('
        create view "bronze_gold"."mart_trips_by_hour__dbt_tmp__dbt_tmp_vw" as 

select
    pickup_hour      as hour_of_day,
    pickup_day_name  as day_of_week,
    count(*)         as trip_count
from "sqldb-taxi-platform"."bronze_silver"."fact_trips"
group by
    pickup_hour,
    pickup_day_name;;
    ')

EXEC('
            SELECT * INTO "sqldb-taxi-platform"."bronze_gold"."mart_trips_by_hour__dbt_tmp" FROM "sqldb-taxi-platform"."bronze_gold"."mart_trips_by_hour__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS bronze_gold.mart_trips_by_hour__dbt_tmp__dbt_tmp_vw')



    
    use [sqldb-taxi-platform];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'bronze_gold_mart_trips_by_hour__dbt_tmp_cci'
        AND object_id=object_id('bronze_gold_mart_trips_by_hour__dbt_tmp')
    )
    DROP index "bronze_gold"."mart_trips_by_hour__dbt_tmp".bronze_gold_mart_trips_by_hour__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX bronze_gold_mart_trips_by_hour__dbt_tmp_cci
    ON "bronze_gold"."mart_trips_by_hour__dbt_tmp"

   


  
[0m14:50:28.797679 [debug] [Thread-1 (]: SQL status: OK in 1.000 seconds
[0m14:50:28.800679 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_trips_by_hour"
[0m14:50:28.800679 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_trips_by_hour: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_trips_by_hour"} */
USE [sqldb-taxi-platform];
      EXEC sp_rename 'bronze_gold.mart_trips_by_hour__dbt_tmp', 'mart_trips_by_hour'
[0m14:50:28.848720 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:50:28.849634 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_trips_by_hour: COMMIT
[0m14:50:28.851718 [debug] [Thread-1 (]: Applying DROP to: "sqldb-taxi-platform"."bronze_gold"."mart_trips_by_hour__dbt_backup"
[0m14:50:28.852709 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_trips_by_hour"
[0m14:50:28.852709 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_trips_by_hour: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_trips_by_hour"} */

      
    USE [sqldb-taxi-platform];
    EXEC('DROP table IF EXISTS "bronze_gold"."mart_trips_by_hour__dbt_backup";');

[0m14:50:28.896647 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:50:28.897660 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_trips_by_hour: Close
[0m14:50:28.897660 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfdeafe6-d3bf-4d1c-bfbb-216798b15cee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021786E09410>]}
[0m14:50:28.898659 [info ] [Thread-1 (]: 3 of 4 OK created sql table model bronze_gold.mart_trips_by_hour ............... [[32mOK[0m in 1.14s]
[0m14:50:28.899659 [debug] [Thread-1 (]: Finished running node model.taxi_nyc_project.mart_trips_by_hour
[0m14:50:28.899659 [debug] [Thread-1 (]: Began running node model.taxi_nyc_project.mart_zone_revenue
[0m14:50:28.899659 [info ] [Thread-1 (]: 4 of 4 START sql table model bronze_gold.mart_zone_revenue ..................... [RUN]
[0m14:50:28.900889 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_nyc_project.mart_trips_by_hour, now model.taxi_nyc_project.mart_zone_revenue)
[0m14:50:28.900889 [debug] [Thread-1 (]: Began compiling node model.taxi_nyc_project.mart_zone_revenue
[0m14:50:28.903964 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_nyc_project.mart_zone_revenue"
[0m14:50:28.904903 [debug] [Thread-1 (]: Began executing node model.taxi_nyc_project.mart_zone_revenue
[0m14:50:28.907957 [debug] [Thread-1 (]: dbt-sqlserver
[0m14:50:28.909956 [debug] [Thread-1 (]: Applying DROP to: "sqldb-taxi-platform"."bronze_gold"."mart_zone_revenue__dbt_tmp__dbt_tmp_vw"
[0m14:50:28.910958 [debug] [Thread-1 (]: dbt-sqlserver
[0m14:50:28.910958 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_zone_revenue"
[0m14:50:28.911964 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_zone_revenue: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_zone_revenue"} */

        USE [sqldb-taxi-platform];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'sqldb-taxi-platform'
        and refs.referenced_schema_name = 'bronze_gold'
        and refs.referenced_entity_name = 'mart_zone_revenue__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m14:50:28.911964 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:50:28.911964 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m14:50:28.912963 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m14:50:28.968936 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:50:28.969887 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_zone_revenue"
[0m14:50:28.970916 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_zone_revenue: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_zone_revenue"} */

      
      
    
    USE [sqldb-taxi-platform];
    EXEC('DROP view IF EXISTS "bronze_gold"."mart_zone_revenue__dbt_tmp__dbt_tmp_vw";');

[0m14:50:29.014399 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:50:29.015397 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_nyc_project.mart_zone_revenue"
[0m14:50:29.016403 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_zone_revenue"
[0m14:50:29.017374 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_zone_revenue: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_zone_revenue"} */

  
    USE [sqldb-taxi-platform];
    USE [sqldb-taxi-platform];
    
    

    

    
    USE [sqldb-taxi-platform];
    EXEC('
        create view "bronze_gold"."mart_zone_revenue__dbt_tmp__dbt_tmp_vw" as 

select
    pu_location_id             as pickup_zone_id,
    count(*)                   as trip_count,
    sum(total_amount)          as total_revenue
from "sqldb-taxi-platform"."bronze_silver"."fact_trips"
group by
    pu_location_id;;
    ')

EXEC('
            SELECT * INTO "sqldb-taxi-platform"."bronze_gold"."mart_zone_revenue__dbt_tmp" FROM "sqldb-taxi-platform"."bronze_gold"."mart_zone_revenue__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS bronze_gold.mart_zone_revenue__dbt_tmp__dbt_tmp_vw')



    
    use [sqldb-taxi-platform];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'bronze_gold_mart_zone_revenue__dbt_tmp_cci'
        AND object_id=object_id('bronze_gold_mart_zone_revenue__dbt_tmp')
    )
    DROP index "bronze_gold"."mart_zone_revenue__dbt_tmp".bronze_gold_mart_zone_revenue__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX bronze_gold_mart_zone_revenue__dbt_tmp_cci
    ON "bronze_gold"."mart_zone_revenue__dbt_tmp"

   


  
[0m14:50:29.405651 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:50:29.408539 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_zone_revenue"
[0m14:50:29.409539 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_zone_revenue: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_zone_revenue"} */
USE [sqldb-taxi-platform];
      EXEC sp_rename 'bronze_gold.mart_zone_revenue__dbt_tmp', 'mart_zone_revenue'
[0m14:50:29.457288 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:50:29.459281 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_zone_revenue: COMMIT
[0m14:50:29.461281 [debug] [Thread-1 (]: Applying DROP to: "sqldb-taxi-platform"."bronze_gold"."mart_zone_revenue__dbt_backup"
[0m14:50:29.462281 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_zone_revenue"
[0m14:50:29.462281 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_zone_revenue: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_zone_revenue"} */

      
    USE [sqldb-taxi-platform];
    EXEC('DROP table IF EXISTS "bronze_gold"."mart_zone_revenue__dbt_backup";');

[0m14:50:29.506149 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:50:29.508150 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_zone_revenue: Close
[0m14:50:29.508150 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfdeafe6-d3bf-4d1c-bfbb-216798b15cee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021786E4DA50>]}
[0m14:50:29.509151 [info ] [Thread-1 (]: 4 of 4 OK created sql table model bronze_gold.mart_zone_revenue ................ [[32mOK[0m in 0.61s]
[0m14:50:29.510152 [debug] [Thread-1 (]: Finished running node model.taxi_nyc_project.mart_zone_revenue
[0m14:50:29.511151 [debug] [MainThread]: On master: COMMIT
[0m14:50:29.511151 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:50:29.512152 [debug] [MainThread]: Connection 'create_sqldb-taxi-platform_bronze_gold' was properly closed.
[0m14:50:29.512152 [debug] [MainThread]: Connection 'list_sqldb-taxi-platform_bronze_bronze' was properly closed.
[0m14:50:29.512152 [debug] [MainThread]: Connection 'model.taxi_nyc_project.mart_zone_revenue' was properly closed.
[0m14:50:29.513153 [info ] [MainThread]: 
[0m14:50:29.513153 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 4.01 seconds (4.01s).
[0m14:50:29.514150 [debug] [MainThread]: Command end result
[0m14:50:29.535150 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\manifest.json
[0m14:50:29.538150 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\semantic_manifest.json
[0m14:50:29.543150 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\run_results.json
[0m14:50:29.543150 [info ] [MainThread]: 
[0m14:50:29.544679 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:50:29.544679 [info ] [MainThread]: 
[0m14:50:29.545663 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m14:50:29.545663 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m14:50:29.546664 [debug] [MainThread]: Command `dbt run` succeeded at 14:50:29.546664 after 5.14 seconds
[0m14:50:29.547694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217FDE3F850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217FDDC3A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217845B31D0>]}
[0m14:50:29.547694 [debug] [MainThread]: Flushing usage events
[0m14:50:30.359836 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:56:58.384593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274A04250D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274A1226C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274A1226410>]}


============================== 14:56:58.387593 | de8fc924-1c92-4d4b-a8b7-34bf91fd978e ==============================
[0m14:56:58.387593 [info ] [MainThread]: Running with dbt=1.10.15
[0m14:56:58.389165 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'log_format': 'default', 'target_path': 'None', 'no_print': 'None', 'invocation_command': 'dbt run --models silver.dim_payment_type silver.dim_date --profiles-dir .', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\alexm\\Desktop\\python\\azure-taxi-platform\\dbt_project\\logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m14:56:58.389677 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m14:56:58.389677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'de8fc924-1c92-4d4b-a8b7-34bf91fd978e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274A1482B50>]}
[0m14:56:58.700595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'de8fc924-1c92-4d4b-a8b7-34bf91fd978e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274A2D30690>]}
[0m14:56:58.744865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'de8fc924-1c92-4d4b-a8b7-34bf91fd978e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274A04815D0>]}
[0m14:56:58.744865 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m14:56:58.963415 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m14:56:59.099470 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
[0m14:56:59.100471 [debug] [MainThread]: Partial parsing: added file: taxi_nyc_project://models\silver\dim_payment_type.sql
[0m14:56:59.100471 [debug] [MainThread]: Partial parsing: added file: taxi_nyc_project://models\silver\dim_date.sql
[0m14:56:59.101471 [debug] [MainThread]: Partial parsing: updated file: taxi_nyc_project://models\gold\mart_tip_by_payment_type.sql
[0m14:56:59.315739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'de8fc924-1c92-4d4b-a8b7-34bf91fd978e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274A2C0FBD0>]}
[0m14:56:59.357738 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\manifest.json
[0m14:56:59.359739 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\semantic_manifest.json
[0m14:56:59.380739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'de8fc924-1c92-4d4b-a8b7-34bf91fd978e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274A3285FD0>]}
[0m14:56:59.381739 [info ] [MainThread]: Found 8 models, 535 macros
[0m14:56:59.381739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de8fc924-1c92-4d4b-a8b7-34bf91fd978e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274A2BF6250>]}
[0m14:56:59.382740 [info ] [MainThread]: 
[0m14:56:59.383739 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:56:59.383739 [info ] [MainThread]: 
[0m14:56:59.384740 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m14:56:59.389739 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_sqldb-taxi-platform'
[0m14:56:59.401745 [debug] [ThreadPool]: dbt-sqlserver
[0m14:56:59.401745 [debug] [ThreadPool]: Using sqlserver connection "list_sqldb-taxi-platform"
[0m14:56:59.401745 [debug] [ThreadPool]: On list_sqldb-taxi-platform: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "list_sqldb-taxi-platform"} */
USE [sqldb-taxi-platform];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m14:56:59.402738 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:56:59.402738 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m14:56:59.985389 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m14:57:00.030652 [debug] [ThreadPool]: SQL status: OK in 1.000 seconds
[0m14:57:00.032663 [debug] [ThreadPool]: On list_sqldb-taxi-platform: Close
[0m14:57:00.033697 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_sqldb-taxi-platform_bronze_bronze'
[0m14:57:00.038669 [debug] [ThreadPool]: dbt-sqlserver
[0m14:57:00.039662 [debug] [ThreadPool]: Using sqlserver connection "list_sqldb-taxi-platform_bronze_bronze"
[0m14:57:00.039662 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "list_sqldb-taxi-platform_bronze_bronze"} */
USE [sqldb-taxi-platform];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze_bronze'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m14:57:00.039662 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:57:00.040678 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m14:57:00.040678 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m14:57:00.088958 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:57:00.089351 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_bronze: ROLLBACK
[0m14:57:00.090437 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_bronze: Close
[0m14:57:00.090437 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sqldb-taxi-platform_bronze_bronze, now list_sqldb-taxi-platform_bronze_gold)
[0m14:57:00.092429 [debug] [ThreadPool]: dbt-sqlserver
[0m14:57:00.093430 [debug] [ThreadPool]: Using sqlserver connection "list_sqldb-taxi-platform_bronze_gold"
[0m14:57:00.093430 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_gold: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "list_sqldb-taxi-platform_bronze_gold"} */
USE [sqldb-taxi-platform];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze_gold'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m14:57:00.093430 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:57:00.094370 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m14:57:00.094370 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m14:57:00.145790 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:57:00.146791 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_gold: ROLLBACK
[0m14:57:00.147790 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_gold: Close
[0m14:57:00.147790 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sqldb-taxi-platform_bronze_gold, now list_sqldb-taxi-platform_bronze_silver)
[0m14:57:00.150794 [debug] [ThreadPool]: dbt-sqlserver
[0m14:57:00.150794 [debug] [ThreadPool]: Using sqlserver connection "list_sqldb-taxi-platform_bronze_silver"
[0m14:57:00.151792 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "list_sqldb-taxi-platform_bronze_silver"} */
USE [sqldb-taxi-platform];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze_silver'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m14:57:00.151792 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:57:00.151792 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m14:57:00.152784 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m14:57:00.199503 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:57:00.200474 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_silver: ROLLBACK
[0m14:57:00.201471 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_silver: Close
[0m14:57:00.201471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de8fc924-1c92-4d4b-a8b7-34bf91fd978e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274A2C0D9D0>]}
[0m14:57:00.202505 [debug] [MainThread]: On master: COMMIT
[0m14:57:00.206084 [debug] [Thread-1 (]: Began running node model.taxi_nyc_project.dim_date
[0m14:57:00.207089 [info ] [Thread-1 (]: 1 of 2 START sql table model bronze_silver.dim_date ............................ [RUN]
[0m14:57:00.207089 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.taxi_nyc_project.dim_date'
[0m14:57:00.208090 [debug] [Thread-1 (]: Began compiling node model.taxi_nyc_project.dim_date
[0m14:57:00.213624 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_nyc_project.dim_date"
[0m14:57:00.214624 [debug] [Thread-1 (]: Began executing node model.taxi_nyc_project.dim_date
[0m14:57:00.242620 [debug] [Thread-1 (]: dbt-sqlserver
[0m14:57:00.247636 [debug] [Thread-1 (]: Applying DROP to: "sqldb-taxi-platform"."bronze_silver"."dim_date__dbt_tmp__dbt_tmp_vw"
[0m14:57:00.252643 [debug] [Thread-1 (]: dbt-sqlserver
[0m14:57:00.252643 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.dim_date"
[0m14:57:00.253636 [debug] [Thread-1 (]: On model.taxi_nyc_project.dim_date: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.dim_date"} */

        USE [sqldb-taxi-platform];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'sqldb-taxi-platform'
        and refs.referenced_schema_name = 'bronze_silver'
        and refs.referenced_entity_name = 'dim_date__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m14:57:00.253636 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:57:00.253636 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m14:57:00.254644 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m14:57:00.310398 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:57:00.311351 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.dim_date"
[0m14:57:00.312369 [debug] [Thread-1 (]: On model.taxi_nyc_project.dim_date: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.dim_date"} */

      
      
    
    USE [sqldb-taxi-platform];
    EXEC('DROP view IF EXISTS "bronze_silver"."dim_date__dbt_tmp__dbt_tmp_vw";');

[0m14:57:00.356562 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:57:00.367577 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_nyc_project.dim_date"
[0m14:57:00.368880 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.dim_date"
[0m14:57:00.368880 [debug] [Thread-1 (]: On model.taxi_nyc_project.dim_date: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.dim_date"} */

  
    USE [sqldb-taxi-platform];
    USE [sqldb-taxi-platform];
    
    

    

    
    USE [sqldb-taxi-platform];
    EXEC('
        create view "bronze_silver"."dim_date__dbt_tmp__dbt_tmp_vw" as 

with numbers as (
    -- generate 365 rows: 0..364
    select top (365)
        row_number() over(order by (select null)) - 1 as n
    from sys.objects
),
dates as (
    select
        dateadd(day, n, cast(''2025-01-01'' as date)) as date_actual
    from numbers
)

select
    date_actual                           as date_key,   -- PK
    date_actual                           as date_actual,
    year(date_actual)                     as year,
    month(date_actual)                    as month,
    datename(month, date_actual)          as month_name,
    day(date_actual)                      as day,
    datename(weekday, date_actual)        as weekday_name,
    datepart(weekday, date_actual)        as weekday_num,
    case when datepart(weekday, date_actual) in (1, 7)
         then 1 else 0 end                as is_weekend
from dates;;
    ')

EXEC('
            SELECT * INTO "sqldb-taxi-platform"."bronze_silver"."dim_date__dbt_tmp" FROM "sqldb-taxi-platform"."bronze_silver"."dim_date__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS bronze_silver.dim_date__dbt_tmp__dbt_tmp_vw')



    
    use [sqldb-taxi-platform];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'bronze_silver_dim_date__dbt_tmp_cci'
        AND object_id=object_id('bronze_silver_dim_date__dbt_tmp')
    )
    DROP index "bronze_silver"."dim_date__dbt_tmp".bronze_silver_dim_date__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX bronze_silver_dim_date__dbt_tmp_cci
    ON "bronze_silver"."dim_date__dbt_tmp"

   


  
[0m14:57:00.497766 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:57:00.502776 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.dim_date"
[0m14:57:00.502776 [debug] [Thread-1 (]: On model.taxi_nyc_project.dim_date: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.dim_date"} */
USE [sqldb-taxi-platform];
      EXEC sp_rename 'bronze_silver.dim_date__dbt_tmp', 'dim_date'
[0m14:57:00.551674 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:57:00.564607 [debug] [Thread-1 (]: On model.taxi_nyc_project.dim_date: COMMIT
[0m14:57:00.567611 [debug] [Thread-1 (]: Applying DROP to: "sqldb-taxi-platform"."bronze_silver"."dim_date__dbt_backup"
[0m14:57:00.567611 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.dim_date"
[0m14:57:00.568608 [debug] [Thread-1 (]: On model.taxi_nyc_project.dim_date: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.dim_date"} */

      
    USE [sqldb-taxi-platform];
    EXEC('DROP table IF EXISTS "bronze_silver"."dim_date__dbt_backup";');

[0m14:57:00.612724 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:57:00.614727 [debug] [Thread-1 (]: On model.taxi_nyc_project.dim_date: Close
[0m14:57:00.616668 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de8fc924-1c92-4d4b-a8b7-34bf91fd978e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274A304F410>]}
[0m14:57:00.616668 [info ] [Thread-1 (]: 1 of 2 OK created sql table model bronze_silver.dim_date ....................... [[32mOK[0m in 0.41s]
[0m14:57:00.617674 [debug] [Thread-1 (]: Finished running node model.taxi_nyc_project.dim_date
[0m14:57:00.618673 [debug] [Thread-1 (]: Began running node model.taxi_nyc_project.dim_payment_type
[0m14:57:00.618673 [info ] [Thread-1 (]: 2 of 2 START sql table model bronze_silver.dim_payment_type .................... [RUN]
[0m14:57:00.619673 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_nyc_project.dim_date, now model.taxi_nyc_project.dim_payment_type)
[0m14:57:00.619673 [debug] [Thread-1 (]: Began compiling node model.taxi_nyc_project.dim_payment_type
[0m14:57:00.621673 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_nyc_project.dim_payment_type"
[0m14:57:00.623674 [debug] [Thread-1 (]: Began executing node model.taxi_nyc_project.dim_payment_type
[0m14:57:00.626673 [debug] [Thread-1 (]: dbt-sqlserver
[0m14:57:00.628673 [debug] [Thread-1 (]: Applying DROP to: "sqldb-taxi-platform"."bronze_silver"."dim_payment_type__dbt_tmp__dbt_tmp_vw"
[0m14:57:00.629673 [debug] [Thread-1 (]: dbt-sqlserver
[0m14:57:00.629673 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.dim_payment_type"
[0m14:57:00.629673 [debug] [Thread-1 (]: On model.taxi_nyc_project.dim_payment_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.dim_payment_type"} */

        USE [sqldb-taxi-platform];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'sqldb-taxi-platform'
        and refs.referenced_schema_name = 'bronze_silver'
        and refs.referenced_entity_name = 'dim_payment_type__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m14:57:00.630673 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:57:00.630673 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m14:57:00.630673 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m14:57:00.687416 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:57:00.688488 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.dim_payment_type"
[0m14:57:00.688488 [debug] [Thread-1 (]: On model.taxi_nyc_project.dim_payment_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.dim_payment_type"} */

      
      
    
    USE [sqldb-taxi-platform];
    EXEC('DROP view IF EXISTS "bronze_silver"."dim_payment_type__dbt_tmp__dbt_tmp_vw";');

[0m14:57:00.732306 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:57:00.734364 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_nyc_project.dim_payment_type"
[0m14:57:00.735366 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.dim_payment_type"
[0m14:57:00.735366 [debug] [Thread-1 (]: On model.taxi_nyc_project.dim_payment_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.dim_payment_type"} */

  
    USE [sqldb-taxi-platform];
    USE [sqldb-taxi-platform];
    
    

    

    
    USE [sqldb-taxi-platform];
    EXEC('
        create view "bronze_silver"."dim_payment_type__dbt_tmp__dbt_tmp_vw" as 

select * from (
    values
        (1, ''Credit card''),
        (2, ''Cash''),
        (3, ''No charge''),
        (4, ''Dispute''),
        (5, ''Unknown''),
        (6, ''Voided trip'')
) as t(payment_type, payment_type_desc);
    ')

EXEC('
            SELECT * INTO "sqldb-taxi-platform"."bronze_silver"."dim_payment_type__dbt_tmp" FROM "sqldb-taxi-platform"."bronze_silver"."dim_payment_type__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS bronze_silver.dim_payment_type__dbt_tmp__dbt_tmp_vw')



    
    use [sqldb-taxi-platform];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'bronze_silver_dim_payment_type__dbt_tmp_cci'
        AND object_id=object_id('bronze_silver_dim_payment_type__dbt_tmp')
    )
    DROP index "bronze_silver"."dim_payment_type__dbt_tmp".bronze_silver_dim_payment_type__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX bronze_silver_dim_payment_type__dbt_tmp_cci
    ON "bronze_silver"."dim_payment_type__dbt_tmp"

   


  
[0m14:57:00.810326 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:57:00.814869 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.dim_payment_type"
[0m14:57:00.814869 [debug] [Thread-1 (]: On model.taxi_nyc_project.dim_payment_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.dim_payment_type"} */
USE [sqldb-taxi-platform];
      EXEC sp_rename 'bronze_silver.dim_payment_type__dbt_tmp', 'dim_payment_type'
[0m14:57:00.863657 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:57:00.864658 [debug] [Thread-1 (]: On model.taxi_nyc_project.dim_payment_type: COMMIT
[0m14:57:00.866657 [debug] [Thread-1 (]: Applying DROP to: "sqldb-taxi-platform"."bronze_silver"."dim_payment_type__dbt_backup"
[0m14:57:00.867657 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.dim_payment_type"
[0m14:57:00.867657 [debug] [Thread-1 (]: On model.taxi_nyc_project.dim_payment_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.dim_payment_type"} */

      
    USE [sqldb-taxi-platform];
    EXEC('DROP table IF EXISTS "bronze_silver"."dim_payment_type__dbt_backup";');

[0m14:57:00.912895 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:57:00.913905 [debug] [Thread-1 (]: On model.taxi_nyc_project.dim_payment_type: Close
[0m14:57:00.913905 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de8fc924-1c92-4d4b-a8b7-34bf91fd978e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274A3446550>]}
[0m14:57:00.914895 [info ] [Thread-1 (]: 2 of 2 OK created sql table model bronze_silver.dim_payment_type ............... [[32mOK[0m in 0.29s]
[0m14:57:00.915896 [debug] [Thread-1 (]: Finished running node model.taxi_nyc_project.dim_payment_type
[0m14:57:00.916894 [debug] [MainThread]: On master: COMMIT
[0m14:57:00.916894 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:57:00.917894 [debug] [MainThread]: Connection 'list_sqldb-taxi-platform' was properly closed.
[0m14:57:00.917894 [debug] [MainThread]: Connection 'list_sqldb-taxi-platform_bronze_silver' was properly closed.
[0m14:57:00.917894 [debug] [MainThread]: Connection 'model.taxi_nyc_project.dim_payment_type' was properly closed.
[0m14:57:00.918894 [info ] [MainThread]: 
[0m14:57:00.918894 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 1.53 seconds (1.53s).
[0m14:57:00.919894 [debug] [MainThread]: Command end result
[0m14:57:00.938824 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\manifest.json
[0m14:57:00.940820 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\semantic_manifest.json
[0m14:57:00.945818 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\run_results.json
[0m14:57:00.945818 [info ] [MainThread]: 
[0m14:57:00.946579 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:57:00.946579 [info ] [MainThread]: 
[0m14:57:00.947602 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m14:57:00.948585 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m14:57:00.949597 [debug] [MainThread]: Command `dbt run` succeeded at 14:57:00.949597 after 2.63 seconds
[0m14:57:00.949597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274A14E4650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002749AA33950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002749AA339D0>]}
[0m14:57:00.949597 [debug] [MainThread]: Flushing usage events
[0m14:57:01.777432 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:57:03.524428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A41BCE3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A41BCF3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A41BCF5D0>]}


============================== 14:57:03.527426 | 7c111c31-4678-4bdb-859e-ff9775fcf76b ==============================
[0m14:57:03.527426 [info ] [MainThread]: Running with dbt=1.10.15
[0m14:57:03.528425 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'use_colors': 'True', 'no_print': 'None', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\alexm\\Desktop\\python\\azure-taxi-platform\\dbt_project\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': '.', 'invocation_command': 'dbt run --models gold.mart_tip_by_payment_type --profiles-dir .', 'printer_width': '80', 'target_path': 'None'}
[0m14:57:03.529453 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m14:57:03.529984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7c111c31-4678-4bdb-859e-ff9775fcf76b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A41C01CD0>]}
[0m14:57:03.839341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c111c31-4678-4bdb-859e-ff9775fcf76b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A41BDBB50>]}
[0m14:57:03.883382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c111c31-4678-4bdb-859e-ff9775fcf76b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A40BD15D0>]}
[0m14:57:03.884382 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m14:57:04.095727 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m14:57:04.200850 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:57:04.200850 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:57:04.259454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c111c31-4678-4bdb-859e-ff9775fcf76b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A43864E90>]}
[0m14:57:04.304083 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\manifest.json
[0m14:57:04.306084 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\semantic_manifest.json
[0m14:57:04.326090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c111c31-4678-4bdb-859e-ff9775fcf76b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A43845A10>]}
[0m14:57:04.327083 [info ] [MainThread]: Found 8 models, 535 macros
[0m14:57:04.328095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c111c31-4678-4bdb-859e-ff9775fcf76b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A43924F90>]}
[0m14:57:04.329083 [info ] [MainThread]: 
[0m14:57:04.329083 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:57:04.330090 [info ] [MainThread]: 
[0m14:57:04.331084 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m14:57:04.331754 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_sqldb-taxi-platform'
[0m14:57:04.344761 [debug] [ThreadPool]: dbt-sqlserver
[0m14:57:04.344761 [debug] [ThreadPool]: Using sqlserver connection "list_sqldb-taxi-platform"
[0m14:57:04.345760 [debug] [ThreadPool]: On list_sqldb-taxi-platform: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "list_sqldb-taxi-platform"} */
USE [sqldb-taxi-platform];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m14:57:04.345760 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:57:04.346751 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m14:57:04.803938 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m14:57:04.847541 [debug] [ThreadPool]: SQL status: OK in 1.000 seconds
[0m14:57:04.848646 [debug] [ThreadPool]: On list_sqldb-taxi-platform: Close
[0m14:57:04.853546 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_sqldb-taxi-platform_bronze_gold'
[0m14:57:04.858611 [debug] [ThreadPool]: dbt-sqlserver
[0m14:57:04.858611 [debug] [ThreadPool]: Using sqlserver connection "list_sqldb-taxi-platform_bronze_gold"
[0m14:57:04.859610 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_gold: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "list_sqldb-taxi-platform_bronze_gold"} */
USE [sqldb-taxi-platform];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze_gold'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m14:57:04.859610 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:57:04.859610 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m14:57:04.860613 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m14:57:04.906625 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:57:04.907635 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_gold: ROLLBACK
[0m14:57:04.908632 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_gold: Close
[0m14:57:04.908632 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sqldb-taxi-platform_bronze_gold, now list_sqldb-taxi-platform_bronze_bronze)
[0m14:57:04.911630 [debug] [ThreadPool]: dbt-sqlserver
[0m14:57:04.911630 [debug] [ThreadPool]: Using sqlserver connection "list_sqldb-taxi-platform_bronze_bronze"
[0m14:57:04.911630 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "list_sqldb-taxi-platform_bronze_bronze"} */
USE [sqldb-taxi-platform];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze_bronze'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m14:57:04.912632 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:57:04.912632 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m14:57:04.913631 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m14:57:04.960218 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:57:04.961221 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_bronze: ROLLBACK
[0m14:57:04.962218 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_bronze: Close
[0m14:57:04.962218 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sqldb-taxi-platform_bronze_bronze, now list_sqldb-taxi-platform_bronze_silver)
[0m14:57:04.965217 [debug] [ThreadPool]: dbt-sqlserver
[0m14:57:04.965217 [debug] [ThreadPool]: Using sqlserver connection "list_sqldb-taxi-platform_bronze_silver"
[0m14:57:04.966222 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "list_sqldb-taxi-platform_bronze_silver"} */
USE [sqldb-taxi-platform];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze_silver'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m14:57:04.966222 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:57:04.966222 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m14:57:04.967218 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m14:57:05.018742 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:57:05.020755 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_silver: ROLLBACK
[0m14:57:05.020755 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_silver: Close
[0m14:57:05.022740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c111c31-4678-4bdb-859e-ff9775fcf76b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A43866650>]}
[0m14:57:05.023256 [debug] [MainThread]: On master: COMMIT
[0m14:57:05.026255 [debug] [Thread-1 (]: Began running node model.taxi_nyc_project.mart_tip_by_payment_type
[0m14:57:05.028257 [info ] [Thread-1 (]: 1 of 1 START sql table model bronze_gold.mart_tip_by_payment_type .............. [RUN]
[0m14:57:05.029255 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.taxi_nyc_project.mart_tip_by_payment_type'
[0m14:57:05.029255 [debug] [Thread-1 (]: Began compiling node model.taxi_nyc_project.mart_tip_by_payment_type
[0m14:57:05.035255 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_nyc_project.mart_tip_by_payment_type"
[0m14:57:05.036256 [debug] [Thread-1 (]: Began executing node model.taxi_nyc_project.mart_tip_by_payment_type
[0m14:57:05.066254 [debug] [Thread-1 (]: dbt-sqlserver
[0m14:57:05.071255 [debug] [Thread-1 (]: Applying DROP to: "sqldb-taxi-platform"."bronze_gold"."mart_tip_by_payment_type__dbt_tmp__dbt_tmp_vw"
[0m14:57:05.076255 [debug] [Thread-1 (]: dbt-sqlserver
[0m14:57:05.077256 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_tip_by_payment_type"
[0m14:57:05.077256 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_tip_by_payment_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_tip_by_payment_type"} */

        USE [sqldb-taxi-platform];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'sqldb-taxi-platform'
        and refs.referenced_schema_name = 'bronze_gold'
        and refs.referenced_entity_name = 'mart_tip_by_payment_type__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m14:57:05.078255 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:57:05.078255 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m14:57:05.078255 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m14:57:05.124776 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:57:05.126778 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_tip_by_payment_type"
[0m14:57:05.126778 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_tip_by_payment_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_tip_by_payment_type"} */

      
      
    
    USE [sqldb-taxi-platform];
    EXEC('DROP view IF EXISTS "bronze_gold"."mart_tip_by_payment_type__dbt_tmp__dbt_tmp_vw";');

[0m14:57:05.171805 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:57:05.181876 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_nyc_project.mart_tip_by_payment_type"
[0m14:57:05.182820 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_tip_by_payment_type"
[0m14:57:05.183818 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_tip_by_payment_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_tip_by_payment_type"} */

  
    USE [sqldb-taxi-platform];
    USE [sqldb-taxi-platform];
    
    

    

    
    USE [sqldb-taxi-platform];
    EXEC('
        create view "bronze_gold"."mart_tip_by_payment_type__dbt_tmp__dbt_tmp_vw" as 

select
    d.payment_type_desc   as payment_type,
    avg(f.tip_pct)        as avg_tip_pct
from "sqldb-taxi-platform"."bronze_silver"."fact_trips" f
join "sqldb-taxi-platform"."bronze_silver"."dim_payment_type" d
    on f.payment_type = d.payment_type
where f.tip_pct is not null
group by
    d.payment_type_desc;;
    ')

EXEC('
            SELECT * INTO "sqldb-taxi-platform"."bronze_gold"."mart_tip_by_payment_type__dbt_tmp" FROM "sqldb-taxi-platform"."bronze_gold"."mart_tip_by_payment_type__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS bronze_gold.mart_tip_by_payment_type__dbt_tmp__dbt_tmp_vw')



    
    use [sqldb-taxi-platform];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'bronze_gold_mart_tip_by_payment_type__dbt_tmp_cci'
        AND object_id=object_id('bronze_gold_mart_tip_by_payment_type__dbt_tmp')
    )
    DROP index "bronze_gold"."mart_tip_by_payment_type__dbt_tmp".bronze_gold_mart_tip_by_payment_type__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX bronze_gold_mart_tip_by_payment_type__dbt_tmp_cci
    ON "bronze_gold"."mart_tip_by_payment_type__dbt_tmp"

   


  
[0m14:57:05.282314 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:57:05.287320 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_tip_by_payment_type"
[0m14:57:05.287320 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_tip_by_payment_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_tip_by_payment_type"} */
USE [sqldb-taxi-platform];
      EXEC sp_rename 'bronze_gold.mart_tip_by_payment_type', 'mart_tip_by_payment_type__dbt_backup'
[0m14:57:05.335923 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:57:05.338922 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_tip_by_payment_type"
[0m14:57:05.338922 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_tip_by_payment_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_tip_by_payment_type"} */
USE [sqldb-taxi-platform];
      EXEC sp_rename 'bronze_gold.mart_tip_by_payment_type__dbt_tmp', 'mart_tip_by_payment_type'
[0m14:57:05.387456 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:57:05.402456 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_tip_by_payment_type: COMMIT
[0m14:57:05.404456 [debug] [Thread-1 (]: Applying DROP to: "sqldb-taxi-platform"."bronze_gold"."mart_tip_by_payment_type__dbt_backup"
[0m14:57:05.404456 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_tip_by_payment_type"
[0m14:57:05.405456 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_tip_by_payment_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_tip_by_payment_type"} */

      
    USE [sqldb-taxi-platform];
    EXEC('DROP table IF EXISTS "bronze_gold"."mart_tip_by_payment_type__dbt_backup";');

[0m14:57:05.453633 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:57:05.454702 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_tip_by_payment_type: Close
[0m14:57:05.456734 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c111c31-4678-4bdb-859e-ff9775fcf76b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A4336BC10>]}
[0m14:57:05.457644 [info ] [Thread-1 (]: 1 of 1 OK created sql table model bronze_gold.mart_tip_by_payment_type ......... [[32mOK[0m in 0.43s]
[0m14:57:05.458651 [debug] [Thread-1 (]: Finished running node model.taxi_nyc_project.mart_tip_by_payment_type
[0m14:57:05.459644 [debug] [MainThread]: On master: COMMIT
[0m14:57:05.459644 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:57:05.460653 [debug] [MainThread]: Connection 'list_sqldb-taxi-platform' was properly closed.
[0m14:57:05.460653 [debug] [MainThread]: Connection 'list_sqldb-taxi-platform_bronze_silver' was properly closed.
[0m14:57:05.460653 [debug] [MainThread]: Connection 'model.taxi_nyc_project.mart_tip_by_payment_type' was properly closed.
[0m14:57:05.461643 [info ] [MainThread]: 
[0m14:57:05.462012 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.13 seconds (1.13s).
[0m14:57:05.463072 [debug] [MainThread]: Command end result
[0m14:57:05.482027 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\manifest.json
[0m14:57:05.484021 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\semantic_manifest.json
[0m14:57:05.488665 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\run_results.json
[0m14:57:05.489677 [info ] [MainThread]: 
[0m14:57:05.489677 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:57:05.490661 [info ] [MainThread]: 
[0m14:57:05.491658 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m14:57:05.492666 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m14:57:05.493658 [debug] [MainThread]: Command `dbt run` succeeded at 14:57:05.493658 after 2.03 seconds
[0m14:57:05.493658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A41C01CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A3B1AF8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A41A5DB10>]}
[0m14:57:05.494669 [debug] [MainThread]: Flushing usage events
[0m14:57:06.217546 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:01:19.562533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214817C2150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021480F5DD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214817F1B10>]}


============================== 15:01:19.566531 | 24beeed4-be56-4627-9ea9-5fbf9ed79e5f ==============================
[0m15:01:19.566531 [info ] [MainThread]: Running with dbt=1.10.15
[0m15:01:19.566531 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'no_print': 'None', 'target_path': 'None', 'printer_width': '80', 'profiles_dir': '.', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\alexm\\Desktop\\python\\azure-taxi-platform\\dbt_project\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir .', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m15:01:19.881567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '24beeed4-be56-4627-9ea9-5fbf9ed79e5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021482F338D0>]}
[0m15:01:19.925568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '24beeed4-be56-4627-9ea9-5fbf9ed79e5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214807C9590>]}
[0m15:01:19.926568 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m15:01:20.156633 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m15:01:20.309181 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m15:01:20.310181 [debug] [MainThread]: Partial parsing: added file: taxi_nyc_project://models\schema.yml
[0m15:01:20.444796 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m15:01:20.445791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '24beeed4-be56-4627-9ea9-5fbf9ed79e5f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002148311C0D0>]}
[0m15:01:20.526335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '24beeed4-be56-4627-9ea9-5fbf9ed79e5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021483563050>]}
[0m15:01:20.584350 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\manifest.json
[0m15:01:20.587351 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\semantic_manifest.json
[0m15:01:20.621351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '24beeed4-be56-4627-9ea9-5fbf9ed79e5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002148383FA10>]}
[0m15:01:20.621351 [info ] [MainThread]: Found 8 models, 15 data tests, 535 macros
[0m15:01:20.622352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24beeed4-be56-4627-9ea9-5fbf9ed79e5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021483666390>]}
[0m15:01:20.624357 [info ] [MainThread]: 
[0m15:01:20.624357 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:01:20.625366 [info ] [MainThread]: 
[0m15:01:20.625366 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m15:01:20.630357 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_sqldb-taxi-platform_bronze_bronze'
[0m15:01:20.641889 [debug] [ThreadPool]: dbt-sqlserver
[0m15:01:20.642889 [debug] [ThreadPool]: Using sqlserver connection "list_sqldb-taxi-platform_bronze_bronze"
[0m15:01:20.642889 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "list_sqldb-taxi-platform_bronze_bronze"} */
USE [sqldb-taxi-platform];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze_bronze'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m15:01:20.642889 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:01:20.643899 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:01:21.191993 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:01:21.258301 [debug] [ThreadPool]: SQL status: OK in 1.000 seconds
[0m15:01:21.259376 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_bronze: ROLLBACK
[0m15:01:21.260319 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_bronze: Close
[0m15:01:21.260319 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sqldb-taxi-platform_bronze_bronze, now list_sqldb-taxi-platform_bronze_gold)
[0m15:01:21.262377 [debug] [ThreadPool]: dbt-sqlserver
[0m15:01:21.263376 [debug] [ThreadPool]: Using sqlserver connection "list_sqldb-taxi-platform_bronze_gold"
[0m15:01:21.263376 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_gold: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "list_sqldb-taxi-platform_bronze_gold"} */
USE [sqldb-taxi-platform];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze_gold'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m15:01:21.263376 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:01:21.264412 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:01:21.265321 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:01:21.313277 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:01:21.314278 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_gold: ROLLBACK
[0m15:01:21.314278 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_gold: Close
[0m15:01:21.315284 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sqldb-taxi-platform_bronze_gold, now list_sqldb-taxi-platform_bronze_silver)
[0m15:01:21.317284 [debug] [ThreadPool]: dbt-sqlserver
[0m15:01:21.318284 [debug] [ThreadPool]: Using sqlserver connection "list_sqldb-taxi-platform_bronze_silver"
[0m15:01:21.318284 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "list_sqldb-taxi-platform_bronze_silver"} */
USE [sqldb-taxi-platform];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze_silver'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m15:01:21.318284 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:01:21.319277 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:01:21.319277 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:01:21.366785 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:01:21.367745 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_silver: ROLLBACK
[0m15:01:21.367745 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_silver: Close
[0m15:01:21.368718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24beeed4-be56-4627-9ea9-5fbf9ed79e5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021483465D90>]}
[0m15:01:21.369719 [debug] [MainThread]: On master: COMMIT
[0m15:01:21.373708 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec
[0m15:01:21.374716 [info ] [Thread-1 (]: 1 of 15 START test accepted_values_stg_trips_payment_type__1__2__3__4__5__6 .... [RUN]
[0m15:01:21.374716 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec'
[0m15:01:21.375708 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec
[0m15:01:21.381733 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec"
[0m15:01:21.383740 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec
[0m15:01:21.399766 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec"
[0m15:01:21.405759 [debug] [Thread-1 (]: Using sqlserver connection "test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec"
[0m15:01:21.405759 [debug] [Thread-1 (]: On test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec"} */

    -- Create target schema if it does not
  USE [sqldb-taxi-platform];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'bronze')
  BEGIN
    EXEC('CREATE SCHEMA [bronze]')
  END

  

  
  EXEC('create view 
    [bronze].[testview_f33210bcd4b055fe9687c095053b88a1_17266]
   as 
    
    
    

with all_values as (

    select
        payment_type as value_field,
        count(*) as n_records

    from "sqldb-taxi-platform"."bronze_bronze"."stg_trips"
    group by payment_type

)

select *
from all_values
where value_field not in (
    ''1'',''2'',''3'',''4'',''5'',''6''
)



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [bronze].[testview_f33210bcd4b055fe9687c095053b88a1_17266]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [bronze].[testview_f33210bcd4b055fe9687c095053b88a1_17266]
  ;')
[0m15:01:21.406759 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:01:21.406759 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:01:21.666451 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:01:21.939930 [debug] [Thread-1 (]: SQL status: OK in 1.000 seconds
[0m15:01:21.943902 [debug] [Thread-1 (]: On test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec: ROLLBACK
[0m15:01:21.943902 [debug] [Thread-1 (]: On test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec: Close
[0m15:01:21.944927 [info ] [Thread-1 (]: 1 of 15 PASS accepted_values_stg_trips_payment_type__1__2__3__4__5__6 .......... [[32mPASS[0m in 0.57s]
[0m15:01:21.945860 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec
[0m15:01:21.945860 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__6.d43c87e052
[0m15:01:21.946862 [info ] [Thread-1 (]: 2 of 15 START test accepted_values_stg_trips_rate_code_id__1__2__3__4__5__6 .... [RUN]
[0m15:01:21.947078 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec, now test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__6.d43c87e052)
[0m15:01:21.947078 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__6.d43c87e052
[0m15:01:21.952570 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__6.d43c87e052"
[0m15:01:21.953578 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__6.d43c87e052
[0m15:01:21.955498 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__6.d43c87e052"
[0m15:01:21.956505 [debug] [Thread-1 (]: Using sqlserver connection "test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__6.d43c87e052"
[0m15:01:21.957498 [debug] [Thread-1 (]: On test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__6.d43c87e052: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__6.d43c87e052"} */

    -- Create target schema if it does not
  USE [sqldb-taxi-platform];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'bronze')
  BEGIN
    EXEC('CREATE SCHEMA [bronze]')
  END

  

  
  EXEC('create view 
    [bronze].[testview_ed2d84721191aaf258fc08537e3e42f4_15469]
   as 
    
    
    

with all_values as (

    select
        rate_code_id as value_field,
        count(*) as n_records

    from "sqldb-taxi-platform"."bronze_bronze"."stg_trips"
    group by rate_code_id

)

select *
from all_values
where value_field not in (
    ''1'',''2'',''3'',''4'',''5'',''6''
)



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [bronze].[testview_ed2d84721191aaf258fc08537e3e42f4_15469]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [bronze].[testview_ed2d84721191aaf258fc08537e3e42f4_15469]
  ;')
[0m15:01:21.957498 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:01:21.958505 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:01:21.958505 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:01:22.203302 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:01:22.204335 [debug] [Thread-1 (]: On test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__6.d43c87e052: ROLLBACK
[0m15:01:22.205321 [debug] [Thread-1 (]: On test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__6.d43c87e052: Close
[0m15:01:22.205321 [error] [Thread-1 (]: 2 of 15 FAIL 1 accepted_values_stg_trips_rate_code_id__1__2__3__4__5__6 ........ [[31mFAIL 1[0m in 0.26s]
[0m15:01:22.206274 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__6.d43c87e052
[0m15:01:22.206274 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_dim_date_date_key.881d0a31b6
[0m15:01:22.207273 [info ] [Thread-1 (]: 3 of 15 START test not_null_dim_date_date_key .................................. [RUN]
[0m15:01:22.208273 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__6.d43c87e052, now test.taxi_nyc_project.not_null_dim_date_date_key.881d0a31b6)
[0m15:01:22.208273 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_dim_date_date_key.881d0a31b6
[0m15:01:22.213281 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_dim_date_date_key.881d0a31b6"
[0m15:01:22.215272 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_dim_date_date_key.881d0a31b6
[0m15:01:22.217279 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_nyc_project.not_null_dim_date_date_key.881d0a31b6"
[0m15:01:22.218272 [debug] [Thread-1 (]: Using sqlserver connection "test.taxi_nyc_project.not_null_dim_date_date_key.881d0a31b6"
[0m15:01:22.219272 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_dim_date_date_key.881d0a31b6: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "test.taxi_nyc_project.not_null_dim_date_date_key.881d0a31b6"} */

    -- Create target schema if it does not
  USE [sqldb-taxi-platform];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'bronze')
  BEGIN
    EXEC('CREATE SCHEMA [bronze]')
  END

  

  
  EXEC('create view 
    [bronze].[testview_97a1514f1de409d55b5193a479b57439_8838]
   as 
    
    
    



select date_key
from "sqldb-taxi-platform"."bronze_silver"."dim_date"
where date_key is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [bronze].[testview_97a1514f1de409d55b5193a479b57439_8838]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [bronze].[testview_97a1514f1de409d55b5193a479b57439_8838]
  ;')
[0m15:01:22.219272 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:01:22.219272 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:01:22.220272 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:01:22.281523 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:01:22.283341 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_dim_date_date_key.881d0a31b6: ROLLBACK
[0m15:01:22.283341 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_dim_date_date_key.881d0a31b6: Close
[0m15:01:22.284332 [info ] [Thread-1 (]: 3 of 15 PASS not_null_dim_date_date_key ........................................ [[32mPASS[0m in 0.08s]
[0m15:01:22.284332 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_dim_date_date_key.881d0a31b6
[0m15:01:22.285332 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626
[0m15:01:22.285332 [info ] [Thread-1 (]: 4 of 15 START test not_null_dim_payment_type_payment_type ...................... [RUN]
[0m15:01:22.286389 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_dim_date_date_key.881d0a31b6, now test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626)
[0m15:01:22.286389 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626
[0m15:01:22.289458 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626"
[0m15:01:22.291397 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626
[0m15:01:22.293452 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626"
[0m15:01:22.294160 [debug] [Thread-1 (]: Using sqlserver connection "test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626"
[0m15:01:22.294160 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626"} */

    -- Create target schema if it does not
  USE [sqldb-taxi-platform];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'bronze')
  BEGIN
    EXEC('CREATE SCHEMA [bronze]')
  END

  

  
  EXEC('create view 
    [bronze].[testview_2ad2dc6a1d72454bc6f07cc7701e665e_17561]
   as 
    
    
    



select payment_type
from "sqldb-taxi-platform"."bronze_silver"."dim_payment_type"
where payment_type is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [bronze].[testview_2ad2dc6a1d72454bc6f07cc7701e665e_17561]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [bronze].[testview_2ad2dc6a1d72454bc6f07cc7701e665e_17561]
  ;')
[0m15:01:22.295227 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:01:22.295227 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:01:22.296167 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:01:22.351295 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:01:22.353304 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626: ROLLBACK
[0m15:01:22.353304 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626: Close
[0m15:01:22.354294 [info ] [Thread-1 (]: 4 of 15 PASS not_null_dim_payment_type_payment_type ............................ [[32mPASS[0m in 0.07s]
[0m15:01:22.354294 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626
[0m15:01:22.355302 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c
[0m15:01:22.355302 [info ] [Thread-1 (]: 5 of 15 START test not_null_fact_trips_pickup_date ............................. [RUN]
[0m15:01:22.356294 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626, now test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c)
[0m15:01:22.356294 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c
[0m15:01:22.360301 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c"
[0m15:01:22.361294 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c
[0m15:01:22.363303 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c"
[0m15:01:22.364302 [debug] [Thread-1 (]: Using sqlserver connection "test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c"
[0m15:01:22.365012 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c"} */

    -- Create target schema if it does not
  USE [sqldb-taxi-platform];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'bronze')
  BEGIN
    EXEC('CREATE SCHEMA [bronze]')
  END

  

  
  EXEC('create view 
    [bronze].[testview_7d112b4bacf9180b503a254961208261_3863]
   as 
    
    
    



select pickup_date
from "sqldb-taxi-platform"."bronze_silver"."fact_trips"
where pickup_date is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [bronze].[testview_7d112b4bacf9180b503a254961208261_3863]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [bronze].[testview_7d112b4bacf9180b503a254961208261_3863]
  ;')
[0m15:01:22.365012 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:01:22.365012 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:01:22.366011 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:01:22.421670 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:01:22.422679 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c: ROLLBACK
[0m15:01:22.423677 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c: Close
[0m15:01:22.423677 [info ] [Thread-1 (]: 5 of 15 PASS not_null_fact_trips_pickup_date ................................... [[32mPASS[0m in 0.07s]
[0m15:01:22.424670 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c
[0m15:01:22.424670 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442
[0m15:01:22.425678 [info ] [Thread-1 (]: 6 of 15 START test not_null_fact_trips_trip_id ................................. [RUN]
[0m15:01:22.425678 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c, now test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442)
[0m15:01:22.426678 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442
[0m15:01:22.429677 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442"
[0m15:01:22.431357 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442
[0m15:01:22.433364 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442"
[0m15:01:22.433364 [debug] [Thread-1 (]: Using sqlserver connection "test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442"
[0m15:01:22.434357 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442"} */

    -- Create target schema if it does not
  USE [sqldb-taxi-platform];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'bronze')
  BEGIN
    EXEC('CREATE SCHEMA [bronze]')
  END

  

  
  EXEC('create view 
    [bronze].[testview_20905412c48dcf3bfd76540d3b87984e_4270]
   as 
    
    
    



select trip_id
from "sqldb-taxi-platform"."bronze_silver"."fact_trips"
where trip_id is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [bronze].[testview_20905412c48dcf3bfd76540d3b87984e_4270]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [bronze].[testview_20905412c48dcf3bfd76540d3b87984e_4270]
  ;')
[0m15:01:22.434357 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:01:22.435357 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:01:22.435357 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:01:22.718793 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:01:22.720567 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442: ROLLBACK
[0m15:01:22.720567 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442: Close
[0m15:01:22.721502 [info ] [Thread-1 (]: 6 of 15 PASS not_null_fact_trips_trip_id ....................................... [[32mPASS[0m in 0.30s]
[0m15:01:22.722022 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442
[0m15:01:22.722022 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b
[0m15:01:22.723051 [info ] [Thread-1 (]: 7 of 15 START test not_null_stg_trips_dropoff_datetime ......................... [RUN]
[0m15:01:22.724050 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442, now test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b)
[0m15:01:22.724050 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b
[0m15:01:22.728096 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b"
[0m15:01:22.729095 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b
[0m15:01:22.731044 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b"
[0m15:01:22.736227 [debug] [Thread-1 (]: Using sqlserver connection "test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b"
[0m15:01:22.737241 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b"} */

    -- Create target schema if it does not
  USE [sqldb-taxi-platform];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'bronze')
  BEGIN
    EXEC('CREATE SCHEMA [bronze]')
  END

  

  
  EXEC('create view 
    [bronze].[testview_4c8d3f315598f1637f069cf3074df17a_2882]
   as 
    
    
    



select dropoff_datetime
from "sqldb-taxi-platform"."bronze_bronze"."stg_trips"
where dropoff_datetime is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [bronze].[testview_4c8d3f315598f1637f069cf3074df17a_2882]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [bronze].[testview_4c8d3f315598f1637f069cf3074df17a_2882]
  ;')
[0m15:01:22.737241 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:01:22.737241 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:01:22.738269 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:01:23.296057 [debug] [Thread-1 (]: SQL status: OK in 1.000 seconds
[0m15:01:23.297138 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b: ROLLBACK
[0m15:01:23.297138 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b: Close
[0m15:01:23.298128 [info ] [Thread-1 (]: 7 of 15 PASS not_null_stg_trips_dropoff_datetime ............................... [[32mPASS[0m in 0.58s]
[0m15:01:23.299111 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b
[0m15:01:23.299111 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74
[0m15:01:23.300069 [info ] [Thread-1 (]: 8 of 15 START test not_null_stg_trips_fare_amount .............................. [RUN]
[0m15:01:23.301070 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b, now test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74)
[0m15:01:23.301070 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74
[0m15:01:23.304225 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74"
[0m15:01:23.306228 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74
[0m15:01:23.308231 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74"
[0m15:01:23.309224 [debug] [Thread-1 (]: Using sqlserver connection "test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74"
[0m15:01:23.309224 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74"} */

    -- Create target schema if it does not
  USE [sqldb-taxi-platform];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'bronze')
  BEGIN
    EXEC('CREATE SCHEMA [bronze]')
  END

  

  
  EXEC('create view 
    [bronze].[testview_9ea19f17f3a1a85ec021164b6969d1d9_3406]
   as 
    
    
    



select fare_amount
from "sqldb-taxi-platform"."bronze_bronze"."stg_trips"
where fare_amount is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [bronze].[testview_9ea19f17f3a1a85ec021164b6969d1d9_3406]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [bronze].[testview_9ea19f17f3a1a85ec021164b6969d1d9_3406]
  ;')
[0m15:01:23.310231 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:01:23.310231 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:01:23.311231 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:01:23.979589 [debug] [Thread-1 (]: SQL status: OK in 1.000 seconds
[0m15:01:23.981693 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74: ROLLBACK
[0m15:01:23.981693 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74: Close
[0m15:01:23.982684 [info ] [Thread-1 (]: 8 of 15 PASS not_null_stg_trips_fare_amount .................................... [[32mPASS[0m in 0.68s]
[0m15:01:23.983271 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74
[0m15:01:23.983271 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c
[0m15:01:23.984375 [info ] [Thread-1 (]: 9 of 15 START test not_null_stg_trips_pickup_datetime .......................... [RUN]
[0m15:01:23.985283 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74, now test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c)
[0m15:01:23.985283 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c
[0m15:01:23.989285 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c"
[0m15:01:23.990285 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c
[0m15:01:23.992295 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c"
[0m15:01:23.997610 [debug] [Thread-1 (]: Using sqlserver connection "test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c"
[0m15:01:23.997610 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c"} */

    -- Create target schema if it does not
  USE [sqldb-taxi-platform];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'bronze')
  BEGIN
    EXEC('CREATE SCHEMA [bronze]')
  END

  

  
  EXEC('create view 
    [bronze].[testview_c8f1217ea7ae423f95431cf67128255c_12374]
   as 
    
    
    



select pickup_datetime
from "sqldb-taxi-platform"."bronze_bronze"."stg_trips"
where pickup_datetime is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [bronze].[testview_c8f1217ea7ae423f95431cf67128255c_12374]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [bronze].[testview_c8f1217ea7ae423f95431cf67128255c_12374]
  ;')
[0m15:01:23.997610 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:01:23.998620 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:01:23.998620 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:01:24.560174 [debug] [Thread-1 (]: SQL status: OK in 1.000 seconds
[0m15:01:24.562185 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c: ROLLBACK
[0m15:01:24.562185 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c: Close
[0m15:01:24.563177 [info ] [Thread-1 (]: 9 of 15 PASS not_null_stg_trips_pickup_datetime ................................ [[32mPASS[0m in 0.58s]
[0m15:01:24.563177 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c
[0m15:01:24.564673 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae
[0m15:01:24.564673 [info ] [Thread-1 (]: 10 of 15 START test not_null_stg_trips_total_amount ............................ [RUN]
[0m15:01:24.565672 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c, now test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae)
[0m15:01:24.565672 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae
[0m15:01:24.569669 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae"
[0m15:01:24.570669 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae
[0m15:01:24.572669 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae"
[0m15:01:24.577670 [debug] [Thread-1 (]: Using sqlserver connection "test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae"
[0m15:01:24.578669 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae"} */

    -- Create target schema if it does not
  USE [sqldb-taxi-platform];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'bronze')
  BEGIN
    EXEC('CREATE SCHEMA [bronze]')
  END

  

  
  EXEC('create view 
    [bronze].[testview_83c247fd7dcf1f459750c2de25501c63_5681]
   as 
    
    
    



select total_amount
from "sqldb-taxi-platform"."bronze_bronze"."stg_trips"
where total_amount is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [bronze].[testview_83c247fd7dcf1f459750c2de25501c63_5681]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [bronze].[testview_83c247fd7dcf1f459750c2de25501c63_5681]
  ;')
[0m15:01:24.578669 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:01:24.578669 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:01:24.579669 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:01:25.122263 [debug] [Thread-1 (]: SQL status: OK in 1.000 seconds
[0m15:01:25.123270 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae: ROLLBACK
[0m15:01:25.123270 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae: Close
[0m15:01:25.124263 [info ] [Thread-1 (]: 10 of 15 PASS not_null_stg_trips_total_amount .................................. [[32mPASS[0m in 0.56s]
[0m15:01:25.125263 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae
[0m15:01:25.125263 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b
[0m15:01:25.126275 [info ] [Thread-1 (]: 11 of 15 START test not_null_stg_trips_trip_distance ........................... [RUN]
[0m15:01:25.127278 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae, now test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b)
[0m15:01:25.127278 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b
[0m15:01:25.131425 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b"
[0m15:01:25.131934 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b
[0m15:01:25.133942 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b"
[0m15:01:25.134943 [debug] [Thread-1 (]: Using sqlserver connection "test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b"
[0m15:01:25.135933 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b"} */

    -- Create target schema if it does not
  USE [sqldb-taxi-platform];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'bronze')
  BEGIN
    EXEC('CREATE SCHEMA [bronze]')
  END

  

  
  EXEC('create view 
    [bronze].[testview_98902cdd2f59126a71dede1190f25913_6017]
   as 
    
    
    



select trip_distance
from "sqldb-taxi-platform"."bronze_bronze"."stg_trips"
where trip_distance is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [bronze].[testview_98902cdd2f59126a71dede1190f25913_6017]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [bronze].[testview_98902cdd2f59126a71dede1190f25913_6017]
  ;')
[0m15:01:25.135933 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:01:25.136946 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:01:25.136946 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:01:25.768889 [debug] [Thread-1 (]: SQL status: OK in 1.000 seconds
[0m15:01:25.770883 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b: ROLLBACK
[0m15:01:25.771876 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b: Close
[0m15:01:25.771876 [info ] [Thread-1 (]: 11 of 15 PASS not_null_stg_trips_trip_distance ................................. [[32mPASS[0m in 0.64s]
[0m15:01:25.772775 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b
[0m15:01:25.772775 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6
[0m15:01:25.773788 [info ] [Thread-1 (]: 12 of 15 START test relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_  [RUN]
[0m15:01:25.774790 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b, now test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6)
[0m15:01:25.774790 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6
[0m15:01:25.778795 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6"
[0m15:01:25.784458 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6
[0m15:01:25.785977 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6"
[0m15:01:25.786973 [debug] [Thread-1 (]: Using sqlserver connection "test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6"
[0m15:01:25.786973 [debug] [Thread-1 (]: On test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6"} */

    -- Create target schema if it does not
  USE [sqldb-taxi-platform];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'bronze')
  BEGIN
    EXEC('CREATE SCHEMA [bronze]')
  END

  

  
  EXEC('create view 
    [bronze].[testview_fe69b692e4963f1fa2cf4dd07e39b696_9214]
   as 
    
    
    

with child as (
    select payment_type as from_field
    from "sqldb-taxi-platform"."bronze_silver"."fact_trips"
    where payment_type is not null
),

parent as (
    select payment_type as to_field
    from "sqldb-taxi-platform"."bronze_silver"."dim_payment_type"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [bronze].[testview_fe69b692e4963f1fa2cf4dd07e39b696_9214]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [bronze].[testview_fe69b692e4963f1fa2cf4dd07e39b696_9214]
  ;')
[0m15:01:25.787965 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:01:25.787965 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:01:25.788966 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:01:25.849628 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:01:25.850691 [debug] [Thread-1 (]: On test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6: ROLLBACK
[0m15:01:25.850691 [debug] [Thread-1 (]: On test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6: Close
[0m15:01:25.851629 [info ] [Thread-1 (]: 12 of 15 PASS relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_  [[32mPASS[0m in 0.08s]
[0m15:01:25.852687 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6
[0m15:01:25.852687 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.unique_dim_date_date_key.0869fd48f9
[0m15:01:25.852687 [info ] [Thread-1 (]: 13 of 15 START test unique_dim_date_date_key ................................... [RUN]
[0m15:01:25.853916 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6, now test.taxi_nyc_project.unique_dim_date_date_key.0869fd48f9)
[0m15:01:25.853916 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.unique_dim_date_date_key.0869fd48f9
[0m15:01:25.858991 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.unique_dim_date_date_key.0869fd48f9"
[0m15:01:25.860563 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.unique_dim_date_date_key.0869fd48f9
[0m15:01:25.862166 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_nyc_project.unique_dim_date_date_key.0869fd48f9"
[0m15:01:25.864174 [debug] [Thread-1 (]: Using sqlserver connection "test.taxi_nyc_project.unique_dim_date_date_key.0869fd48f9"
[0m15:01:25.864174 [debug] [Thread-1 (]: On test.taxi_nyc_project.unique_dim_date_date_key.0869fd48f9: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "test.taxi_nyc_project.unique_dim_date_date_key.0869fd48f9"} */

    -- Create target schema if it does not
  USE [sqldb-taxi-platform];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'bronze')
  BEGIN
    EXEC('CREATE SCHEMA [bronze]')
  END

  

  
  EXEC('create view 
    [bronze].[testview_a400e2b5a883a058e35f384156d65f3b_2014]
   as 
    
    
    

select
    date_key as unique_field,
    count(*) as n_records

from "sqldb-taxi-platform"."bronze_silver"."dim_date"
where date_key is not null
group by date_key
having count(*) > 1



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [bronze].[testview_a400e2b5a883a058e35f384156d65f3b_2014]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [bronze].[testview_a400e2b5a883a058e35f384156d65f3b_2014]
  ;')
[0m15:01:25.864174 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:01:25.865163 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:01:25.865163 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:01:25.921668 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:01:25.922666 [debug] [Thread-1 (]: On test.taxi_nyc_project.unique_dim_date_date_key.0869fd48f9: ROLLBACK
[0m15:01:25.922666 [debug] [Thread-1 (]: On test.taxi_nyc_project.unique_dim_date_date_key.0869fd48f9: Close
[0m15:01:25.923732 [info ] [Thread-1 (]: 13 of 15 PASS unique_dim_date_date_key ......................................... [[32mPASS[0m in 0.07s]
[0m15:01:25.924782 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.unique_dim_date_date_key.0869fd48f9
[0m15:01:25.924782 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58
[0m15:01:25.925566 [info ] [Thread-1 (]: 14 of 15 START test unique_dim_payment_type_payment_type ....................... [RUN]
[0m15:01:25.925566 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.unique_dim_date_date_key.0869fd48f9, now test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58)
[0m15:01:25.926572 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58
[0m15:01:25.929572 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58"
[0m15:01:25.930572 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58
[0m15:01:25.932572 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58"
[0m15:01:25.933571 [debug] [Thread-1 (]: Using sqlserver connection "test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58"
[0m15:01:25.934572 [debug] [Thread-1 (]: On test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58"} */

    -- Create target schema if it does not
  USE [sqldb-taxi-platform];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'bronze')
  BEGIN
    EXEC('CREATE SCHEMA [bronze]')
  END

  

  
  EXEC('create view 
    [bronze].[testview_5fb5eb828135bf31fab7f64ef24093d1_8092]
   as 
    
    
    

select
    payment_type as unique_field,
    count(*) as n_records

from "sqldb-taxi-platform"."bronze_silver"."dim_payment_type"
where payment_type is not null
group by payment_type
having count(*) > 1



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [bronze].[testview_5fb5eb828135bf31fab7f64ef24093d1_8092]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [bronze].[testview_5fb5eb828135bf31fab7f64ef24093d1_8092]
  ;')
[0m15:01:25.934572 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:01:25.935571 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:01:25.935571 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:01:25.991473 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:01:25.992554 [debug] [Thread-1 (]: On test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58: ROLLBACK
[0m15:01:25.993493 [debug] [Thread-1 (]: On test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58: Close
[0m15:01:25.993493 [info ] [Thread-1 (]: 14 of 15 PASS unique_dim_payment_type_payment_type ............................. [[32mPASS[0m in 0.07s]
[0m15:01:25.994530 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58
[0m15:01:25.994530 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e
[0m15:01:25.995493 [info ] [Thread-1 (]: 15 of 15 START test unique_fact_trips_trip_id .................................. [RUN]
[0m15:01:25.995493 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58, now test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e)
[0m15:01:25.996497 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e
[0m15:01:25.999498 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e"
[0m15:01:26.000491 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e
[0m15:01:26.002501 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e"
[0m15:01:26.004090 [debug] [Thread-1 (]: Using sqlserver connection "test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e"
[0m15:01:26.005089 [debug] [Thread-1 (]: On test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e"} */

    -- Create target schema if it does not
  USE [sqldb-taxi-platform];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'bronze')
  BEGIN
    EXEC('CREATE SCHEMA [bronze]')
  END

  

  
  EXEC('create view 
    [bronze].[testview_2a9748c0e241ec04f816d7766bd33ba6_8213]
   as 
    
    
    

select
    trip_id as unique_field,
    count(*) as n_records

from "sqldb-taxi-platform"."bronze_silver"."fact_trips"
where trip_id is not null
group by trip_id
having count(*) > 1



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [bronze].[testview_2a9748c0e241ec04f816d7766bd33ba6_8213]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [bronze].[testview_2a9748c0e241ec04f816d7766bd33ba6_8213]
  ;')
[0m15:01:26.005089 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:01:26.005089 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:01:26.006090 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:01:26.137556 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:01:26.139550 [debug] [Thread-1 (]: On test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e: ROLLBACK
[0m15:01:26.139550 [debug] [Thread-1 (]: On test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e: Close
[0m15:01:26.140550 [info ] [Thread-1 (]: 15 of 15 PASS unique_fact_trips_trip_id ........................................ [[32mPASS[0m in 0.15s]
[0m15:01:26.141557 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e
[0m15:01:26.143550 [debug] [MainThread]: On master: COMMIT
[0m15:01:26.143550 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:01:26.144559 [debug] [MainThread]: Connection 'list_sqldb-taxi-platform_bronze_silver' was properly closed.
[0m15:01:26.144559 [debug] [MainThread]: Connection 'test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e' was properly closed.
[0m15:01:26.145550 [info ] [MainThread]: 
[0m15:01:26.145550 [info ] [MainThread]: Finished running 15 data tests in 0 hours 0 minutes and 5.52 seconds (5.52s).
[0m15:01:26.148549 [debug] [MainThread]: Command end result
[0m15:01:26.171548 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\manifest.json
[0m15:01:26.174549 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\semantic_manifest.json
[0m15:01:26.180613 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\run_results.json
[0m15:01:26.181641 [info ] [MainThread]: 
[0m15:01:26.181641 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:01:26.182622 [info ] [MainThread]: 
[0m15:01:26.183550 [error] [MainThread]: [31mFailure in test accepted_values_stg_trips_rate_code_id__1__2__3__4__5__6 (models\schema.yml)[0m
[0m15:01:26.183550 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m15:01:26.184549 [info ] [MainThread]: 
[0m15:01:26.184549 [info ] [MainThread]:   compiled code at target\compiled\taxi_nyc_project\models\schema.yml\accepted_values_stg_trips_rate_code_id__1__2__3__4__5__6.sql
[0m15:01:26.185550 [info ] [MainThread]: 
[0m15:01:26.185550 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=15
[0m15:01:26.186550 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 3 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:01:26.186550 [debug] [MainThread]: Command `dbt test` failed at 15:01:26.186550 after 6.69 seconds
[0m15:01:26.187550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021481813350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021481812790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021483554090>]}
[0m15:01:26.187550 [debug] [MainThread]: Flushing usage events
[0m15:01:26.953202 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:05:02.729259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C3D9121D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C3C91D710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C3D912D10>]}


============================== 15:05:02.732258 | 07248d6e-407c-4a00-87ce-94afe5f39fb5 ==============================
[0m15:05:02.732258 [info ] [MainThread]: Running with dbt=1.10.15
[0m15:05:02.733258 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'no_print': 'None', 'profiles_dir': '.', 'use_colors': 'True', 'target_path': 'None', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'log_path': 'C:\\Users\\alexm\\Desktop\\python\\azure-taxi-platform\\dbt_project\\logs', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir .', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m15:05:03.061333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '07248d6e-407c-4a00-87ce-94afe5f39fb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C3F20F950>]}
[0m15:05:03.106338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '07248d6e-407c-4a00-87ce-94afe5f39fb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C3F06D410>]}
[0m15:05:03.107333 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m15:05:03.327603 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m15:05:03.499123 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:05:03.500124 [debug] [MainThread]: Partial parsing: updated file: taxi_nyc_project://models\schema.yml
[0m15:05:03.752479 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m15:05:03.753475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '07248d6e-407c-4a00-87ce-94afe5f39fb5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C3F7A15D0>]}
[0m15:05:03.817540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '07248d6e-407c-4a00-87ce-94afe5f39fb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C3F836390>]}
[0m15:05:03.876087 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\manifest.json
[0m15:05:03.878090 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\semantic_manifest.json
[0m15:05:03.905600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '07248d6e-407c-4a00-87ce-94afe5f39fb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C3FB04190>]}
[0m15:05:03.906600 [info ] [MainThread]: Found 8 models, 15 data tests, 535 macros
[0m15:05:03.907607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07248d6e-407c-4a00-87ce-94afe5f39fb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C3FADE890>]}
[0m15:05:03.909601 [info ] [MainThread]: 
[0m15:05:03.909601 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:05:03.910601 [info ] [MainThread]: 
[0m15:05:03.910601 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m15:05:03.915601 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_sqldb-taxi-platform_bronze_bronze'
[0m15:05:03.927606 [debug] [ThreadPool]: dbt-sqlserver
[0m15:05:03.927606 [debug] [ThreadPool]: Using sqlserver connection "list_sqldb-taxi-platform_bronze_bronze"
[0m15:05:03.928599 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "list_sqldb-taxi-platform_bronze_bronze"} */
USE [sqldb-taxi-platform];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze_bronze'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m15:05:03.928599 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:05:03.929606 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:05:04.531972 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:05:04.578012 [debug] [ThreadPool]: SQL status: OK in 1.000 seconds
[0m15:05:04.580012 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_bronze: ROLLBACK
[0m15:05:04.580012 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_bronze: Close
[0m15:05:04.581003 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sqldb-taxi-platform_bronze_bronze, now list_sqldb-taxi-platform_bronze_silver)
[0m15:05:04.583010 [debug] [ThreadPool]: dbt-sqlserver
[0m15:05:04.583010 [debug] [ThreadPool]: Using sqlserver connection "list_sqldb-taxi-platform_bronze_silver"
[0m15:05:04.584013 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "list_sqldb-taxi-platform_bronze_silver"} */
USE [sqldb-taxi-platform];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze_silver'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m15:05:04.584013 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:05:04.585011 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:05:04.585011 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:05:04.630773 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:05:04.631782 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_silver: ROLLBACK
[0m15:05:04.632786 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_silver: Close
[0m15:05:04.632786 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sqldb-taxi-platform_bronze_silver, now list_sqldb-taxi-platform_bronze_gold)
[0m15:05:04.635780 [debug] [ThreadPool]: dbt-sqlserver
[0m15:05:04.635780 [debug] [ThreadPool]: Using sqlserver connection "list_sqldb-taxi-platform_bronze_gold"
[0m15:05:04.635780 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_gold: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "list_sqldb-taxi-platform_bronze_gold"} */
USE [sqldb-taxi-platform];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze_gold'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m15:05:04.636783 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:05:04.636783 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:05:04.636783 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:05:04.683313 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:05:04.684307 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_gold: ROLLBACK
[0m15:05:04.684307 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_gold: Close
[0m15:05:04.686306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07248d6e-407c-4a00-87ce-94afe5f39fb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C3FADE3D0>]}
[0m15:05:04.686306 [debug] [MainThread]: On master: COMMIT
[0m15:05:04.690306 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec
[0m15:05:04.690306 [info ] [Thread-1 (]: 1 of 15 START test accepted_values_stg_trips_payment_type__1__2__3__4__5__6 .... [RUN]
[0m15:05:04.691317 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec'
[0m15:05:04.691317 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec
[0m15:05:04.699313 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec"
[0m15:05:04.700307 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec
[0m15:05:04.716313 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec"
[0m15:05:04.716313 [debug] [Thread-1 (]: Using sqlserver connection "test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec"
[0m15:05:04.717306 [debug] [Thread-1 (]: On test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec"} */

    -- Create target schema if it does not
  USE [sqldb-taxi-platform];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'bronze')
  BEGIN
    EXEC('CREATE SCHEMA [bronze]')
  END

  

  
  EXEC('create view 
    [bronze].[testview_f33210bcd4b055fe9687c095053b88a1_7828]
   as 
    
    
    

with all_values as (

    select
        payment_type as value_field,
        count(*) as n_records

    from "sqldb-taxi-platform"."bronze_bronze"."stg_trips"
    group by payment_type

)

select *
from all_values
where value_field not in (
    ''1'',''2'',''3'',''4'',''5'',''6''
)



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [bronze].[testview_f33210bcd4b055fe9687c095053b88a1_7828]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [bronze].[testview_f33210bcd4b055fe9687c095053b88a1_7828]
  ;')
[0m15:05:04.717306 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:05:04.718306 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:05:04.718306 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:05:04.794216 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:05:04.797214 [debug] [Thread-1 (]: On test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec: ROLLBACK
[0m15:05:04.797214 [debug] [Thread-1 (]: On test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec: Close
[0m15:05:04.798142 [info ] [Thread-1 (]: 1 of 15 PASS accepted_values_stg_trips_payment_type__1__2__3__4__5__6 .......... [[32mPASS[0m in 0.11s]
[0m15:05:04.799159 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec
[0m15:05:04.799159 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d
[0m15:05:04.800163 [info ] [Thread-1 (]: 2 of 15 START test accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99 ... [RUN]
[0m15:05:04.800163 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec, now test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d)
[0m15:05:04.801163 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d
[0m15:05:04.804168 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d"
[0m15:05:04.805167 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d
[0m15:05:04.807161 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d"
[0m15:05:04.808163 [debug] [Thread-1 (]: Using sqlserver connection "test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d"
[0m15:05:04.809162 [debug] [Thread-1 (]: On test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d"} */

    -- Create target schema if it does not
  USE [sqldb-taxi-platform];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'bronze')
  BEGIN
    EXEC('CREATE SCHEMA [bronze]')
  END

  

  
  EXEC('create view 
    [bronze].[testview_4dded7e06fdf8cf96858af6f2dabdb0d_13608]
   as 
    
    
    

with all_values as (

    select
        rate_code_id as value_field,
        count(*) as n_records

    from "sqldb-taxi-platform"."bronze_bronze"."stg_trips"
    group by rate_code_id

)

select *
from all_values
where value_field not in (
    ''1'',''2'',''3'',''4'',''5'',''99''
)



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [bronze].[testview_4dded7e06fdf8cf96858af6f2dabdb0d_13608]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [bronze].[testview_4dded7e06fdf8cf96858af6f2dabdb0d_13608]
  ;')
[0m15:05:04.809162 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:04.810170 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:05:04.810170 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:05:04.868457 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:05:04.869458 [debug] [Thread-1 (]: On test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d: ROLLBACK
[0m15:05:04.870451 [debug] [Thread-1 (]: On test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d: Close
[0m15:05:04.871461 [info ] [Thread-1 (]: 2 of 15 PASS accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99 ......... [[32mPASS[0m in 0.07s]
[0m15:05:04.871461 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d
[0m15:05:04.872451 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_dim_date_date_key.881d0a31b6
[0m15:05:04.872451 [info ] [Thread-1 (]: 3 of 15 START test not_null_dim_date_date_key .................................. [RUN]
[0m15:05:04.873451 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d, now test.taxi_nyc_project.not_null_dim_date_date_key.881d0a31b6)
[0m15:05:04.873451 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_dim_date_date_key.881d0a31b6
[0m15:05:04.879457 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_dim_date_date_key.881d0a31b6"
[0m15:05:04.879457 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_dim_date_date_key.881d0a31b6
[0m15:05:04.881451 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_nyc_project.not_null_dim_date_date_key.881d0a31b6"
[0m15:05:04.882458 [debug] [Thread-1 (]: Using sqlserver connection "test.taxi_nyc_project.not_null_dim_date_date_key.881d0a31b6"
[0m15:05:04.883452 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_dim_date_date_key.881d0a31b6: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "test.taxi_nyc_project.not_null_dim_date_date_key.881d0a31b6"} */

    -- Create target schema if it does not
  USE [sqldb-taxi-platform];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'bronze')
  BEGIN
    EXEC('CREATE SCHEMA [bronze]')
  END

  

  
  EXEC('create view 
    [bronze].[testview_97a1514f1de409d55b5193a479b57439_4426]
   as 
    
    
    



select date_key
from "sqldb-taxi-platform"."bronze_silver"."dim_date"
where date_key is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [bronze].[testview_97a1514f1de409d55b5193a479b57439_4426]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [bronze].[testview_97a1514f1de409d55b5193a479b57439_4426]
  ;')
[0m15:05:04.883452 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:04.883452 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:05:04.884461 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:05:04.941093 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:05:04.943091 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_dim_date_date_key.881d0a31b6: ROLLBACK
[0m15:05:04.943091 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_dim_date_date_key.881d0a31b6: Close
[0m15:05:04.944092 [info ] [Thread-1 (]: 3 of 15 PASS not_null_dim_date_date_key ........................................ [[32mPASS[0m in 0.07s]
[0m15:05:04.945092 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_dim_date_date_key.881d0a31b6
[0m15:05:04.945092 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626
[0m15:05:04.945092 [info ] [Thread-1 (]: 4 of 15 START test not_null_dim_payment_type_payment_type ...................... [RUN]
[0m15:05:04.946091 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_dim_date_date_key.881d0a31b6, now test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626)
[0m15:05:04.946091 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626
[0m15:05:04.950092 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626"
[0m15:05:04.951094 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626
[0m15:05:04.953608 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626"
[0m15:05:04.954609 [debug] [Thread-1 (]: Using sqlserver connection "test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626"
[0m15:05:04.954609 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626"} */

    -- Create target schema if it does not
  USE [sqldb-taxi-platform];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'bronze')
  BEGIN
    EXEC('CREATE SCHEMA [bronze]')
  END

  

  
  EXEC('create view 
    [bronze].[testview_2ad2dc6a1d72454bc6f07cc7701e665e_8601]
   as 
    
    
    



select payment_type
from "sqldb-taxi-platform"."bronze_silver"."dim_payment_type"
where payment_type is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [bronze].[testview_2ad2dc6a1d72454bc6f07cc7701e665e_8601]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [bronze].[testview_2ad2dc6a1d72454bc6f07cc7701e665e_8601]
  ;')
[0m15:05:04.955609 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:04.955609 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:05:04.956610 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:05:05.011635 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:05:05.013642 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626: ROLLBACK
[0m15:05:05.013642 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626: Close
[0m15:05:05.014643 [info ] [Thread-1 (]: 4 of 15 PASS not_null_dim_payment_type_payment_type ............................ [[32mPASS[0m in 0.07s]
[0m15:05:05.015650 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626
[0m15:05:05.015650 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c
[0m15:05:05.016642 [info ] [Thread-1 (]: 5 of 15 START test not_null_fact_trips_pickup_date ............................. [RUN]
[0m15:05:05.016642 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626, now test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c)
[0m15:05:05.017635 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c
[0m15:05:05.020636 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c"
[0m15:05:05.021644 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c
[0m15:05:05.024642 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c"
[0m15:05:05.025642 [debug] [Thread-1 (]: Using sqlserver connection "test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c"
[0m15:05:05.026635 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c"} */

    -- Create target schema if it does not
  USE [sqldb-taxi-platform];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'bronze')
  BEGIN
    EXEC('CREATE SCHEMA [bronze]')
  END

  

  
  EXEC('create view 
    [bronze].[testview_7d112b4bacf9180b503a254961208261_1609]
   as 
    
    
    



select pickup_date
from "sqldb-taxi-platform"."bronze_silver"."fact_trips"
where pickup_date is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [bronze].[testview_7d112b4bacf9180b503a254961208261_1609]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [bronze].[testview_7d112b4bacf9180b503a254961208261_1609]
  ;')
[0m15:05:05.026635 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:05.027636 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:05:05.027636 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:05:05.085313 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:05:05.086322 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c: ROLLBACK
[0m15:05:05.087318 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c: Close
[0m15:05:05.087318 [info ] [Thread-1 (]: 5 of 15 PASS not_null_fact_trips_pickup_date ................................... [[32mPASS[0m in 0.07s]
[0m15:05:05.088324 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c
[0m15:05:05.089325 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442
[0m15:05:05.089325 [info ] [Thread-1 (]: 6 of 15 START test not_null_fact_trips_trip_id ................................. [RUN]
[0m15:05:05.090319 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c, now test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442)
[0m15:05:05.090319 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442
[0m15:05:05.094314 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442"
[0m15:05:05.095313 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442
[0m15:05:05.097325 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442"
[0m15:05:05.098313 [debug] [Thread-1 (]: Using sqlserver connection "test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442"
[0m15:05:05.098313 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442"} */

    -- Create target schema if it does not
  USE [sqldb-taxi-platform];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'bronze')
  BEGIN
    EXEC('CREATE SCHEMA [bronze]')
  END

  

  
  EXEC('create view 
    [bronze].[testview_20905412c48dcf3bfd76540d3b87984e_17438]
   as 
    
    
    



select trip_id
from "sqldb-taxi-platform"."bronze_silver"."fact_trips"
where trip_id is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [bronze].[testview_20905412c48dcf3bfd76540d3b87984e_17438]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [bronze].[testview_20905412c48dcf3bfd76540d3b87984e_17438]
  ;')
[0m15:05:05.099325 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:05.099325 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:05:05.099325 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:05:05.156445 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:05:05.157445 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442: ROLLBACK
[0m15:05:05.157445 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442: Close
[0m15:05:05.158445 [info ] [Thread-1 (]: 6 of 15 PASS not_null_fact_trips_trip_id ....................................... [[32mPASS[0m in 0.07s]
[0m15:05:05.159485 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442
[0m15:05:05.159485 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b
[0m15:05:05.160480 [info ] [Thread-1 (]: 7 of 15 START test not_null_stg_trips_dropoff_datetime ......................... [RUN]
[0m15:05:05.161473 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442, now test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b)
[0m15:05:05.161473 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b
[0m15:05:05.165479 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b"
[0m15:05:05.166479 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b
[0m15:05:05.168479 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b"
[0m15:05:05.169483 [debug] [Thread-1 (]: Using sqlserver connection "test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b"
[0m15:05:05.169483 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b"} */

    -- Create target schema if it does not
  USE [sqldb-taxi-platform];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'bronze')
  BEGIN
    EXEC('CREATE SCHEMA [bronze]')
  END

  

  
  EXEC('create view 
    [bronze].[testview_4c8d3f315598f1637f069cf3074df17a_7931]
   as 
    
    
    



select dropoff_datetime
from "sqldb-taxi-platform"."bronze_bronze"."stg_trips"
where dropoff_datetime is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [bronze].[testview_4c8d3f315598f1637f069cf3074df17a_7931]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [bronze].[testview_4c8d3f315598f1637f069cf3074df17a_7931]
  ;')
[0m15:05:05.170472 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:05.170472 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:05:05.171472 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:05:05.227093 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:05:05.228106 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b: ROLLBACK
[0m15:05:05.228106 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b: Close
[0m15:05:05.229105 [info ] [Thread-1 (]: 7 of 15 PASS not_null_stg_trips_dropoff_datetime ............................... [[32mPASS[0m in 0.07s]
[0m15:05:05.230104 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b
[0m15:05:05.230104 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74
[0m15:05:05.231105 [info ] [Thread-1 (]: 8 of 15 START test not_null_stg_trips_fare_amount .............................. [RUN]
[0m15:05:05.232105 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b, now test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74)
[0m15:05:05.232105 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74
[0m15:05:05.236105 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74"
[0m15:05:05.236105 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74
[0m15:05:05.238105 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74"
[0m15:05:05.239105 [debug] [Thread-1 (]: Using sqlserver connection "test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74"
[0m15:05:05.240105 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74"} */

    -- Create target schema if it does not
  USE [sqldb-taxi-platform];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'bronze')
  BEGIN
    EXEC('CREATE SCHEMA [bronze]')
  END

  

  
  EXEC('create view 
    [bronze].[testview_9ea19f17f3a1a85ec021164b6969d1d9_6538]
   as 
    
    
    



select fare_amount
from "sqldb-taxi-platform"."bronze_bronze"."stg_trips"
where fare_amount is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [bronze].[testview_9ea19f17f3a1a85ec021164b6969d1d9_6538]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [bronze].[testview_9ea19f17f3a1a85ec021164b6969d1d9_6538]
  ;')
[0m15:05:05.240105 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:05.240105 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:05:05.241105 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:05:05.298286 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:05:05.299181 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74: ROLLBACK
[0m15:05:05.300263 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74: Close
[0m15:05:05.300263 [info ] [Thread-1 (]: 8 of 15 PASS not_null_stg_trips_fare_amount .................................... [[32mPASS[0m in 0.07s]
[0m15:05:05.301439 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74
[0m15:05:05.301439 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c
[0m15:05:05.302749 [info ] [Thread-1 (]: 9 of 15 START test not_null_stg_trips_pickup_datetime .......................... [RUN]
[0m15:05:05.302749 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74, now test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c)
[0m15:05:05.303755 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c
[0m15:05:05.306755 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c"
[0m15:05:05.307754 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c
[0m15:05:05.309755 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c"
[0m15:05:05.310754 [debug] [Thread-1 (]: Using sqlserver connection "test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c"
[0m15:05:05.310754 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c"} */

    -- Create target schema if it does not
  USE [sqldb-taxi-platform];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'bronze')
  BEGIN
    EXEC('CREATE SCHEMA [bronze]')
  END

  

  
  EXEC('create view 
    [bronze].[testview_c8f1217ea7ae423f95431cf67128255c_16002]
   as 
    
    
    



select pickup_datetime
from "sqldb-taxi-platform"."bronze_bronze"."stg_trips"
where pickup_datetime is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [bronze].[testview_c8f1217ea7ae423f95431cf67128255c_16002]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [bronze].[testview_c8f1217ea7ae423f95431cf67128255c_16002]
  ;')
[0m15:05:05.311755 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:05.311755 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:05:05.312754 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:05:05.369074 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:05:05.370998 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c: ROLLBACK
[0m15:05:05.370998 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c: Close
[0m15:05:05.372004 [info ] [Thread-1 (]: 9 of 15 PASS not_null_stg_trips_pickup_datetime ................................ [[32mPASS[0m in 0.07s]
[0m15:05:05.372997 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c
[0m15:05:05.372997 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae
[0m15:05:05.372997 [info ] [Thread-1 (]: 10 of 15 START test not_null_stg_trips_total_amount ............................ [RUN]
[0m15:05:05.374009 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c, now test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae)
[0m15:05:05.375004 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae
[0m15:05:05.378003 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae"
[0m15:05:05.379004 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae
[0m15:05:05.381699 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae"
[0m15:05:05.382698 [debug] [Thread-1 (]: Using sqlserver connection "test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae"
[0m15:05:05.382698 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae"} */

    -- Create target schema if it does not
  USE [sqldb-taxi-platform];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'bronze')
  BEGIN
    EXEC('CREATE SCHEMA [bronze]')
  END

  

  
  EXEC('create view 
    [bronze].[testview_83c247fd7dcf1f459750c2de25501c63_18558]
   as 
    
    
    



select total_amount
from "sqldb-taxi-platform"."bronze_bronze"."stg_trips"
where total_amount is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [bronze].[testview_83c247fd7dcf1f459750c2de25501c63_18558]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [bronze].[testview_83c247fd7dcf1f459750c2de25501c63_18558]
  ;')
[0m15:05:05.383701 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:05.383701 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:05:05.384701 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:05:05.440885 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:05:05.442895 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae: ROLLBACK
[0m15:05:05.442895 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae: Close
[0m15:05:05.443884 [info ] [Thread-1 (]: 10 of 15 PASS not_null_stg_trips_total_amount .................................. [[32mPASS[0m in 0.07s]
[0m15:05:05.444887 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae
[0m15:05:05.444887 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b
[0m15:05:05.445885 [info ] [Thread-1 (]: 11 of 15 START test not_null_stg_trips_trip_distance ........................... [RUN]
[0m15:05:05.445885 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae, now test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b)
[0m15:05:05.446885 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b
[0m15:05:05.449891 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b"
[0m15:05:05.450884 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b
[0m15:05:05.452894 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b"
[0m15:05:05.453884 [debug] [Thread-1 (]: Using sqlserver connection "test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b"
[0m15:05:05.453884 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b"} */

    -- Create target schema if it does not
  USE [sqldb-taxi-platform];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'bronze')
  BEGIN
    EXEC('CREATE SCHEMA [bronze]')
  END

  

  
  EXEC('create view 
    [bronze].[testview_98902cdd2f59126a71dede1190f25913_16603]
   as 
    
    
    



select trip_distance
from "sqldb-taxi-platform"."bronze_bronze"."stg_trips"
where trip_distance is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [bronze].[testview_98902cdd2f59126a71dede1190f25913_16603]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [bronze].[testview_98902cdd2f59126a71dede1190f25913_16603]
  ;')
[0m15:05:05.453884 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:05.454884 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:05:05.454884 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:05:05.511859 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:05:05.512872 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b: ROLLBACK
[0m15:05:05.512872 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b: Close
[0m15:05:05.513871 [info ] [Thread-1 (]: 11 of 15 PASS not_null_stg_trips_trip_distance ................................. [[32mPASS[0m in 0.07s]
[0m15:05:05.514457 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b
[0m15:05:05.514457 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6
[0m15:05:05.515528 [info ] [Thread-1 (]: 12 of 15 START test relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_  [RUN]
[0m15:05:05.515528 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b, now test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6)
[0m15:05:05.516508 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6
[0m15:05:05.522503 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6"
[0m15:05:05.523493 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6
[0m15:05:05.525493 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6"
[0m15:05:05.526493 [debug] [Thread-1 (]: Using sqlserver connection "test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6"
[0m15:05:05.527494 [debug] [Thread-1 (]: On test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6"} */

    -- Create target schema if it does not
  USE [sqldb-taxi-platform];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'bronze')
  BEGIN
    EXEC('CREATE SCHEMA [bronze]')
  END

  

  
  EXEC('create view 
    [bronze].[testview_fe69b692e4963f1fa2cf4dd07e39b696_14520]
   as 
    
    
    

with child as (
    select payment_type as from_field
    from "sqldb-taxi-platform"."bronze_silver"."fact_trips"
    where payment_type is not null
),

parent as (
    select payment_type as to_field
    from "sqldb-taxi-platform"."bronze_silver"."dim_payment_type"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [bronze].[testview_fe69b692e4963f1fa2cf4dd07e39b696_14520]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [bronze].[testview_fe69b692e4963f1fa2cf4dd07e39b696_14520]
  ;')
[0m15:05:05.527494 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:05.527494 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:05:05.528501 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:05:05.591411 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:05:05.592410 [debug] [Thread-1 (]: On test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6: ROLLBACK
[0m15:05:05.593411 [debug] [Thread-1 (]: On test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6: Close
[0m15:05:05.593411 [info ] [Thread-1 (]: 12 of 15 PASS relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_  [[32mPASS[0m in 0.08s]
[0m15:05:05.594410 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6
[0m15:05:05.595418 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.unique_dim_date_date_key.0869fd48f9
[0m15:05:05.595418 [info ] [Thread-1 (]: 13 of 15 START test unique_dim_date_date_key ................................... [RUN]
[0m15:05:05.596411 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6, now test.taxi_nyc_project.unique_dim_date_date_key.0869fd48f9)
[0m15:05:05.596411 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.unique_dim_date_date_key.0869fd48f9
[0m15:05:05.601411 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.unique_dim_date_date_key.0869fd48f9"
[0m15:05:05.602411 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.unique_dim_date_date_key.0869fd48f9
[0m15:05:05.604411 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_nyc_project.unique_dim_date_date_key.0869fd48f9"
[0m15:05:05.605423 [debug] [Thread-1 (]: Using sqlserver connection "test.taxi_nyc_project.unique_dim_date_date_key.0869fd48f9"
[0m15:05:05.606411 [debug] [Thread-1 (]: On test.taxi_nyc_project.unique_dim_date_date_key.0869fd48f9: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "test.taxi_nyc_project.unique_dim_date_date_key.0869fd48f9"} */

    -- Create target schema if it does not
  USE [sqldb-taxi-platform];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'bronze')
  BEGIN
    EXEC('CREATE SCHEMA [bronze]')
  END

  

  
  EXEC('create view 
    [bronze].[testview_a400e2b5a883a058e35f384156d65f3b_8551]
   as 
    
    
    

select
    date_key as unique_field,
    count(*) as n_records

from "sqldb-taxi-platform"."bronze_silver"."dim_date"
where date_key is not null
group by date_key
having count(*) > 1



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [bronze].[testview_a400e2b5a883a058e35f384156d65f3b_8551]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [bronze].[testview_a400e2b5a883a058e35f384156d65f3b_8551]
  ;')
[0m15:05:05.606411 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:05.607410 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:05:05.607410 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:05:05.665416 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:05:05.667416 [debug] [Thread-1 (]: On test.taxi_nyc_project.unique_dim_date_date_key.0869fd48f9: ROLLBACK
[0m15:05:05.667416 [debug] [Thread-1 (]: On test.taxi_nyc_project.unique_dim_date_date_key.0869fd48f9: Close
[0m15:05:05.668417 [info ] [Thread-1 (]: 13 of 15 PASS unique_dim_date_date_key ......................................... [[32mPASS[0m in 0.07s]
[0m15:05:05.668417 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.unique_dim_date_date_key.0869fd48f9
[0m15:05:05.669419 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58
[0m15:05:05.669419 [info ] [Thread-1 (]: 14 of 15 START test unique_dim_payment_type_payment_type ....................... [RUN]
[0m15:05:05.670412 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.unique_dim_date_date_key.0869fd48f9, now test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58)
[0m15:05:05.670412 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58
[0m15:05:05.674416 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58"
[0m15:05:05.675416 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58
[0m15:05:05.677416 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58"
[0m15:05:05.677416 [debug] [Thread-1 (]: Using sqlserver connection "test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58"
[0m15:05:05.678409 [debug] [Thread-1 (]: On test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58"} */

    -- Create target schema if it does not
  USE [sqldb-taxi-platform];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'bronze')
  BEGIN
    EXEC('CREATE SCHEMA [bronze]')
  END

  

  
  EXEC('create view 
    [bronze].[testview_5fb5eb828135bf31fab7f64ef24093d1_12218]
   as 
    
    
    

select
    payment_type as unique_field,
    count(*) as n_records

from "sqldb-taxi-platform"."bronze_silver"."dim_payment_type"
where payment_type is not null
group by payment_type
having count(*) > 1



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [bronze].[testview_5fb5eb828135bf31fab7f64ef24093d1_12218]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [bronze].[testview_5fb5eb828135bf31fab7f64ef24093d1_12218]
  ;')
[0m15:05:05.678409 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:05.679416 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:05:05.679416 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:05:05.737145 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:05:05.739145 [debug] [Thread-1 (]: On test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58: ROLLBACK
[0m15:05:05.739145 [debug] [Thread-1 (]: On test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58: Close
[0m15:05:05.740149 [info ] [Thread-1 (]: 14 of 15 PASS unique_dim_payment_type_payment_type ............................. [[32mPASS[0m in 0.07s]
[0m15:05:05.740149 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58
[0m15:05:05.741139 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e
[0m15:05:05.742147 [info ] [Thread-1 (]: 15 of 15 START test unique_fact_trips_trip_id .................................. [RUN]
[0m15:05:05.742147 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58, now test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e)
[0m15:05:05.743138 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e
[0m15:05:05.746146 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e"
[0m15:05:05.747147 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e
[0m15:05:05.750138 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e"
[0m15:05:05.751148 [debug] [Thread-1 (]: Using sqlserver connection "test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e"
[0m15:05:05.751148 [debug] [Thread-1 (]: On test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e"} */

    -- Create target schema if it does not
  USE [sqldb-taxi-platform];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'bronze')
  BEGIN
    EXEC('CREATE SCHEMA [bronze]')
  END

  

  
  EXEC('create view 
    [bronze].[testview_2a9748c0e241ec04f816d7766bd33ba6_12824]
   as 
    
    
    

select
    trip_id as unique_field,
    count(*) as n_records

from "sqldb-taxi-platform"."bronze_silver"."fact_trips"
where trip_id is not null
group by trip_id
having count(*) > 1



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [bronze].[testview_2a9748c0e241ec04f816d7766bd33ba6_12824]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [bronze].[testview_2a9748c0e241ec04f816d7766bd33ba6_12824]
  ;')
[0m15:05:05.752139 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:05.752139 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:05:05.752139 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:05:05.888082 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:05:05.890158 [debug] [Thread-1 (]: On test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e: ROLLBACK
[0m15:05:05.890158 [debug] [Thread-1 (]: On test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e: Close
[0m15:05:05.891095 [info ] [Thread-1 (]: 15 of 15 PASS unique_fact_trips_trip_id ........................................ [[32mPASS[0m in 0.15s]
[0m15:05:05.892094 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e
[0m15:05:05.893093 [debug] [MainThread]: On master: COMMIT
[0m15:05:05.893093 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:05:05.894094 [debug] [MainThread]: Connection 'list_sqldb-taxi-platform_bronze_gold' was properly closed.
[0m15:05:05.894094 [debug] [MainThread]: Connection 'test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e' was properly closed.
[0m15:05:05.894094 [info ] [MainThread]: 
[0m15:05:05.895095 [info ] [MainThread]: Finished running 15 data tests in 0 hours 0 minutes and 1.98 seconds (1.98s).
[0m15:05:05.898093 [debug] [MainThread]: Command end result
[0m15:05:05.920092 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\manifest.json
[0m15:05:05.922094 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\semantic_manifest.json
[0m15:05:05.928093 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\run_results.json
[0m15:05:05.928093 [info ] [MainThread]: 
[0m15:05:05.929650 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:05:05.929746 [info ] [MainThread]: 
[0m15:05:05.930648 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=15
[0m15:05:05.931712 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:05:05.932658 [debug] [MainThread]: Command `dbt test` succeeded at 15:05:05.932658 after 3.27 seconds
[0m15:05:05.933658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C36F2F6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C3FB59150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C36EF5790>]}
[0m15:05:05.933658 [debug] [MainThread]: Flushing usage events
[0m15:05:06.692237 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:07:07.513930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002287C21FC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002287C253D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002287C250D90>]}


============================== 15:07:07.517931 | e0324ee0-fd13-43d5-b17d-61934a605011 ==============================
[0m15:07:07.517931 [info ] [MainThread]: Running with dbt=1.10.15
[0m15:07:07.518929 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'invocation_command': 'dbt docs generate --profiles-dir .', 'printer_width': '80', 'profiles_dir': '.', 'write_json': 'True', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'log_path': 'C:\\Users\\alexm\\Desktop\\python\\azure-taxi-platform\\dbt_project\\logs', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m15:07:07.837554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e0324ee0-fd13-43d5-b17d-61934a605011', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002287C2B38D0>]}
[0m15:07:07.882592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e0324ee0-fd13-43d5-b17d-61934a605011', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002287B2255D0>]}
[0m15:07:07.883592 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m15:07:08.117841 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m15:07:08.292459 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:07:08.292459 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:07:08.323216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e0324ee0-fd13-43d5-b17d-61934a605011', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002287DDB8250>]}
[0m15:07:08.347938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e0324ee0-fd13-43d5-b17d-61934a605011', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002287E024B50>]}
[0m15:07:08.348938 [info ] [MainThread]: Found 8 models, 15 data tests, 535 macros
[0m15:07:08.348938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0324ee0-fd13-43d5-b17d-61934a605011', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022878E27990>]}
[0m15:07:08.351529 [info ] [MainThread]: 
[0m15:07:08.352528 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:07:08.352528 [info ] [MainThread]: 
[0m15:07:08.352528 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m15:07:08.357528 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_sqldb-taxi-platform_bronze_silver'
[0m15:07:08.373163 [debug] [ThreadPool]: dbt-sqlserver
[0m15:07:08.373163 [debug] [ThreadPool]: Using sqlserver connection "list_sqldb-taxi-platform_bronze_silver"
[0m15:07:08.374170 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "list_sqldb-taxi-platform_bronze_silver"} */
USE [sqldb-taxi-platform];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze_silver'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m15:07:08.374170 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:07:08.374170 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:07:08.933280 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:07:08.982626 [debug] [ThreadPool]: SQL status: OK in 1.000 seconds
[0m15:07:08.983626 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_silver: ROLLBACK
[0m15:07:08.983626 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_silver: Close
[0m15:07:08.984625 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sqldb-taxi-platform_bronze_silver, now list_sqldb-taxi-platform_bronze_gold)
[0m15:07:08.987635 [debug] [ThreadPool]: dbt-sqlserver
[0m15:07:08.987635 [debug] [ThreadPool]: Using sqlserver connection "list_sqldb-taxi-platform_bronze_gold"
[0m15:07:08.988626 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_gold: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "list_sqldb-taxi-platform_bronze_gold"} */
USE [sqldb-taxi-platform];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze_gold'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m15:07:08.988626 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:07:08.988626 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:07:08.989625 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:07:09.036854 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:07:09.037846 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_gold: ROLLBACK
[0m15:07:09.037846 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_gold: Close
[0m15:07:09.037846 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sqldb-taxi-platform_bronze_gold, now list_sqldb-taxi-platform_bronze_bronze)
[0m15:07:09.040855 [debug] [ThreadPool]: dbt-sqlserver
[0m15:07:09.040855 [debug] [ThreadPool]: Using sqlserver connection "list_sqldb-taxi-platform_bronze_bronze"
[0m15:07:09.041846 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "list_sqldb-taxi-platform_bronze_bronze"} */
USE [sqldb-taxi-platform];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze_bronze'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m15:07:09.041846 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:07:09.041846 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:07:09.041846 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:07:09.089656 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:07:09.090388 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_bronze: ROLLBACK
[0m15:07:09.091444 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_bronze: Close
[0m15:07:09.092386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0324ee0-fd13-43d5-b17d-61934a605011', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002287DD7C350>]}
[0m15:07:09.096393 [debug] [Thread-1 (]: Began running node model.taxi_nyc_project.dim_date
[0m15:07:09.096393 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.taxi_nyc_project.dim_date'
[0m15:07:09.097393 [debug] [Thread-1 (]: Began compiling node model.taxi_nyc_project.dim_date
[0m15:07:09.103419 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_nyc_project.dim_date"
[0m15:07:09.103419 [debug] [Thread-1 (]: Began executing node model.taxi_nyc_project.dim_date
[0m15:07:09.104421 [debug] [Thread-1 (]: Finished running node model.taxi_nyc_project.dim_date
[0m15:07:09.105420 [debug] [Thread-1 (]: Began running node model.taxi_nyc_project.dim_payment_type
[0m15:07:09.105420 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_nyc_project.dim_date, now model.taxi_nyc_project.dim_payment_type)
[0m15:07:09.105420 [debug] [Thread-1 (]: Began compiling node model.taxi_nyc_project.dim_payment_type
[0m15:07:09.108422 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_nyc_project.dim_payment_type"
[0m15:07:09.109420 [debug] [Thread-1 (]: Began executing node model.taxi_nyc_project.dim_payment_type
[0m15:07:09.109420 [debug] [Thread-1 (]: Finished running node model.taxi_nyc_project.dim_payment_type
[0m15:07:09.110412 [debug] [Thread-1 (]: Began running node model.taxi_nyc_project.stg_trips
[0m15:07:09.110412 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_nyc_project.dim_payment_type, now model.taxi_nyc_project.stg_trips)
[0m15:07:09.111422 [debug] [Thread-1 (]: Began compiling node model.taxi_nyc_project.stg_trips
[0m15:07:09.114419 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_nyc_project.stg_trips"
[0m15:07:09.115419 [debug] [Thread-1 (]: Began executing node model.taxi_nyc_project.stg_trips
[0m15:07:09.115419 [debug] [Thread-1 (]: Finished running node model.taxi_nyc_project.stg_trips
[0m15:07:09.116413 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_dim_date_date_key.881d0a31b6
[0m15:07:09.116413 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_nyc_project.stg_trips, now test.taxi_nyc_project.not_null_dim_date_date_key.881d0a31b6)
[0m15:07:09.117420 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_dim_date_date_key.881d0a31b6
[0m15:07:09.126497 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_dim_date_date_key.881d0a31b6"
[0m15:07:09.127496 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_dim_date_date_key.881d0a31b6
[0m15:07:09.127496 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_dim_date_date_key.881d0a31b6
[0m15:07:09.128494 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.unique_dim_date_date_key.0869fd48f9
[0m15:07:09.128494 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_dim_date_date_key.881d0a31b6, now test.taxi_nyc_project.unique_dim_date_date_key.0869fd48f9)
[0m15:07:09.128494 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.unique_dim_date_date_key.0869fd48f9
[0m15:07:09.133499 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.unique_dim_date_date_key.0869fd48f9"
[0m15:07:09.134495 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.unique_dim_date_date_key.0869fd48f9
[0m15:07:09.134495 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.unique_dim_date_date_key.0869fd48f9
[0m15:07:09.135495 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626
[0m15:07:09.135495 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.unique_dim_date_date_key.0869fd48f9, now test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626)
[0m15:07:09.135495 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626
[0m15:07:09.138496 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626"
[0m15:07:09.139495 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626
[0m15:07:09.140497 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626
[0m15:07:09.140497 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58
[0m15:07:09.141496 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626, now test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58)
[0m15:07:09.141496 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58
[0m15:07:09.144496 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58"
[0m15:07:09.145495 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58
[0m15:07:09.146488 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58
[0m15:07:09.146488 [debug] [Thread-1 (]: Began running node model.taxi_nyc_project.fact_trips
[0m15:07:09.146488 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58, now model.taxi_nyc_project.fact_trips)
[0m15:07:09.147495 [debug] [Thread-1 (]: Began compiling node model.taxi_nyc_project.fact_trips
[0m15:07:09.149495 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_nyc_project.fact_trips"
[0m15:07:09.150496 [debug] [Thread-1 (]: Began executing node model.taxi_nyc_project.fact_trips
[0m15:07:09.150496 [debug] [Thread-1 (]: Finished running node model.taxi_nyc_project.fact_trips
[0m15:07:09.151497 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec
[0m15:07:09.152495 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_nyc_project.fact_trips, now test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec)
[0m15:07:09.152495 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec
[0m15:07:09.158495 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec"
[0m15:07:09.159510 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec
[0m15:07:09.159510 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec
[0m15:07:09.160488 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d
[0m15:07:09.160488 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec, now test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d)
[0m15:07:09.160488 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d
[0m15:07:09.163495 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d"
[0m15:07:09.164495 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d
[0m15:07:09.165495 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d
[0m15:07:09.165495 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b
[0m15:07:09.165495 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d, now test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b)
[0m15:07:09.166497 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b
[0m15:07:09.169057 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b"
[0m15:07:09.170028 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b
[0m15:07:09.171041 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b
[0m15:07:09.171041 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74
[0m15:07:09.171041 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b, now test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74)
[0m15:07:09.172036 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74
[0m15:07:09.176035 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74"
[0m15:07:09.176035 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74
[0m15:07:09.177037 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74
[0m15:07:09.177037 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c
[0m15:07:09.178035 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74, now test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c)
[0m15:07:09.178035 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c
[0m15:07:09.181029 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c"
[0m15:07:09.182038 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c
[0m15:07:09.182038 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c
[0m15:07:09.183036 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae
[0m15:07:09.183036 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c, now test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae)
[0m15:07:09.184036 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae
[0m15:07:09.186035 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae"
[0m15:07:09.187035 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae
[0m15:07:09.188029 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae
[0m15:07:09.188029 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b
[0m15:07:09.189038 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae, now test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b)
[0m15:07:09.189038 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b
[0m15:07:09.192036 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b"
[0m15:07:09.193036 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b
[0m15:07:09.193036 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b
[0m15:07:09.194036 [debug] [Thread-1 (]: Began running node model.taxi_nyc_project.mart_daily_revenue
[0m15:07:09.194036 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b, now model.taxi_nyc_project.mart_daily_revenue)
[0m15:07:09.194036 [debug] [Thread-1 (]: Began compiling node model.taxi_nyc_project.mart_daily_revenue
[0m15:07:09.197035 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_nyc_project.mart_daily_revenue"
[0m15:07:09.197035 [debug] [Thread-1 (]: Began executing node model.taxi_nyc_project.mart_daily_revenue
[0m15:07:09.198036 [debug] [Thread-1 (]: Finished running node model.taxi_nyc_project.mart_daily_revenue
[0m15:07:09.198036 [debug] [Thread-1 (]: Began running node model.taxi_nyc_project.mart_tip_by_payment_type
[0m15:07:09.199069 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_nyc_project.mart_daily_revenue, now model.taxi_nyc_project.mart_tip_by_payment_type)
[0m15:07:09.199069 [debug] [Thread-1 (]: Began compiling node model.taxi_nyc_project.mart_tip_by_payment_type
[0m15:07:09.201061 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_nyc_project.mart_tip_by_payment_type"
[0m15:07:09.202061 [debug] [Thread-1 (]: Began executing node model.taxi_nyc_project.mart_tip_by_payment_type
[0m15:07:09.203061 [debug] [Thread-1 (]: Finished running node model.taxi_nyc_project.mart_tip_by_payment_type
[0m15:07:09.203061 [debug] [Thread-1 (]: Began running node model.taxi_nyc_project.mart_trips_by_hour
[0m15:07:09.203061 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_nyc_project.mart_tip_by_payment_type, now model.taxi_nyc_project.mart_trips_by_hour)
[0m15:07:09.204062 [debug] [Thread-1 (]: Began compiling node model.taxi_nyc_project.mart_trips_by_hour
[0m15:07:09.206064 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_nyc_project.mart_trips_by_hour"
[0m15:07:09.207062 [debug] [Thread-1 (]: Began executing node model.taxi_nyc_project.mart_trips_by_hour
[0m15:07:09.207062 [debug] [Thread-1 (]: Finished running node model.taxi_nyc_project.mart_trips_by_hour
[0m15:07:09.208062 [debug] [Thread-1 (]: Began running node model.taxi_nyc_project.mart_zone_revenue
[0m15:07:09.208062 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_nyc_project.mart_trips_by_hour, now model.taxi_nyc_project.mart_zone_revenue)
[0m15:07:09.209062 [debug] [Thread-1 (]: Began compiling node model.taxi_nyc_project.mart_zone_revenue
[0m15:07:09.211062 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_nyc_project.mart_zone_revenue"
[0m15:07:09.212054 [debug] [Thread-1 (]: Began executing node model.taxi_nyc_project.mart_zone_revenue
[0m15:07:09.212054 [debug] [Thread-1 (]: Finished running node model.taxi_nyc_project.mart_zone_revenue
[0m15:07:09.213063 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c
[0m15:07:09.213063 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_nyc_project.mart_zone_revenue, now test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c)
[0m15:07:09.214062 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c
[0m15:07:09.217054 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c"
[0m15:07:09.218063 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c
[0m15:07:09.218063 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c
[0m15:07:09.219062 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442
[0m15:07:09.219062 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c, now test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442)
[0m15:07:09.219062 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442
[0m15:07:09.222088 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442"
[0m15:07:09.223088 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442
[0m15:07:09.224089 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442
[0m15:07:09.224089 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6
[0m15:07:09.225088 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442, now test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6)
[0m15:07:09.225088 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6
[0m15:07:09.231628 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6"
[0m15:07:09.232627 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6
[0m15:07:09.233629 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6
[0m15:07:09.233629 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e
[0m15:07:09.233629 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6, now test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e)
[0m15:07:09.234628 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e
[0m15:07:09.237628 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e"
[0m15:07:09.238631 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e
[0m15:07:09.238631 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e
[0m15:07:09.239628 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:07:09.240622 [debug] [MainThread]: Connection 'list_sqldb-taxi-platform_bronze_bronze' was properly closed.
[0m15:07:09.240622 [debug] [MainThread]: Connection 'test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e' was properly closed.
[0m15:07:09.243620 [debug] [MainThread]: Command end result
[0m15:07:09.300620 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\manifest.json
[0m15:07:09.302621 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\semantic_manifest.json
[0m15:07:09.307621 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\run_results.json
[0m15:07:09.556682 [debug] [MainThread]: Acquiring new sqlserver connection 'generate_catalog'
[0m15:07:09.556682 [info ] [MainThread]: Building catalog
[0m15:07:09.565682 [debug] [ThreadPool]: Acquiring new sqlserver connection 'sqldb-taxi-platform.information_schema'
[0m15:07:09.572683 [debug] [ThreadPool]: dbt-sqlserver
[0m15:07:09.573683 [debug] [ThreadPool]: Using sqlserver connection "sqldb-taxi-platform.information_schema"
[0m15:07:09.573683 [debug] [ThreadPool]: On sqldb-taxi-platform.information_schema: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "sqldb-taxi-platform.information_schema"} */
with
    principals as (
        select
            name as principal_name,
            principal_id as principal_id
        from
            sys.database_principals with (nolock)
    ),

    schemas as (
        select
            name as schema_name,
            schema_id as schema_id,
            principal_id as principal_id
        from
            sys.schemas with (nolock)
    ),

    tables as (
        select
            object_id,
            name as table_name,
            schema_id as schema_id,
            principal_id as principal_id,
            'BASE TABLE' as table_type
        from
            sys.tables with (nolock)
    ),

    tables_with_metadata as (
        select
            object_id,
            table_name,
            schema_name,
            coalesce(tables.principal_id, schemas.principal_id) as owner_principal_id,
            table_type
        from
            tables
        join schemas on tables.schema_id = schemas.schema_id
    ),

    views as (
        select
            object_id,
            name as table_name,
            schema_id as schema_id,
            principal_id as principal_id,
            'VIEW' as table_type
        from
            sys.views with (nolock)
    ),

    views_with_metadata as (
        select
            object_id,
            table_name,
            schema_name,
            coalesce(views.principal_id, schemas.principal_id) as owner_principal_id,
            table_type
        from
            views
        join schemas on views.schema_id = schemas.schema_id
    ),

    tables_and_views as (
        select
            object_id,
            table_name,
            schema_name,
            principal_name,
            table_type
        from
            tables_with_metadata
        join principals on tables_with_metadata.owner_principal_id = principals.principal_id
        union all
        select
            object_id,
            table_name,
            schema_name,
            principal_name,
            table_type
        from
            views_with_metadata
        join principals on views_with_metadata.owner_principal_id = principals.principal_id
    ),

    cols as (

        select
            c.object_id,
            c.name as column_name,
            c.column_id as column_index,
            t.name as column_type
        from sys.columns as c with (nolock)
        left join sys.types as t on c.system_type_id = t.system_type_id
    )

    select
        DB_NAME() as table_database,
        tv.schema_name as table_schema,
        tv.table_name,
        tv.table_type,
        null as table_comment,
        tv.principal_name as table_owner,
        cols.column_name,
        cols.column_index,
        cols.column_type,
        null as column_comment
    from tables_and_views tv
    join cols on tv.object_id = cols.object_id
    where (
                (
                    upper(tv.schema_name) = upper('bronze_gold')
                    and upper(tv.table_name) = upper('mart_tip_by_payment_type')
                )
             or 
                (
                    upper(tv.schema_name) = upper('bronze_gold')
                    and upper(tv.table_name) = upper('mart_zone_revenue')
                )
             or 
                (
                    upper(tv.schema_name) = upper('bronze_gold')
                    and upper(tv.table_name) = upper('mart_trips_by_hour')
                )
             or 
                (
                    upper(tv.schema_name) = upper('bronze_silver')
                    and upper(tv.table_name) = upper('dim_date')
                )
             or 
                (
                    upper(tv.schema_name) = upper('bronze_silver')
                    and upper(tv.table_name) = upper('fact_trips')
                )
             or 
                (
                    upper(tv.schema_name) = upper('bronze_silver')
                    and upper(tv.table_name) = upper('dim_payment_type')
                )
             or 
                (
                    upper(tv.schema_name) = upper('bronze_bronze')
                    and upper(tv.table_name) = upper('stg_trips')
                )
             or 
                (
                    upper(tv.schema_name) = upper('bronze_gold')
                    and upper(tv.table_name) = upper('mart_daily_revenue')
                )
            )

    order by column_index
    
    OPTION (LABEL = 'dbt-sqlserver');

[0m15:07:09.574681 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:07:09.574681 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:07:09.575681 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:07:09.755876 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:07:09.759876 [debug] [ThreadPool]: On sqldb-taxi-platform.information_schema: ROLLBACK
[0m15:07:09.759876 [debug] [ThreadPool]: On sqldb-taxi-platform.information_schema: Close
[0m15:07:09.770899 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\catalog.json
[0m15:07:09.792898 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\manifest.json
[0m15:07:09.795898 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\semantic_manifest.json
[0m15:07:09.795898 [info ] [MainThread]: Catalog written to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\catalog.json
[0m15:07:09.796902 [debug] [MainThread]: Command `dbt docs generate` succeeded at 15:07:09.796902 after 2.35 seconds
[0m15:07:09.797909 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m15:07:09.797909 [debug] [MainThread]: Connection 'sqldb-taxi-platform.information_schema' was properly closed.
[0m15:07:09.797909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002287B363710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002287B231C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022875832850>]}
[0m15:07:09.798904 [debug] [MainThread]: Flushing usage events
[0m15:07:10.625691 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:07:53.946080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A3C5AE190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A3B6E39D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A3C5AD250>]}


============================== 15:07:53.950081 | c05bfce1-e805-4ed7-a4ea-dcab38046ed8 ==============================
[0m15:07:53.950081 [info ] [MainThread]: Running with dbt=1.10.15
[0m15:07:53.951081 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'profiles_dir': '.', 'use_colors': 'True', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\alexm\\Desktop\\python\\azure-taxi-platform\\dbt_project\\logs', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt docs serve --profiles-dir . --port 8080', 'printer_width': '80', 'write_json': 'True'}
[0m15:07:54.295343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c05bfce1-e805-4ed7-a4ea-dcab38046ed8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A3C5EA2D0>]}
[0m15:07:54.343594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c05bfce1-e805-4ed7-a4ea-dcab38046ed8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A3B5A15D0>]}
[0m15:11:27.517850 [error] [MainThread]: Encountered an error:

[0m15:11:27.549974 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\alexm\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\cli\requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\alexm\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\cli\requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\alexm\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\cli\requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\alexm\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\cli\requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\alexm\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\cli\requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\alexm\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\cli\main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\alexm\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Users\alexm\AppData\Local\Programs\Python\Python311\Lib\socketserver.py", line 233, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\alexm\AppData\Local\Programs\Python\Python311\Lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\alexm\AppData\Local\Programs\Python\Python311\Lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m15:11:27.552007 [debug] [MainThread]: Command `dbt docs serve` failed at 15:11:27.551060 after 213.67 seconds
[0m15:11:27.552007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A3C613A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A3C6107D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A3C5AFAD0>]}
[0m15:11:27.552007 [debug] [MainThread]: Flushing usage events
[0m15:11:28.322525 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:11:33.988035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D5FE720D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D63551A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D63552490>]}


============================== 15:11:33.992035 | 8dce6240-591c-452a-b34c-8165068aef1f ==============================
[0m15:11:33.992035 [info ] [MainThread]: Running with dbt=1.10.15
[0m15:11:33.992035 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'profiles_dir': '.', 'cache_selected_only': 'False', 'log_format': 'default', 'write_json': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'log_path': 'C:\\Users\\alexm\\Desktop\\python\\azure-taxi-platform\\dbt_project\\logs', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt run --models gold.mart_daily_revenue --profiles-dir .', 'printer_width': '80', 'target_path': 'None'}
[0m15:11:33.993035 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m15:11:33.993035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8dce6240-591c-452a-b34c-8165068aef1f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D634F22D0>]}
[0m15:11:34.303440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8dce6240-591c-452a-b34c-8165068aef1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D625E3E10>]}
[0m15:11:34.346440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8dce6240-591c-452a-b34c-8165068aef1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D64D81E50>]}
[0m15:11:34.347440 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m15:11:34.560030 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m15:11:34.713553 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:11:34.713553 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:11:34.743076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8dce6240-591c-452a-b34c-8165068aef1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D64D70690>]}
[0m15:11:34.799595 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\manifest.json
[0m15:11:34.801597 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\semantic_manifest.json
[0m15:11:34.823615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8dce6240-591c-452a-b34c-8165068aef1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D652A69D0>]}
[0m15:11:34.824615 [info ] [MainThread]: Found 8 models, 15 data tests, 535 macros
[0m15:11:34.824615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8dce6240-591c-452a-b34c-8165068aef1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D60ADA990>]}
[0m15:11:34.826615 [info ] [MainThread]: 
[0m15:11:34.827614 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:11:34.827614 [info ] [MainThread]: 
[0m15:11:34.827614 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m15:11:34.829627 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_sqldb-taxi-platform'
[0m15:11:34.841620 [debug] [ThreadPool]: dbt-sqlserver
[0m15:11:34.842620 [debug] [ThreadPool]: Using sqlserver connection "list_sqldb-taxi-platform"
[0m15:11:34.842620 [debug] [ThreadPool]: On list_sqldb-taxi-platform: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "list_sqldb-taxi-platform"} */
USE [sqldb-taxi-platform];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m15:11:34.842620 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:11:34.843622 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:11:35.524995 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:11:35.575075 [debug] [ThreadPool]: SQL status: OK in 1.000 seconds
[0m15:11:35.575739 [debug] [ThreadPool]: On list_sqldb-taxi-platform: Close
[0m15:11:35.581168 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_sqldb-taxi-platform_bronze_gold'
[0m15:11:35.585173 [debug] [ThreadPool]: dbt-sqlserver
[0m15:11:35.586174 [debug] [ThreadPool]: Using sqlserver connection "list_sqldb-taxi-platform_bronze_gold"
[0m15:11:35.586174 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_gold: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "list_sqldb-taxi-platform_bronze_gold"} */
USE [sqldb-taxi-platform];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze_gold'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m15:11:35.587173 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:11:35.587173 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:11:35.587173 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:11:35.639394 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:11:35.640479 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_gold: ROLLBACK
[0m15:11:35.641456 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_gold: Close
[0m15:11:35.641456 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sqldb-taxi-platform_bronze_gold, now list_sqldb-taxi-platform_bronze_silver)
[0m15:11:35.644467 [debug] [ThreadPool]: dbt-sqlserver
[0m15:11:35.644467 [debug] [ThreadPool]: Using sqlserver connection "list_sqldb-taxi-platform_bronze_silver"
[0m15:11:35.644467 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "list_sqldb-taxi-platform_bronze_silver"} */
USE [sqldb-taxi-platform];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze_silver'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m15:11:35.645438 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:11:35.645438 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:11:35.645438 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:11:35.698482 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:11:35.699480 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_silver: ROLLBACK
[0m15:11:35.699480 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_silver: Close
[0m15:11:35.700472 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sqldb-taxi-platform_bronze_silver, now list_sqldb-taxi-platform_bronze_bronze)
[0m15:11:35.702165 [debug] [ThreadPool]: dbt-sqlserver
[0m15:11:35.703164 [debug] [ThreadPool]: Using sqlserver connection "list_sqldb-taxi-platform_bronze_bronze"
[0m15:11:35.703164 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "list_sqldb-taxi-platform_bronze_bronze"} */
USE [sqldb-taxi-platform];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze_bronze'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m15:11:35.703164 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:11:35.704164 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:11:35.704164 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:11:35.755178 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:11:35.756058 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_bronze: ROLLBACK
[0m15:11:35.757051 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_bronze: Close
[0m15:11:35.757051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8dce6240-591c-452a-b34c-8165068aef1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D65314E90>]}
[0m15:11:35.758060 [debug] [MainThread]: On master: COMMIT
[0m15:11:35.761713 [debug] [Thread-1 (]: Began running node model.taxi_nyc_project.mart_daily_revenue
[0m15:11:35.762722 [info ] [Thread-1 (]: 1 of 1 START sql table model bronze_gold.mart_daily_revenue .................... [RUN]
[0m15:11:35.763711 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.taxi_nyc_project.mart_daily_revenue'
[0m15:11:35.763711 [debug] [Thread-1 (]: Began compiling node model.taxi_nyc_project.mart_daily_revenue
[0m15:11:35.770711 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_nyc_project.mart_daily_revenue"
[0m15:11:35.771711 [debug] [Thread-1 (]: Began executing node model.taxi_nyc_project.mart_daily_revenue
[0m15:11:35.798718 [debug] [Thread-1 (]: dbt-sqlserver
[0m15:11:35.803718 [debug] [Thread-1 (]: Applying DROP to: "sqldb-taxi-platform"."bronze_gold"."mart_daily_revenue__dbt_tmp__dbt_tmp_vw"
[0m15:11:35.807721 [debug] [Thread-1 (]: dbt-sqlserver
[0m15:11:35.808718 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_daily_revenue"
[0m15:11:35.808718 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_daily_revenue"} */

        USE [sqldb-taxi-platform];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'sqldb-taxi-platform'
        and refs.referenced_schema_name = 'bronze_gold'
        and refs.referenced_entity_name = 'mart_daily_revenue__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m15:11:35.809712 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:11:35.809712 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:11:35.809712 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:11:35.862234 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:11:35.863740 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_daily_revenue"
[0m15:11:35.863740 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_daily_revenue"} */

      
      
    
    USE [sqldb-taxi-platform];
    EXEC('DROP view IF EXISTS "bronze_gold"."mart_daily_revenue__dbt_tmp__dbt_tmp_vw";');

[0m15:11:35.913362 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:11:35.925374 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_nyc_project.mart_daily_revenue"
[0m15:11:35.926382 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_daily_revenue"
[0m15:11:35.926382 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_daily_revenue"} */

  
    USE [sqldb-taxi-platform];
    USE [sqldb-taxi-platform];
    
    

    

    
    USE [sqldb-taxi-platform];
    EXEC('
        create view "bronze_gold"."mart_daily_revenue__dbt_tmp__dbt_tmp_vw" as 

select
    pickup_date                as trip_date,
    count(*)                   as trip_count,
    sum(total_amount)          as total_revenue,
    avg(total_amount)          as avg_revenue_per_trip
from "sqldb-taxi-platform"."bronze_silver"."fact_trips"
group by
    pickup_date;;
    ')

EXEC('
            SELECT * INTO "sqldb-taxi-platform"."bronze_gold"."mart_daily_revenue__dbt_tmp" FROM "sqldb-taxi-platform"."bronze_gold"."mart_daily_revenue__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS bronze_gold.mart_daily_revenue__dbt_tmp__dbt_tmp_vw')



    
    use [sqldb-taxi-platform];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'bronze_gold_mart_daily_revenue__dbt_tmp_cci'
        AND object_id=object_id('bronze_gold_mart_daily_revenue__dbt_tmp')
    )
    DROP index "bronze_gold"."mart_daily_revenue__dbt_tmp".bronze_gold_mart_daily_revenue__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX bronze_gold_mart_daily_revenue__dbt_tmp_cci
    ON "bronze_gold"."mart_daily_revenue__dbt_tmp"

   


  
[0m15:11:36.045847 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:11:36.050860 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_daily_revenue"
[0m15:11:36.051859 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_daily_revenue"} */
USE [sqldb-taxi-platform];
      EXEC sp_rename 'bronze_gold.mart_daily_revenue', 'mart_daily_revenue__dbt_backup'
[0m15:11:36.103333 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:11:36.106323 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_daily_revenue"
[0m15:11:36.106323 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_daily_revenue"} */
USE [sqldb-taxi-platform];
      EXEC sp_rename 'bronze_gold.mart_daily_revenue__dbt_tmp', 'mart_daily_revenue'
[0m15:11:36.158300 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:11:36.172847 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_daily_revenue: COMMIT
[0m15:11:36.174847 [debug] [Thread-1 (]: Applying DROP to: "sqldb-taxi-platform"."bronze_gold"."mart_daily_revenue__dbt_backup"
[0m15:11:36.174847 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_daily_revenue"
[0m15:11:36.175848 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_daily_revenue"} */

      
    USE [sqldb-taxi-platform];
    EXEC('DROP table IF EXISTS "bronze_gold"."mart_daily_revenue__dbt_backup";');

[0m15:11:36.227605 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:11:36.229677 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_daily_revenue: Close
[0m15:11:36.231656 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8dce6240-591c-452a-b34c-8165068aef1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D64DA1710>]}
[0m15:11:36.231656 [info ] [Thread-1 (]: 1 of 1 OK created sql table model bronze_gold.mart_daily_revenue ............... [[32mOK[0m in 0.47s]
[0m15:11:36.232612 [debug] [Thread-1 (]: Finished running node model.taxi_nyc_project.mart_daily_revenue
[0m15:11:36.233611 [debug] [MainThread]: On master: COMMIT
[0m15:11:36.234611 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:11:36.234611 [debug] [MainThread]: Connection 'list_sqldb-taxi-platform' was properly closed.
[0m15:11:36.234611 [debug] [MainThread]: Connection 'list_sqldb-taxi-platform_bronze_bronze' was properly closed.
[0m15:11:36.235610 [debug] [MainThread]: Connection 'model.taxi_nyc_project.mart_daily_revenue' was properly closed.
[0m15:11:36.235610 [info ] [MainThread]: 
[0m15:11:36.236290 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.41 seconds (1.41s).
[0m15:11:36.237301 [debug] [MainThread]: Command end result
[0m15:11:36.259307 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\manifest.json
[0m15:11:36.261307 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\semantic_manifest.json
[0m15:11:36.266306 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\run_results.json
[0m15:11:36.266306 [info ] [MainThread]: 
[0m15:11:36.267300 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:11:36.267300 [info ] [MainThread]: 
[0m15:11:36.268300 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:11:36.269300 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:11:36.270299 [debug] [MainThread]: Command `dbt run` succeeded at 15:11:36.270299 after 2.34 seconds
[0m15:11:36.270299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D5CB0F8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D5CA93AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D5CA92950>]}
[0m15:11:36.270299 [debug] [MainThread]: Flushing usage events
[0m15:11:37.014879 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:12:14.070396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBD53FDB10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBD5432010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBD51A6E90>]}


============================== 15:12:14.073395 | 7dca4da8-fbbb-4e25-97f8-bca26fe8eed9 ==============================
[0m15:12:14.073395 [info ] [MainThread]: Running with dbt=1.10.15
[0m15:12:14.074396 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'invocation_command': 'dbt docs generate --profiles-dir .', 'cache_selected_only': 'False', 'no_print': 'None', 'target_path': 'None', 'warn_error': 'None', 'log_path': 'C:\\Users\\alexm\\Desktop\\python\\azure-taxi-platform\\dbt_project\\logs', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m15:12:14.394461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7dca4da8-fbbb-4e25-97f8-bca26fe8eed9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBD442B1D0>]}
[0m15:12:14.439462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7dca4da8-fbbb-4e25-97f8-bca26fe8eed9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBD4401610>]}
[0m15:12:14.439462 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m15:12:14.664418 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m15:12:14.824408 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:12:14.825408 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:12:14.854264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7dca4da8-fbbb-4e25-97f8-bca26fe8eed9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBD6F88250>]}
[0m15:12:14.876763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7dca4da8-fbbb-4e25-97f8-bca26fe8eed9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBD7209610>]}
[0m15:12:14.877763 [info ] [MainThread]: Found 8 models, 15 data tests, 535 macros
[0m15:12:14.877763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7dca4da8-fbbb-4e25-97f8-bca26fe8eed9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBD53FA990>]}
[0m15:12:14.879776 [info ] [MainThread]: 
[0m15:12:14.880782 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:12:14.880782 [info ] [MainThread]: 
[0m15:12:14.881776 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m15:12:14.886774 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_sqldb-taxi-platform_bronze_gold'
[0m15:12:14.901365 [debug] [ThreadPool]: dbt-sqlserver
[0m15:12:14.901365 [debug] [ThreadPool]: Using sqlserver connection "list_sqldb-taxi-platform_bronze_gold"
[0m15:12:14.901365 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_gold: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "list_sqldb-taxi-platform_bronze_gold"} */
USE [sqldb-taxi-platform];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze_gold'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m15:12:14.902365 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:12:14.902365 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:12:15.515609 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:12:15.565969 [debug] [ThreadPool]: SQL status: OK in 1.000 seconds
[0m15:12:15.567742 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_gold: ROLLBACK
[0m15:12:15.567742 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_gold: Close
[0m15:12:15.568723 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sqldb-taxi-platform_bronze_gold, now list_sqldb-taxi-platform_bronze_bronze)
[0m15:12:15.571723 [debug] [ThreadPool]: dbt-sqlserver
[0m15:12:15.571723 [debug] [ThreadPool]: Using sqlserver connection "list_sqldb-taxi-platform_bronze_bronze"
[0m15:12:15.571723 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "list_sqldb-taxi-platform_bronze_bronze"} */
USE [sqldb-taxi-platform];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze_bronze'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m15:12:15.572727 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:12:15.572727 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:12:15.572727 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:12:15.623593 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:12:15.624989 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_bronze: ROLLBACK
[0m15:12:15.624989 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_bronze: Close
[0m15:12:15.624989 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sqldb-taxi-platform_bronze_bronze, now list_sqldb-taxi-platform_bronze_silver)
[0m15:12:15.628002 [debug] [ThreadPool]: dbt-sqlserver
[0m15:12:15.628002 [debug] [ThreadPool]: Using sqlserver connection "list_sqldb-taxi-platform_bronze_silver"
[0m15:12:15.628002 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "list_sqldb-taxi-platform_bronze_silver"} */
USE [sqldb-taxi-platform];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze_silver'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m15:12:15.628002 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:12:15.629382 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:12:15.629382 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:12:15.680892 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:12:15.681943 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_silver: ROLLBACK
[0m15:12:15.681943 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_silver: Close
[0m15:12:15.682912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7dca4da8-fbbb-4e25-97f8-bca26fe8eed9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBD6CF18D0>]}
[0m15:12:15.686912 [debug] [Thread-1 (]: Began running node model.taxi_nyc_project.dim_date
[0m15:12:15.687911 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.taxi_nyc_project.dim_date'
[0m15:12:15.687911 [debug] [Thread-1 (]: Began compiling node model.taxi_nyc_project.dim_date
[0m15:12:15.693918 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_nyc_project.dim_date"
[0m15:12:15.694926 [debug] [Thread-1 (]: Began executing node model.taxi_nyc_project.dim_date
[0m15:12:15.695438 [debug] [Thread-1 (]: Finished running node model.taxi_nyc_project.dim_date
[0m15:12:15.695438 [debug] [Thread-1 (]: Began running node model.taxi_nyc_project.dim_payment_type
[0m15:12:15.696437 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_nyc_project.dim_date, now model.taxi_nyc_project.dim_payment_type)
[0m15:12:15.696437 [debug] [Thread-1 (]: Began compiling node model.taxi_nyc_project.dim_payment_type
[0m15:12:15.699447 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_nyc_project.dim_payment_type"
[0m15:12:15.699447 [debug] [Thread-1 (]: Began executing node model.taxi_nyc_project.dim_payment_type
[0m15:12:15.700437 [debug] [Thread-1 (]: Finished running node model.taxi_nyc_project.dim_payment_type
[0m15:12:15.700437 [debug] [Thread-1 (]: Began running node model.taxi_nyc_project.stg_trips
[0m15:12:15.701437 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_nyc_project.dim_payment_type, now model.taxi_nyc_project.stg_trips)
[0m15:12:15.701437 [debug] [Thread-1 (]: Began compiling node model.taxi_nyc_project.stg_trips
[0m15:12:15.704445 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_nyc_project.stg_trips"
[0m15:12:15.705444 [debug] [Thread-1 (]: Began executing node model.taxi_nyc_project.stg_trips
[0m15:12:15.706438 [debug] [Thread-1 (]: Finished running node model.taxi_nyc_project.stg_trips
[0m15:12:15.706438 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_dim_date_date_key.881d0a31b6
[0m15:12:15.707521 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_nyc_project.stg_trips, now test.taxi_nyc_project.not_null_dim_date_date_key.881d0a31b6)
[0m15:12:15.707521 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_dim_date_date_key.881d0a31b6
[0m15:12:15.715526 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_dim_date_date_key.881d0a31b6"
[0m15:12:15.716527 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_dim_date_date_key.881d0a31b6
[0m15:12:15.717527 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_dim_date_date_key.881d0a31b6
[0m15:12:15.717527 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.unique_dim_date_date_key.0869fd48f9
[0m15:12:15.718527 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_dim_date_date_key.881d0a31b6, now test.taxi_nyc_project.unique_dim_date_date_key.0869fd48f9)
[0m15:12:15.718527 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.unique_dim_date_date_key.0869fd48f9
[0m15:12:15.723526 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.unique_dim_date_date_key.0869fd48f9"
[0m15:12:15.724526 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.unique_dim_date_date_key.0869fd48f9
[0m15:12:15.724526 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.unique_dim_date_date_key.0869fd48f9
[0m15:12:15.725527 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626
[0m15:12:15.725527 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.unique_dim_date_date_key.0869fd48f9, now test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626)
[0m15:12:15.725527 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626
[0m15:12:15.728544 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626"
[0m15:12:15.729543 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626
[0m15:12:15.730544 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626
[0m15:12:15.730544 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58
[0m15:12:15.730544 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626, now test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58)
[0m15:12:15.731544 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58
[0m15:12:15.734544 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58"
[0m15:12:15.735544 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58
[0m15:12:15.735544 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58
[0m15:12:15.736544 [debug] [Thread-1 (]: Began running node model.taxi_nyc_project.fact_trips
[0m15:12:15.736544 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58, now model.taxi_nyc_project.fact_trips)
[0m15:12:15.737543 [debug] [Thread-1 (]: Began compiling node model.taxi_nyc_project.fact_trips
[0m15:12:15.739544 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_nyc_project.fact_trips"
[0m15:12:15.740544 [debug] [Thread-1 (]: Began executing node model.taxi_nyc_project.fact_trips
[0m15:12:15.740544 [debug] [Thread-1 (]: Finished running node model.taxi_nyc_project.fact_trips
[0m15:12:15.741544 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec
[0m15:12:15.742544 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_nyc_project.fact_trips, now test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec)
[0m15:12:15.742544 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec
[0m15:12:15.748545 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec"
[0m15:12:15.748545 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec
[0m15:12:15.749544 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec
[0m15:12:15.749544 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d
[0m15:12:15.750544 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec, now test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d)
[0m15:12:15.750544 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d
[0m15:12:15.753545 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d"
[0m15:12:15.754544 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d
[0m15:12:15.755544 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d
[0m15:12:15.755544 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b
[0m15:12:15.755544 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d, now test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b)
[0m15:12:15.756544 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b
[0m15:12:15.759544 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b"
[0m15:12:15.759544 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b
[0m15:12:15.760551 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b
[0m15:12:15.760551 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74
[0m15:12:15.761544 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b, now test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74)
[0m15:12:15.761544 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74
[0m15:12:15.765544 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74"
[0m15:12:15.766543 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74
[0m15:12:15.767544 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74
[0m15:12:15.767544 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c
[0m15:12:15.767544 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74, now test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c)
[0m15:12:15.768544 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c
[0m15:12:15.771545 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c"
[0m15:12:15.771545 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c
[0m15:12:15.772544 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c
[0m15:12:15.772544 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae
[0m15:12:15.773550 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c, now test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae)
[0m15:12:15.773550 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae
[0m15:12:15.776545 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae"
[0m15:12:15.777544 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae
[0m15:12:15.778544 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae
[0m15:12:15.778544 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b
[0m15:12:15.779544 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae, now test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b)
[0m15:12:15.779544 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b
[0m15:12:15.782544 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b"
[0m15:12:15.783543 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b
[0m15:12:15.783543 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b
[0m15:12:15.784544 [debug] [Thread-1 (]: Began running node model.taxi_nyc_project.mart_daily_revenue
[0m15:12:15.784544 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b, now model.taxi_nyc_project.mart_daily_revenue)
[0m15:12:15.784544 [debug] [Thread-1 (]: Began compiling node model.taxi_nyc_project.mart_daily_revenue
[0m15:12:15.787544 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_nyc_project.mart_daily_revenue"
[0m15:12:15.787544 [debug] [Thread-1 (]: Began executing node model.taxi_nyc_project.mart_daily_revenue
[0m15:12:15.788550 [debug] [Thread-1 (]: Finished running node model.taxi_nyc_project.mart_daily_revenue
[0m15:12:15.788550 [debug] [Thread-1 (]: Began running node model.taxi_nyc_project.mart_tip_by_payment_type
[0m15:12:15.789544 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_nyc_project.mart_daily_revenue, now model.taxi_nyc_project.mart_tip_by_payment_type)
[0m15:12:15.789544 [debug] [Thread-1 (]: Began compiling node model.taxi_nyc_project.mart_tip_by_payment_type
[0m15:12:15.791544 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_nyc_project.mart_tip_by_payment_type"
[0m15:12:15.792544 [debug] [Thread-1 (]: Began executing node model.taxi_nyc_project.mart_tip_by_payment_type
[0m15:12:15.793544 [debug] [Thread-1 (]: Finished running node model.taxi_nyc_project.mart_tip_by_payment_type
[0m15:12:15.793544 [debug] [Thread-1 (]: Began running node model.taxi_nyc_project.mart_trips_by_hour
[0m15:12:15.793544 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_nyc_project.mart_tip_by_payment_type, now model.taxi_nyc_project.mart_trips_by_hour)
[0m15:12:15.794544 [debug] [Thread-1 (]: Began compiling node model.taxi_nyc_project.mart_trips_by_hour
[0m15:12:15.796544 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_nyc_project.mart_trips_by_hour"
[0m15:12:15.797544 [debug] [Thread-1 (]: Began executing node model.taxi_nyc_project.mart_trips_by_hour
[0m15:12:15.797544 [debug] [Thread-1 (]: Finished running node model.taxi_nyc_project.mart_trips_by_hour
[0m15:12:15.798544 [debug] [Thread-1 (]: Began running node model.taxi_nyc_project.mart_zone_revenue
[0m15:12:15.798544 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_nyc_project.mart_trips_by_hour, now model.taxi_nyc_project.mart_zone_revenue)
[0m15:12:15.799544 [debug] [Thread-1 (]: Began compiling node model.taxi_nyc_project.mart_zone_revenue
[0m15:12:15.801544 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_nyc_project.mart_zone_revenue"
[0m15:12:15.801544 [debug] [Thread-1 (]: Began executing node model.taxi_nyc_project.mart_zone_revenue
[0m15:12:15.802544 [debug] [Thread-1 (]: Finished running node model.taxi_nyc_project.mart_zone_revenue
[0m15:12:15.802544 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c
[0m15:12:15.803544 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_nyc_project.mart_zone_revenue, now test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c)
[0m15:12:15.803544 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c
[0m15:12:15.806544 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c"
[0m15:12:15.807544 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c
[0m15:12:15.807544 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c
[0m15:12:15.808544 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442
[0m15:12:15.808544 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c, now test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442)
[0m15:12:15.808544 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442
[0m15:12:15.811544 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442"
[0m15:12:15.812544 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442
[0m15:12:15.813544 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442
[0m15:12:15.813544 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6
[0m15:12:15.814544 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442, now test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6)
[0m15:12:15.814544 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6
[0m15:12:15.820544 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6"
[0m15:12:15.821544 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6
[0m15:12:15.822544 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6
[0m15:12:15.822544 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e
[0m15:12:15.823544 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6, now test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e)
[0m15:12:15.823544 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e
[0m15:12:15.826544 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e"
[0m15:12:15.827544 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e
[0m15:12:15.827544 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e
[0m15:12:15.828544 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:12:15.829555 [debug] [MainThread]: Connection 'list_sqldb-taxi-platform_bronze_silver' was properly closed.
[0m15:12:15.829555 [debug] [MainThread]: Connection 'test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e' was properly closed.
[0m15:12:15.832549 [debug] [MainThread]: Command end result
[0m15:12:15.887600 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\manifest.json
[0m15:12:15.890127 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\semantic_manifest.json
[0m15:12:15.896127 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\run_results.json
[0m15:12:15.897126 [debug] [MainThread]: Acquiring new sqlserver connection 'generate_catalog'
[0m15:12:15.898126 [info ] [MainThread]: Building catalog
[0m15:12:15.905643 [debug] [ThreadPool]: Acquiring new sqlserver connection 'sqldb-taxi-platform.information_schema'
[0m15:12:15.912640 [debug] [ThreadPool]: dbt-sqlserver
[0m15:12:15.912640 [debug] [ThreadPool]: Using sqlserver connection "sqldb-taxi-platform.information_schema"
[0m15:12:15.913640 [debug] [ThreadPool]: On sqldb-taxi-platform.information_schema: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "sqldb-taxi-platform.information_schema"} */
with
    principals as (
        select
            name as principal_name,
            principal_id as principal_id
        from
            sys.database_principals with (nolock)
    ),

    schemas as (
        select
            name as schema_name,
            schema_id as schema_id,
            principal_id as principal_id
        from
            sys.schemas with (nolock)
    ),

    tables as (
        select
            object_id,
            name as table_name,
            schema_id as schema_id,
            principal_id as principal_id,
            'BASE TABLE' as table_type
        from
            sys.tables with (nolock)
    ),

    tables_with_metadata as (
        select
            object_id,
            table_name,
            schema_name,
            coalesce(tables.principal_id, schemas.principal_id) as owner_principal_id,
            table_type
        from
            tables
        join schemas on tables.schema_id = schemas.schema_id
    ),

    views as (
        select
            object_id,
            name as table_name,
            schema_id as schema_id,
            principal_id as principal_id,
            'VIEW' as table_type
        from
            sys.views with (nolock)
    ),

    views_with_metadata as (
        select
            object_id,
            table_name,
            schema_name,
            coalesce(views.principal_id, schemas.principal_id) as owner_principal_id,
            table_type
        from
            views
        join schemas on views.schema_id = schemas.schema_id
    ),

    tables_and_views as (
        select
            object_id,
            table_name,
            schema_name,
            principal_name,
            table_type
        from
            tables_with_metadata
        join principals on tables_with_metadata.owner_principal_id = principals.principal_id
        union all
        select
            object_id,
            table_name,
            schema_name,
            principal_name,
            table_type
        from
            views_with_metadata
        join principals on views_with_metadata.owner_principal_id = principals.principal_id
    ),

    cols as (

        select
            c.object_id,
            c.name as column_name,
            c.column_id as column_index,
            t.name as column_type
        from sys.columns as c with (nolock)
        left join sys.types as t on c.system_type_id = t.system_type_id
    )

    select
        DB_NAME() as table_database,
        tv.schema_name as table_schema,
        tv.table_name,
        tv.table_type,
        null as table_comment,
        tv.principal_name as table_owner,
        cols.column_name,
        cols.column_index,
        cols.column_type,
        null as column_comment
    from tables_and_views tv
    join cols on tv.object_id = cols.object_id
    where (
                (
                    upper(tv.schema_name) = upper('bronze_silver')
                    and upper(tv.table_name) = upper('dim_date')
                )
             or 
                (
                    upper(tv.schema_name) = upper('bronze_gold')
                    and upper(tv.table_name) = upper('mart_daily_revenue')
                )
             or 
                (
                    upper(tv.schema_name) = upper('bronze_silver')
                    and upper(tv.table_name) = upper('dim_payment_type')
                )
             or 
                (
                    upper(tv.schema_name) = upper('bronze_gold')
                    and upper(tv.table_name) = upper('mart_zone_revenue')
                )
             or 
                (
                    upper(tv.schema_name) = upper('bronze_gold')
                    and upper(tv.table_name) = upper('mart_trips_by_hour')
                )
             or 
                (
                    upper(tv.schema_name) = upper('bronze_bronze')
                    and upper(tv.table_name) = upper('stg_trips')
                )
             or 
                (
                    upper(tv.schema_name) = upper('bronze_silver')
                    and upper(tv.table_name) = upper('fact_trips')
                )
             or 
                (
                    upper(tv.schema_name) = upper('bronze_gold')
                    and upper(tv.table_name) = upper('mart_tip_by_payment_type')
                )
            )

    order by column_index
    
    OPTION (LABEL = 'dbt-sqlserver');

[0m15:12:15.913640 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:12:15.914641 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:12:15.914641 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:12:16.065823 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:12:16.068841 [debug] [ThreadPool]: On sqldb-taxi-platform.information_schema: ROLLBACK
[0m15:12:16.069849 [debug] [ThreadPool]: On sqldb-taxi-platform.information_schema: Close
[0m15:12:16.079843 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\catalog.json
[0m15:12:16.102841 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\manifest.json
[0m15:12:16.105842 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\semantic_manifest.json
[0m15:12:16.106847 [info ] [MainThread]: Catalog written to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\catalog.json
[0m15:12:16.107791 [debug] [MainThread]: Command `dbt docs generate` succeeded at 15:12:16.107791 after 2.10 seconds
[0m15:12:16.108778 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m15:12:16.108778 [debug] [MainThread]: Connection 'sqldb-taxi-platform.information_schema' was properly closed.
[0m15:12:16.109759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBD50AC650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBD43DD610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBCE992850>]}
[0m15:12:16.109759 [debug] [MainThread]: Flushing usage events
[0m15:12:16.844699 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:12:24.551089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2FB571690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2FB56E350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2FB56E810>]}


============================== 15:12:24.555101 | 64bf334d-8d6b-4a2d-acf7-e90e8e22a07b ==============================
[0m15:12:24.555101 [info ] [MainThread]: Running with dbt=1.10.15
[0m15:12:24.556093 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'target_path': 'None', 'printer_width': '80', 'no_print': 'None', 'log_format': 'default', 'warn_error': 'None', 'log_path': 'C:\\Users\\alexm\\Desktop\\python\\azure-taxi-platform\\dbt_project\\logs', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': '.', 'invocation_command': 'dbt docs serve --profiles-dir .', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m15:12:24.881355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '64bf334d-8d6b-4a2d-acf7-e90e8e22a07b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2FACEFE90>]}
[0m15:12:24.931889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '64bf334d-8d6b-4a2d-acf7-e90e8e22a07b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2FA5794D0>]}
[0m15:14:28.518251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E70E6A3350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E70E6D6890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E70E6A2A90>]}


============================== 15:14:28.522253 | fb14a0b4-f96b-4bd0-a4c8-25dc5de2c0cd ==============================
[0m15:14:28.522253 [info ] [MainThread]: Running with dbt=1.10.15
[0m15:14:28.523252 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'printer_width': '80', 'target_path': 'None', 'invocation_command': 'dbt run --models gold.mart_daily_revenue --profiles-dir .', 'log_format': 'default', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'log_path': 'C:\\Users\\alexm\\Desktop\\python\\azure-taxi-platform\\dbt_project\\logs', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m15:14:28.523252 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m15:14:28.524251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fb14a0b4-f96b-4bd0-a4c8-25dc5de2c0cd', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E70E6A2690>]}
[0m15:14:28.847877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb14a0b4-f96b-4bd0-a4c8-25dc5de2c0cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E70DE8B1D0>]}
[0m15:14:28.896342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb14a0b4-f96b-4bd0-a4c8-25dc5de2c0cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E70D6A9510>]}
[0m15:14:28.897342 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m15:14:29.111409 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m15:14:29.266135 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:14:29.267135 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:14:29.295857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fb14a0b4-f96b-4bd0-a4c8-25dc5de2c0cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7101EEC90>]}
[0m15:14:29.353861 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\manifest.json
[0m15:14:29.355861 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\semantic_manifest.json
[0m15:14:29.377868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fb14a0b4-f96b-4bd0-a4c8-25dc5de2c0cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E70FFAA210>]}
[0m15:14:29.377868 [info ] [MainThread]: Found 8 models, 15 data tests, 535 macros
[0m15:14:29.378862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb14a0b4-f96b-4bd0-a4c8-25dc5de2c0cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E70FE33350>]}
[0m15:14:29.379861 [info ] [MainThread]: 
[0m15:14:29.380861 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:14:29.380861 [info ] [MainThread]: 
[0m15:14:29.381860 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m15:14:29.382861 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_sqldb-taxi-platform'
[0m15:14:29.395867 [debug] [ThreadPool]: dbt-sqlserver
[0m15:14:29.395867 [debug] [ThreadPool]: Using sqlserver connection "list_sqldb-taxi-platform"
[0m15:14:29.396861 [debug] [ThreadPool]: On list_sqldb-taxi-platform: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "list_sqldb-taxi-platform"} */
USE [sqldb-taxi-platform];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m15:14:29.396861 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:14:29.396861 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:14:29.995674 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:14:30.040591 [debug] [ThreadPool]: SQL status: OK in 1.000 seconds
[0m15:14:30.042604 [debug] [ThreadPool]: On list_sqldb-taxi-platform: Close
[0m15:14:30.046597 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_sqldb-taxi-platform_bronze_gold'
[0m15:14:30.051597 [debug] [ThreadPool]: dbt-sqlserver
[0m15:14:30.052591 [debug] [ThreadPool]: Using sqlserver connection "list_sqldb-taxi-platform_bronze_gold"
[0m15:14:30.052591 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_gold: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "list_sqldb-taxi-platform_bronze_gold"} */
USE [sqldb-taxi-platform];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze_gold'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m15:14:30.052591 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:14:30.053591 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:14:30.053591 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:14:30.100847 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:14:30.101974 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_gold: ROLLBACK
[0m15:14:30.102493 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_gold: Close
[0m15:14:30.102493 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sqldb-taxi-platform_bronze_gold, now list_sqldb-taxi-platform_bronze_silver)
[0m15:14:30.104829 [debug] [ThreadPool]: dbt-sqlserver
[0m15:14:30.105828 [debug] [ThreadPool]: Using sqlserver connection "list_sqldb-taxi-platform_bronze_silver"
[0m15:14:30.105828 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "list_sqldb-taxi-platform_bronze_silver"} */
USE [sqldb-taxi-platform];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze_silver'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m15:14:30.105828 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:14:30.105828 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:14:30.106828 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:14:30.153955 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:14:30.155964 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_silver: ROLLBACK
[0m15:14:30.155964 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_silver: Close
[0m15:14:30.156975 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sqldb-taxi-platform_bronze_silver, now list_sqldb-taxi-platform_bronze_bronze)
[0m15:14:30.158963 [debug] [ThreadPool]: dbt-sqlserver
[0m15:14:30.159963 [debug] [ThreadPool]: Using sqlserver connection "list_sqldb-taxi-platform_bronze_bronze"
[0m15:14:30.159963 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "list_sqldb-taxi-platform_bronze_bronze"} */
USE [sqldb-taxi-platform];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze_bronze'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m15:14:30.160969 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:14:30.160969 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:14:30.160969 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:14:30.210144 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:14:30.210687 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_bronze: ROLLBACK
[0m15:14:30.211697 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_bronze: Close
[0m15:14:30.212687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb14a0b4-f96b-4bd0-a4c8-25dc5de2c0cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E70E6E13D0>]}
[0m15:14:30.212687 [debug] [MainThread]: On master: COMMIT
[0m15:14:30.216686 [debug] [Thread-1 (]: Began running node model.taxi_nyc_project.mart_daily_revenue
[0m15:14:30.216686 [info ] [Thread-1 (]: 1 of 1 START sql table model bronze_gold.mart_daily_revenue .................... [RUN]
[0m15:14:30.217686 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.taxi_nyc_project.mart_daily_revenue'
[0m15:14:30.217686 [debug] [Thread-1 (]: Began compiling node model.taxi_nyc_project.mart_daily_revenue
[0m15:14:30.225735 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_nyc_project.mart_daily_revenue"
[0m15:14:30.226778 [debug] [Thread-1 (]: Began executing node model.taxi_nyc_project.mart_daily_revenue
[0m15:14:30.256327 [debug] [Thread-1 (]: dbt-sqlserver
[0m15:14:30.262055 [debug] [Thread-1 (]: Applying DROP to: "sqldb-taxi-platform"."bronze_gold"."mart_daily_revenue__dbt_tmp__dbt_tmp_vw"
[0m15:14:30.266055 [debug] [Thread-1 (]: dbt-sqlserver
[0m15:14:30.267056 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_daily_revenue"
[0m15:14:30.267056 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_daily_revenue"} */

        USE [sqldb-taxi-platform];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'sqldb-taxi-platform'
        and refs.referenced_schema_name = 'bronze_gold'
        and refs.referenced_entity_name = 'mart_daily_revenue__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m15:14:30.268055 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:14:30.268055 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:14:30.269056 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:14:30.314405 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:14:30.316412 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_daily_revenue"
[0m15:14:30.316412 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_daily_revenue"} */

      
      
    
    USE [sqldb-taxi-platform];
    EXEC('DROP view IF EXISTS "bronze_gold"."mart_daily_revenue__dbt_tmp__dbt_tmp_vw";');

[0m15:14:30.360998 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:14:30.371159 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_nyc_project.mart_daily_revenue"
[0m15:14:30.372166 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_daily_revenue"
[0m15:14:30.372166 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_daily_revenue"} */

  
    USE [sqldb-taxi-platform];
    USE [sqldb-taxi-platform];
    
    

    

    
    USE [sqldb-taxi-platform];
    EXEC('
        create view "bronze_gold"."mart_daily_revenue__dbt_tmp__dbt_tmp_vw" as 

select
    pickup_date                as trip_date,
    count(*)                   as trip_count,
    sum(total_amount)          as total_revenue,
    avg(total_amount)          as avg_revenue_per_trip
from "sqldb-taxi-platform"."bronze_silver"."fact_trips"
group by
    pickup_date;;
    ')

EXEC('
            SELECT * INTO "sqldb-taxi-platform"."bronze_gold"."mart_daily_revenue__dbt_tmp" FROM "sqldb-taxi-platform"."bronze_gold"."mart_daily_revenue__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS bronze_gold.mart_daily_revenue__dbt_tmp__dbt_tmp_vw')



    
    use [sqldb-taxi-platform];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'bronze_gold_mart_daily_revenue__dbt_tmp_cci'
        AND object_id=object_id('bronze_gold_mart_daily_revenue__dbt_tmp')
    )
    DROP index "bronze_gold"."mart_daily_revenue__dbt_tmp".bronze_gold_mart_daily_revenue__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX bronze_gold_mart_daily_revenue__dbt_tmp_cci
    ON "bronze_gold"."mart_daily_revenue__dbt_tmp"

   


  
[0m15:14:30.485521 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:14:30.490620 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_daily_revenue"
[0m15:14:30.491619 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_daily_revenue"} */
USE [sqldb-taxi-platform];
      EXEC sp_rename 'bronze_gold.mart_daily_revenue', 'mart_daily_revenue__dbt_backup'
[0m15:14:30.540146 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:14:30.543150 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_daily_revenue"
[0m15:14:30.543150 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_daily_revenue"} */
USE [sqldb-taxi-platform];
      EXEC sp_rename 'bronze_gold.mart_daily_revenue__dbt_tmp', 'mart_daily_revenue'
[0m15:14:30.591761 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:14:30.606759 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_daily_revenue: COMMIT
[0m15:14:30.608997 [debug] [Thread-1 (]: Applying DROP to: "sqldb-taxi-platform"."bronze_gold"."mart_daily_revenue__dbt_backup"
[0m15:14:30.609542 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_daily_revenue"
[0m15:14:30.610049 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_daily_revenue"} */

      
    USE [sqldb-taxi-platform];
    EXEC('DROP table IF EXISTS "bronze_gold"."mart_daily_revenue__dbt_backup";');

[0m15:14:30.657816 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:14:30.659923 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_daily_revenue: Close
[0m15:14:30.661857 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb14a0b4-f96b-4bd0-a4c8-25dc5de2c0cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E70FDF2990>]}
[0m15:14:30.661857 [info ] [Thread-1 (]: 1 of 1 OK created sql table model bronze_gold.mart_daily_revenue ............... [[32mOK[0m in 0.44s]
[0m15:14:30.662878 [debug] [Thread-1 (]: Finished running node model.taxi_nyc_project.mart_daily_revenue
[0m15:14:30.663864 [debug] [MainThread]: On master: COMMIT
[0m15:14:30.664859 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:14:30.664859 [debug] [MainThread]: Connection 'list_sqldb-taxi-platform' was properly closed.
[0m15:14:30.664859 [debug] [MainThread]: Connection 'list_sqldb-taxi-platform_bronze_bronze' was properly closed.
[0m15:14:30.665858 [debug] [MainThread]: Connection 'model.taxi_nyc_project.mart_daily_revenue' was properly closed.
[0m15:14:30.665858 [info ] [MainThread]: 
[0m15:14:30.665858 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.28 seconds (1.28s).
[0m15:14:30.667109 [debug] [MainThread]: Command end result
[0m15:14:30.690059 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\manifest.json
[0m15:14:30.691631 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\semantic_manifest.json
[0m15:14:30.696631 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\run_results.json
[0m15:14:30.696631 [info ] [MainThread]: 
[0m15:14:30.696631 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:14:30.698038 [info ] [MainThread]: 
[0m15:14:30.699037 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:14:30.699037 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:14:30.700126 [debug] [MainThread]: Command `dbt run` succeeded at 15:14:30.700126 after 2.24 seconds
[0m15:14:30.701132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E707C7F8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E70E339B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E707C02950>]}
[0m15:14:30.701132 [debug] [MainThread]: Flushing usage events
[0m15:14:31.482781 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:14:40.972814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E92BAE1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E95306E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E95478F50>]}


============================== 15:14:40.975818 | 2b0d2aca-167d-47bc-8193-e6f2fb19942f ==============================
[0m15:14:40.975818 [info ] [MainThread]: Running with dbt=1.10.15
[0m15:14:40.976810 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'write_json': 'True', 'profiles_dir': '.', 'printer_width': '80', 'use_colors': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\alexm\\Desktop\\python\\azure-taxi-platform\\dbt_project\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt docs generate --profiles-dir .', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m15:14:41.293485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b0d2aca-167d-47bc-8193-e6f2fb19942f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E955C48D0>]}
[0m15:14:41.338003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2b0d2aca-167d-47bc-8193-e6f2fb19942f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E945553D0>]}
[0m15:14:41.339003 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m15:14:41.551476 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m15:14:41.704541 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:14:41.704541 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:14:41.733881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2b0d2aca-167d-47bc-8193-e6f2fb19942f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E97112110>]}
[0m15:14:41.756891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2b0d2aca-167d-47bc-8193-e6f2fb19942f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E97369110>]}
[0m15:14:41.757892 [info ] [MainThread]: Found 8 models, 15 data tests, 535 macros
[0m15:14:41.757892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b0d2aca-167d-47bc-8193-e6f2fb19942f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E97111110>]}
[0m15:14:41.759893 [info ] [MainThread]: 
[0m15:14:41.760890 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:14:41.760890 [info ] [MainThread]: 
[0m15:14:41.761891 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m15:14:41.766891 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_sqldb-taxi-platform_bronze_bronze'
[0m15:14:41.780890 [debug] [ThreadPool]: dbt-sqlserver
[0m15:14:41.781890 [debug] [ThreadPool]: Using sqlserver connection "list_sqldb-taxi-platform_bronze_bronze"
[0m15:14:41.781890 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "list_sqldb-taxi-platform_bronze_bronze"} */
USE [sqldb-taxi-platform];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze_bronze'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m15:14:41.781890 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:14:41.782892 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:14:42.393459 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:14:42.443584 [debug] [ThreadPool]: SQL status: OK in 1.000 seconds
[0m15:14:42.445593 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_bronze: ROLLBACK
[0m15:14:42.445593 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_bronze: Close
[0m15:14:42.445593 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sqldb-taxi-platform_bronze_bronze, now list_sqldb-taxi-platform_bronze_silver)
[0m15:14:42.448342 [debug] [ThreadPool]: dbt-sqlserver
[0m15:14:42.449341 [debug] [ThreadPool]: Using sqlserver connection "list_sqldb-taxi-platform_bronze_silver"
[0m15:14:42.449341 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "list_sqldb-taxi-platform_bronze_silver"} */
USE [sqldb-taxi-platform];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze_silver'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m15:14:42.449341 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:14:42.450342 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:14:42.450342 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:14:42.502009 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:14:42.502997 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_silver: ROLLBACK
[0m15:14:42.503997 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_silver: Close
[0m15:14:42.503997 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sqldb-taxi-platform_bronze_silver, now list_sqldb-taxi-platform_bronze_gold)
[0m15:14:42.506004 [debug] [ThreadPool]: dbt-sqlserver
[0m15:14:42.507103 [debug] [ThreadPool]: Using sqlserver connection "list_sqldb-taxi-platform_bronze_gold"
[0m15:14:42.507103 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_gold: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "list_sqldb-taxi-platform_bronze_gold"} */
USE [sqldb-taxi-platform];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze_gold'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m15:14:42.507103 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:14:42.508020 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:14:42.508020 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:14:42.560353 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:14:42.561351 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_gold: ROLLBACK
[0m15:14:42.561351 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_gold: Close
[0m15:14:42.562344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b0d2aca-167d-47bc-8193-e6f2fb19942f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E955F3790>]}
[0m15:14:42.566376 [debug] [Thread-1 (]: Began running node model.taxi_nyc_project.dim_date
[0m15:14:42.566376 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.taxi_nyc_project.dim_date'
[0m15:14:42.567382 [debug] [Thread-1 (]: Began compiling node model.taxi_nyc_project.dim_date
[0m15:14:42.572407 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_nyc_project.dim_date"
[0m15:14:42.573407 [debug] [Thread-1 (]: Began executing node model.taxi_nyc_project.dim_date
[0m15:14:42.574401 [debug] [Thread-1 (]: Finished running node model.taxi_nyc_project.dim_date
[0m15:14:42.574401 [debug] [Thread-1 (]: Began running node model.taxi_nyc_project.dim_payment_type
[0m15:14:42.575407 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_nyc_project.dim_date, now model.taxi_nyc_project.dim_payment_type)
[0m15:14:42.575407 [debug] [Thread-1 (]: Began compiling node model.taxi_nyc_project.dim_payment_type
[0m15:14:42.577407 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_nyc_project.dim_payment_type"
[0m15:14:42.578408 [debug] [Thread-1 (]: Began executing node model.taxi_nyc_project.dim_payment_type
[0m15:14:42.579400 [debug] [Thread-1 (]: Finished running node model.taxi_nyc_project.dim_payment_type
[0m15:14:42.579400 [debug] [Thread-1 (]: Began running node model.taxi_nyc_project.stg_trips
[0m15:14:42.580400 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_nyc_project.dim_payment_type, now model.taxi_nyc_project.stg_trips)
[0m15:14:42.580400 [debug] [Thread-1 (]: Began compiling node model.taxi_nyc_project.stg_trips
[0m15:14:42.583407 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_nyc_project.stg_trips"
[0m15:14:42.584407 [debug] [Thread-1 (]: Began executing node model.taxi_nyc_project.stg_trips
[0m15:14:42.585409 [debug] [Thread-1 (]: Finished running node model.taxi_nyc_project.stg_trips
[0m15:14:42.585409 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_dim_date_date_key.881d0a31b6
[0m15:14:42.586400 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_nyc_project.stg_trips, now test.taxi_nyc_project.not_null_dim_date_date_key.881d0a31b6)
[0m15:14:42.586400 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_dim_date_date_key.881d0a31b6
[0m15:14:42.595407 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_dim_date_date_key.881d0a31b6"
[0m15:14:42.596400 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_dim_date_date_key.881d0a31b6
[0m15:14:42.596400 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_dim_date_date_key.881d0a31b6
[0m15:14:42.597400 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.unique_dim_date_date_key.0869fd48f9
[0m15:14:42.597400 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_dim_date_date_key.881d0a31b6, now test.taxi_nyc_project.unique_dim_date_date_key.0869fd48f9)
[0m15:14:42.598408 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.unique_dim_date_date_key.0869fd48f9
[0m15:14:42.602407 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.unique_dim_date_date_key.0869fd48f9"
[0m15:14:42.603404 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.unique_dim_date_date_key.0869fd48f9
[0m15:14:42.603404 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.unique_dim_date_date_key.0869fd48f9
[0m15:14:42.604409 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626
[0m15:14:42.604409 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.unique_dim_date_date_key.0869fd48f9, now test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626)
[0m15:14:42.605407 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626
[0m15:14:42.608408 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626"
[0m15:14:42.609400 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626
[0m15:14:42.609400 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626
[0m15:14:42.610400 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58
[0m15:14:42.610400 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626, now test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58)
[0m15:14:42.610400 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58
[0m15:14:42.613407 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58"
[0m15:14:42.614407 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58
[0m15:14:42.615401 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58
[0m15:14:42.615401 [debug] [Thread-1 (]: Began running node model.taxi_nyc_project.fact_trips
[0m15:14:42.616408 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58, now model.taxi_nyc_project.fact_trips)
[0m15:14:42.616408 [debug] [Thread-1 (]: Began compiling node model.taxi_nyc_project.fact_trips
[0m15:14:42.618294 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_nyc_project.fact_trips"
[0m15:14:42.619294 [debug] [Thread-1 (]: Began executing node model.taxi_nyc_project.fact_trips
[0m15:14:42.620295 [debug] [Thread-1 (]: Finished running node model.taxi_nyc_project.fact_trips
[0m15:14:42.620295 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec
[0m15:14:42.621296 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_nyc_project.fact_trips, now test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec)
[0m15:14:42.621296 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec
[0m15:14:42.626846 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec"
[0m15:14:42.627832 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec
[0m15:14:42.627832 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec
[0m15:14:42.628835 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d
[0m15:14:42.628835 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec, now test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d)
[0m15:14:42.629832 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d
[0m15:14:42.631832 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d"
[0m15:14:42.632832 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d
[0m15:14:42.633834 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d
[0m15:14:42.633834 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b
[0m15:14:42.634832 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d, now test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b)
[0m15:14:42.634832 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b
[0m15:14:42.637845 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b"
[0m15:14:42.638832 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b
[0m15:14:42.638832 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b
[0m15:14:42.639835 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74
[0m15:14:42.639835 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b, now test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74)
[0m15:14:42.640833 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74
[0m15:14:42.643832 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74"
[0m15:14:42.644832 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74
[0m15:14:42.644832 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74
[0m15:14:42.645834 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c
[0m15:14:42.645834 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74, now test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c)
[0m15:14:42.646833 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c
[0m15:14:42.648867 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c"
[0m15:14:42.649865 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c
[0m15:14:42.650868 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c
[0m15:14:42.650868 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae
[0m15:14:42.651866 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c, now test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae)
[0m15:14:42.651866 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae
[0m15:14:42.654865 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae"
[0m15:14:42.655859 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae
[0m15:14:42.655859 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae
[0m15:14:42.656859 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b
[0m15:14:42.656859 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae, now test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b)
[0m15:14:42.656859 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b
[0m15:14:42.659866 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b"
[0m15:14:42.660866 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b
[0m15:14:42.660866 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b
[0m15:14:42.661868 [debug] [Thread-1 (]: Began running node model.taxi_nyc_project.mart_daily_revenue
[0m15:14:42.661868 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b, now model.taxi_nyc_project.mart_daily_revenue)
[0m15:14:42.662866 [debug] [Thread-1 (]: Began compiling node model.taxi_nyc_project.mart_daily_revenue
[0m15:14:42.664866 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_nyc_project.mart_daily_revenue"
[0m15:14:42.665859 [debug] [Thread-1 (]: Began executing node model.taxi_nyc_project.mart_daily_revenue
[0m15:14:42.665859 [debug] [Thread-1 (]: Finished running node model.taxi_nyc_project.mart_daily_revenue
[0m15:14:42.665859 [debug] [Thread-1 (]: Began running node model.taxi_nyc_project.mart_tip_by_payment_type
[0m15:14:42.666866 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_nyc_project.mart_daily_revenue, now model.taxi_nyc_project.mart_tip_by_payment_type)
[0m15:14:42.666866 [debug] [Thread-1 (]: Began compiling node model.taxi_nyc_project.mart_tip_by_payment_type
[0m15:14:42.669890 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_nyc_project.mart_tip_by_payment_type"
[0m15:14:42.669890 [debug] [Thread-1 (]: Began executing node model.taxi_nyc_project.mart_tip_by_payment_type
[0m15:14:42.670883 [debug] [Thread-1 (]: Finished running node model.taxi_nyc_project.mart_tip_by_payment_type
[0m15:14:42.670883 [debug] [Thread-1 (]: Began running node model.taxi_nyc_project.mart_trips_by_hour
[0m15:14:42.671890 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_nyc_project.mart_tip_by_payment_type, now model.taxi_nyc_project.mart_trips_by_hour)
[0m15:14:42.671890 [debug] [Thread-1 (]: Began compiling node model.taxi_nyc_project.mart_trips_by_hour
[0m15:14:42.673889 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_nyc_project.mart_trips_by_hour"
[0m15:14:42.674890 [debug] [Thread-1 (]: Began executing node model.taxi_nyc_project.mart_trips_by_hour
[0m15:14:42.675885 [debug] [Thread-1 (]: Finished running node model.taxi_nyc_project.mart_trips_by_hour
[0m15:14:42.675885 [debug] [Thread-1 (]: Began running node model.taxi_nyc_project.mart_zone_revenue
[0m15:14:42.675885 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_nyc_project.mart_trips_by_hour, now model.taxi_nyc_project.mart_zone_revenue)
[0m15:14:42.676884 [debug] [Thread-1 (]: Began compiling node model.taxi_nyc_project.mart_zone_revenue
[0m15:14:42.678431 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_nyc_project.mart_zone_revenue"
[0m15:14:42.679433 [debug] [Thread-1 (]: Began executing node model.taxi_nyc_project.mart_zone_revenue
[0m15:14:42.680435 [debug] [Thread-1 (]: Finished running node model.taxi_nyc_project.mart_zone_revenue
[0m15:14:42.680435 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c
[0m15:14:42.680435 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_nyc_project.mart_zone_revenue, now test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c)
[0m15:14:42.681432 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c
[0m15:14:42.684434 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c"
[0m15:14:42.685425 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c
[0m15:14:42.685425 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c
[0m15:14:42.686435 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442
[0m15:14:42.686435 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c, now test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442)
[0m15:14:42.686435 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442
[0m15:14:42.688974 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442"
[0m15:14:42.689972 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442
[0m15:14:42.690974 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442
[0m15:14:42.690974 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6
[0m15:14:42.691971 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442, now test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6)
[0m15:14:42.691971 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6
[0m15:14:42.697972 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6"
[0m15:14:42.698972 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6
[0m15:14:42.699975 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6
[0m15:14:42.699975 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e
[0m15:14:42.700974 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6, now test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e)
[0m15:14:42.700974 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e
[0m15:14:42.703971 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e"
[0m15:14:42.704964 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e
[0m15:14:42.704964 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e
[0m15:14:42.705964 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:14:42.706978 [debug] [MainThread]: Connection 'list_sqldb-taxi-platform_bronze_gold' was properly closed.
[0m15:14:42.706978 [debug] [MainThread]: Connection 'test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e' was properly closed.
[0m15:14:42.709972 [debug] [MainThread]: Command end result
[0m15:14:42.767053 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\manifest.json
[0m15:14:42.768952 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\semantic_manifest.json
[0m15:14:42.774943 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\run_results.json
[0m15:14:42.776952 [debug] [MainThread]: Acquiring new sqlserver connection 'generate_catalog'
[0m15:14:42.777948 [info ] [MainThread]: Building catalog
[0m15:14:42.785943 [debug] [ThreadPool]: Acquiring new sqlserver connection 'sqldb-taxi-platform.information_schema'
[0m15:14:42.791974 [debug] [ThreadPool]: dbt-sqlserver
[0m15:14:42.792974 [debug] [ThreadPool]: Using sqlserver connection "sqldb-taxi-platform.information_schema"
[0m15:14:42.793979 [debug] [ThreadPool]: On sqldb-taxi-platform.information_schema: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "sqldb-taxi-platform.information_schema"} */
with
    principals as (
        select
            name as principal_name,
            principal_id as principal_id
        from
            sys.database_principals with (nolock)
    ),

    schemas as (
        select
            name as schema_name,
            schema_id as schema_id,
            principal_id as principal_id
        from
            sys.schemas with (nolock)
    ),

    tables as (
        select
            object_id,
            name as table_name,
            schema_id as schema_id,
            principal_id as principal_id,
            'BASE TABLE' as table_type
        from
            sys.tables with (nolock)
    ),

    tables_with_metadata as (
        select
            object_id,
            table_name,
            schema_name,
            coalesce(tables.principal_id, schemas.principal_id) as owner_principal_id,
            table_type
        from
            tables
        join schemas on tables.schema_id = schemas.schema_id
    ),

    views as (
        select
            object_id,
            name as table_name,
            schema_id as schema_id,
            principal_id as principal_id,
            'VIEW' as table_type
        from
            sys.views with (nolock)
    ),

    views_with_metadata as (
        select
            object_id,
            table_name,
            schema_name,
            coalesce(views.principal_id, schemas.principal_id) as owner_principal_id,
            table_type
        from
            views
        join schemas on views.schema_id = schemas.schema_id
    ),

    tables_and_views as (
        select
            object_id,
            table_name,
            schema_name,
            principal_name,
            table_type
        from
            tables_with_metadata
        join principals on tables_with_metadata.owner_principal_id = principals.principal_id
        union all
        select
            object_id,
            table_name,
            schema_name,
            principal_name,
            table_type
        from
            views_with_metadata
        join principals on views_with_metadata.owner_principal_id = principals.principal_id
    ),

    cols as (

        select
            c.object_id,
            c.name as column_name,
            c.column_id as column_index,
            t.name as column_type
        from sys.columns as c with (nolock)
        left join sys.types as t on c.system_type_id = t.system_type_id
    )

    select
        DB_NAME() as table_database,
        tv.schema_name as table_schema,
        tv.table_name,
        tv.table_type,
        null as table_comment,
        tv.principal_name as table_owner,
        cols.column_name,
        cols.column_index,
        cols.column_type,
        null as column_comment
    from tables_and_views tv
    join cols on tv.object_id = cols.object_id
    where (
                (
                    upper(tv.schema_name) = upper('bronze_gold')
                    and upper(tv.table_name) = upper('mart_zone_revenue')
                )
             or 
                (
                    upper(tv.schema_name) = upper('bronze_silver')
                    and upper(tv.table_name) = upper('dim_date')
                )
             or 
                (
                    upper(tv.schema_name) = upper('bronze_gold')
                    and upper(tv.table_name) = upper('mart_tip_by_payment_type')
                )
             or 
                (
                    upper(tv.schema_name) = upper('bronze_silver')
                    and upper(tv.table_name) = upper('dim_payment_type')
                )
             or 
                (
                    upper(tv.schema_name) = upper('bronze_silver')
                    and upper(tv.table_name) = upper('fact_trips')
                )
             or 
                (
                    upper(tv.schema_name) = upper('bronze_gold')
                    and upper(tv.table_name) = upper('mart_trips_by_hour')
                )
             or 
                (
                    upper(tv.schema_name) = upper('bronze_bronze')
                    and upper(tv.table_name) = upper('stg_trips')
                )
             or 
                (
                    upper(tv.schema_name) = upper('bronze_gold')
                    and upper(tv.table_name) = upper('mart_daily_revenue')
                )
            )

    order by column_index
    
    OPTION (LABEL = 'dbt-sqlserver');

[0m15:14:42.793979 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:14:42.793979 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:14:42.794975 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:14:42.948250 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:14:42.951256 [debug] [ThreadPool]: On sqldb-taxi-platform.information_schema: ROLLBACK
[0m15:14:42.952257 [debug] [ThreadPool]: On sqldb-taxi-platform.information_schema: Close
[0m15:14:42.962256 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\catalog.json
[0m15:14:42.984285 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\manifest.json
[0m15:14:42.986283 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\semantic_manifest.json
[0m15:14:42.986283 [info ] [MainThread]: Catalog written to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\catalog.json
[0m15:14:42.988284 [debug] [MainThread]: Command `dbt docs generate` succeeded at 15:14:42.988284 after 2.08 seconds
[0m15:14:42.988284 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m15:14:42.988284 [debug] [MainThread]: Connection 'sqldb-taxi-platform.information_schema' was properly closed.
[0m15:14:42.989276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E9555D990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E8EAF2850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E955C4FD0>]}
[0m15:14:42.989276 [debug] [MainThread]: Flushing usage events
[0m15:14:43.737717 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:14:45.428987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6CCDAC890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6CCDAE050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6CCDAD390>]}


============================== 15:14:45.431995 | fb8cb33d-cfc8-4b50-b4d8-da366df167c5 ==============================
[0m15:14:45.431995 [info ] [MainThread]: Running with dbt=1.10.15
[0m15:14:45.432987 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'profiles_dir': '.', 'printer_width': '80', 'no_print': 'None', 'target_path': 'None', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\alexm\\Desktop\\python\\azure-taxi-platform\\dbt_project\\logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt docs serve --profiles-dir .', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m15:14:45.743658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb8cb33d-cfc8-4b50-b4d8-da366df167c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6CCDBA010>]}
[0m15:14:45.787839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb8cb33d-cfc8-4b50-b4d8-da366df167c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6CBDA9590>]}
[0m15:17:44.611616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A29B4B7310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A29B4B7CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A29B4B6A50>]}


============================== 15:17:44.615623 | 6bf2435f-2d3e-44ea-aaad-d59eeab87473 ==============================
[0m15:17:44.615623 [info ] [MainThread]: Running with dbt=1.10.15
[0m15:17:44.616626 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'cache_selected_only': 'False', 'target_path': 'None', 'no_print': 'None', 'invocation_command': 'dbt run -s silver.dim_date gold.mart_daily_revenue --profiles-dir . --no-partial-parse', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\alexm\\Desktop\\python\\azure-taxi-platform\\dbt_project\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m15:17:44.942793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6bf2435f-2d3e-44ea-aaad-d59eeab87473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A29B512B90>]}
[0m15:17:44.991180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6bf2435f-2d3e-44ea-aaad-d59eeab87473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A29A4B15D0>]}
[0m15:17:44.991180 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m15:17:45.218900 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m15:17:45.219889 [debug] [MainThread]: Partial parsing not enabled
[0m15:17:46.203582 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m15:17:46.204582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6bf2435f-2d3e-44ea-aaad-d59eeab87473', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A29D2B4390>]}
[0m15:17:46.302121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6bf2435f-2d3e-44ea-aaad-d59eeab87473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A29D1E6650>]}
[0m15:17:46.362254 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\manifest.json
[0m15:17:46.364255 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\semantic_manifest.json
[0m15:17:46.385254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6bf2435f-2d3e-44ea-aaad-d59eeab87473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A29D316350>]}
[0m15:17:46.386255 [info ] [MainThread]: Found 8 models, 15 data tests, 535 macros
[0m15:17:46.386255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6bf2435f-2d3e-44ea-aaad-d59eeab87473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A29CD3BAD0>]}
[0m15:17:46.388254 [info ] [MainThread]: 
[0m15:17:46.389257 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:17:46.389257 [info ] [MainThread]: 
[0m15:17:46.389257 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m15:17:46.394394 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_sqldb-taxi-platform'
[0m15:17:46.405919 [debug] [ThreadPool]: dbt-sqlserver
[0m15:17:46.405919 [debug] [ThreadPool]: Using sqlserver connection "list_sqldb-taxi-platform"
[0m15:17:46.405919 [debug] [ThreadPool]: On list_sqldb-taxi-platform: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "list_sqldb-taxi-platform"} */
USE [sqldb-taxi-platform];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m15:17:46.406927 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:17:46.406927 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:17:46.962473 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:17:47.006913 [debug] [ThreadPool]: SQL status: OK in 1.000 seconds
[0m15:17:47.008435 [debug] [ThreadPool]: On list_sqldb-taxi-platform: Close
[0m15:17:47.010429 [debug] [ThreadPool]: dbt-sqlserver
[0m15:17:47.011428 [debug] [ThreadPool]: Using sqlserver connection "list_sqldb-taxi-platform"
[0m15:17:47.011428 [debug] [ThreadPool]: On list_sqldb-taxi-platform: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "list_sqldb-taxi-platform"} */
USE [sqldb-taxi-platform];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m15:17:47.012422 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:17:47.012422 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:17:47.012422 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:17:47.057003 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:17:47.058002 [debug] [ThreadPool]: On list_sqldb-taxi-platform: Close
[0m15:17:47.059996 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_sqldb-taxi-platform_bronze_silver'
[0m15:17:47.064002 [debug] [ThreadPool]: dbt-sqlserver
[0m15:17:47.065003 [debug] [ThreadPool]: Using sqlserver connection "list_sqldb-taxi-platform_bronze_silver"
[0m15:17:47.065003 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "list_sqldb-taxi-platform_bronze_silver"} */
USE [sqldb-taxi-platform];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze_silver'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m15:17:47.066003 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:17:47.066003 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:17:47.066833 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:17:47.114704 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:17:47.116769 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_silver: ROLLBACK
[0m15:17:47.116769 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_silver: Close
[0m15:17:47.117726 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sqldb-taxi-platform_bronze_silver, now list_sqldb-taxi-platform_bronze_bronze)
[0m15:17:47.119733 [debug] [ThreadPool]: dbt-sqlserver
[0m15:17:47.120726 [debug] [ThreadPool]: Using sqlserver connection "list_sqldb-taxi-platform_bronze_bronze"
[0m15:17:47.120726 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "list_sqldb-taxi-platform_bronze_bronze"} */
USE [sqldb-taxi-platform];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze_bronze'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m15:17:47.120726 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:17:47.121726 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:17:47.121726 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:17:47.170198 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:17:47.171200 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_bronze: ROLLBACK
[0m15:17:47.171200 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_bronze: Close
[0m15:17:47.172197 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sqldb-taxi-platform_bronze_bronze, now list_sqldb-taxi-platform_bronze_gold)
[0m15:17:47.174197 [debug] [ThreadPool]: dbt-sqlserver
[0m15:17:47.175204 [debug] [ThreadPool]: Using sqlserver connection "list_sqldb-taxi-platform_bronze_gold"
[0m15:17:47.175204 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_gold: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "list_sqldb-taxi-platform_bronze_gold"} */
USE [sqldb-taxi-platform];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze_gold'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m15:17:47.176206 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:17:47.176206 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:17:47.176206 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:17:47.224353 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:17:47.224867 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_gold: ROLLBACK
[0m15:17:47.225862 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_gold: Close
[0m15:17:47.227375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6bf2435f-2d3e-44ea-aaad-d59eeab87473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A29D1F5910>]}
[0m15:17:47.227375 [debug] [MainThread]: On master: COMMIT
[0m15:17:47.231277 [debug] [Thread-1 (]: Began running node model.taxi_nyc_project.dim_date
[0m15:17:47.232291 [info ] [Thread-1 (]: 1 of 2 START sql table model bronze_silver.dim_date ............................ [RUN]
[0m15:17:47.232291 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.taxi_nyc_project.dim_date'
[0m15:17:47.233290 [debug] [Thread-1 (]: Began compiling node model.taxi_nyc_project.dim_date
[0m15:17:47.238827 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_nyc_project.dim_date"
[0m15:17:47.239890 [debug] [Thread-1 (]: Began executing node model.taxi_nyc_project.dim_date
[0m15:17:47.266616 [debug] [Thread-1 (]: dbt-sqlserver
[0m15:17:47.271282 [debug] [Thread-1 (]: Applying DROP to: "sqldb-taxi-platform"."bronze_silver"."dim_date__dbt_tmp__dbt_tmp_vw"
[0m15:17:47.276280 [debug] [Thread-1 (]: dbt-sqlserver
[0m15:17:47.277288 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.dim_date"
[0m15:17:47.277288 [debug] [Thread-1 (]: On model.taxi_nyc_project.dim_date: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.dim_date"} */

        USE [sqldb-taxi-platform];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'sqldb-taxi-platform'
        and refs.referenced_schema_name = 'bronze_silver'
        and refs.referenced_entity_name = 'dim_date__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m15:17:47.277288 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:17:47.278289 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:17:47.278289 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:17:47.325655 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:17:47.326655 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.dim_date"
[0m15:17:47.327661 [debug] [Thread-1 (]: On model.taxi_nyc_project.dim_date: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.dim_date"} */

      
      
    
    USE [sqldb-taxi-platform];
    EXEC('DROP view IF EXISTS "bronze_silver"."dim_date__dbt_tmp__dbt_tmp_vw";');

[0m15:17:47.371285 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:17:47.381967 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_nyc_project.dim_date"
[0m15:17:47.382961 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.dim_date"
[0m15:17:47.382961 [debug] [Thread-1 (]: On model.taxi_nyc_project.dim_date: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.dim_date"} */

  
    USE [sqldb-taxi-platform];
    USE [sqldb-taxi-platform];
    
    

    

    
    USE [sqldb-taxi-platform];
    EXEC('
        create view "bronze_silver"."dim_date__dbt_tmp__dbt_tmp_vw" as 

with numbers as (
    -- generate 365 rows: 0..364
    select top (365)
        row_number() over(order by (select null)) - 1 as n
    from sys.objects
),
dates as (
    select
        dateadd(day, n, cast(''2025-01-01'' as date)) as date_actual
    from numbers
)

select
    date_actual                           as date_key,   -- PK
    date_actual                           as date_actual,
    year(date_actual)                     as year,
    month(date_actual)                    as month,
    datename(month, date_actual)          as month_name,
    day(date_actual)                      as day,
    datename(weekday, date_actual)        as weekday_name,
    datepart(weekday, date_actual)        as weekday_num,
    case when datepart(weekday, date_actual) in (1, 7)
         then 1 else 0 end                as is_weekend
from dates;;
    ')

EXEC('
            SELECT * INTO "sqldb-taxi-platform"."bronze_silver"."dim_date__dbt_tmp" FROM "sqldb-taxi-platform"."bronze_silver"."dim_date__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS bronze_silver.dim_date__dbt_tmp__dbt_tmp_vw')



    
    use [sqldb-taxi-platform];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'bronze_silver_dim_date__dbt_tmp_cci'
        AND object_id=object_id('bronze_silver_dim_date__dbt_tmp')
    )
    DROP index "bronze_silver"."dim_date__dbt_tmp".bronze_silver_dim_date__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX bronze_silver_dim_date__dbt_tmp_cci
    ON "bronze_silver"."dim_date__dbt_tmp"

   


  
[0m15:17:47.474417 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:17:47.528440 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.dim_date"
[0m15:17:47.529431 [debug] [Thread-1 (]: On model.taxi_nyc_project.dim_date: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.dim_date"} */
USE [sqldb-taxi-platform];
      EXEC sp_rename 'bronze_silver.dim_date', 'dim_date__dbt_backup'
[0m15:17:47.576911 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:17:47.579900 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.dim_date"
[0m15:17:47.579900 [debug] [Thread-1 (]: On model.taxi_nyc_project.dim_date: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.dim_date"} */
USE [sqldb-taxi-platform];
      EXEC sp_rename 'bronze_silver.dim_date__dbt_tmp', 'dim_date'
[0m15:17:47.628258 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:17:47.642288 [debug] [Thread-1 (]: On model.taxi_nyc_project.dim_date: COMMIT
[0m15:17:47.644917 [debug] [Thread-1 (]: Applying DROP to: "sqldb-taxi-platform"."bronze_silver"."dim_date__dbt_backup"
[0m15:17:47.645919 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.dim_date"
[0m15:17:47.645919 [debug] [Thread-1 (]: On model.taxi_nyc_project.dim_date: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.dim_date"} */

      
    USE [sqldb-taxi-platform];
    EXEC('DROP table IF EXISTS "bronze_silver"."dim_date__dbt_backup";');

[0m15:17:47.694311 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:17:47.696312 [debug] [Thread-1 (]: On model.taxi_nyc_project.dim_date: Close
[0m15:17:47.698312 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bf2435f-2d3e-44ea-aaad-d59eeab87473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A29D2F1E10>]}
[0m15:17:47.699312 [info ] [Thread-1 (]: 1 of 2 OK created sql table model bronze_silver.dim_date ....................... [[32mOK[0m in 0.47s]
[0m15:17:47.699312 [debug] [Thread-1 (]: Finished running node model.taxi_nyc_project.dim_date
[0m15:17:47.700322 [debug] [Thread-1 (]: Began running node model.taxi_nyc_project.mart_daily_revenue
[0m15:17:47.700322 [info ] [Thread-1 (]: 2 of 2 START sql table model bronze_gold.mart_daily_revenue .................... [RUN]
[0m15:17:47.701312 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_nyc_project.dim_date, now model.taxi_nyc_project.mart_daily_revenue)
[0m15:17:47.701312 [debug] [Thread-1 (]: Began compiling node model.taxi_nyc_project.mart_daily_revenue
[0m15:17:47.704316 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_nyc_project.mart_daily_revenue"
[0m15:17:47.705312 [debug] [Thread-1 (]: Began executing node model.taxi_nyc_project.mart_daily_revenue
[0m15:17:47.707940 [debug] [Thread-1 (]: dbt-sqlserver
[0m15:17:47.709940 [debug] [Thread-1 (]: Applying DROP to: "sqldb-taxi-platform"."bronze_gold"."mart_daily_revenue__dbt_tmp__dbt_tmp_vw"
[0m15:17:47.710933 [debug] [Thread-1 (]: dbt-sqlserver
[0m15:17:47.711943 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_daily_revenue"
[0m15:17:47.711943 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_daily_revenue"} */

        USE [sqldb-taxi-platform];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'sqldb-taxi-platform'
        and refs.referenced_schema_name = 'bronze_gold'
        and refs.referenced_entity_name = 'mart_daily_revenue__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m15:17:47.711943 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:17:47.712943 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:17:47.712943 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:17:47.759295 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:17:47.760294 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_daily_revenue"
[0m15:17:47.761294 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_daily_revenue"} */

      
      
    
    USE [sqldb-taxi-platform];
    EXEC('DROP view IF EXISTS "bronze_gold"."mart_daily_revenue__dbt_tmp__dbt_tmp_vw";');

[0m15:17:47.805351 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:17:47.807306 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_nyc_project.mart_daily_revenue"
[0m15:17:47.808302 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_daily_revenue"
[0m15:17:47.808302 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_daily_revenue"} */

  
    USE [sqldb-taxi-platform];
    USE [sqldb-taxi-platform];
    
    

    

    
    USE [sqldb-taxi-platform];
    EXEC('
        create view "bronze_gold"."mart_daily_revenue__dbt_tmp__dbt_tmp_vw" as 

select
    pickup_date                as trip_date,
    count(*)                   as trip_count,
    sum(total_amount)          as total_revenue,
    avg(total_amount)          as avg_revenue_per_trip
from "sqldb-taxi-platform"."bronze_silver"."fact_trips"
group by
    pickup_date;;
    ')

EXEC('
            SELECT * INTO "sqldb-taxi-platform"."bronze_gold"."mart_daily_revenue__dbt_tmp" FROM "sqldb-taxi-platform"."bronze_gold"."mart_daily_revenue__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS bronze_gold.mart_daily_revenue__dbt_tmp__dbt_tmp_vw')



    
    use [sqldb-taxi-platform];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'bronze_gold_mart_daily_revenue__dbt_tmp_cci'
        AND object_id=object_id('bronze_gold_mart_daily_revenue__dbt_tmp')
    )
    DROP index "bronze_gold"."mart_daily_revenue__dbt_tmp".bronze_gold_mart_daily_revenue__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX bronze_gold_mart_daily_revenue__dbt_tmp_cci
    ON "bronze_gold"."mart_daily_revenue__dbt_tmp"

   


  
[0m15:17:47.903556 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:17:47.906555 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_daily_revenue"
[0m15:17:47.907555 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_daily_revenue"} */
USE [sqldb-taxi-platform];
      EXEC sp_rename 'bronze_gold.mart_daily_revenue', 'mart_daily_revenue__dbt_backup'
[0m15:17:47.956555 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:17:47.959556 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_daily_revenue"
[0m15:17:47.959556 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_daily_revenue"} */
USE [sqldb-taxi-platform];
      EXEC sp_rename 'bronze_gold.mart_daily_revenue__dbt_tmp', 'mart_daily_revenue'
[0m15:17:48.008057 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:17:48.009061 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_daily_revenue: COMMIT
[0m15:17:48.012059 [debug] [Thread-1 (]: Applying DROP to: "sqldb-taxi-platform"."bronze_gold"."mart_daily_revenue__dbt_backup"
[0m15:17:48.012059 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_daily_revenue"
[0m15:17:48.013060 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_daily_revenue"} */

      
    USE [sqldb-taxi-platform];
    EXEC('DROP table IF EXISTS "bronze_gold"."mart_daily_revenue__dbt_backup";');

[0m15:17:48.060551 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:17:48.061467 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_daily_revenue: Close
[0m15:17:48.062466 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bf2435f-2d3e-44ea-aaad-d59eeab87473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A29D6AA090>]}
[0m15:17:48.062466 [info ] [Thread-1 (]: 2 of 2 OK created sql table model bronze_gold.mart_daily_revenue ............... [[32mOK[0m in 0.36s]
[0m15:17:48.063466 [debug] [Thread-1 (]: Finished running node model.taxi_nyc_project.mart_daily_revenue
[0m15:17:48.064467 [debug] [MainThread]: On master: COMMIT
[0m15:17:48.065523 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:17:48.065523 [debug] [MainThread]: Connection 'list_sqldb-taxi-platform' was properly closed.
[0m15:17:48.065523 [debug] [MainThread]: Connection 'list_sqldb-taxi-platform_bronze_gold' was properly closed.
[0m15:17:48.066594 [debug] [MainThread]: Connection 'model.taxi_nyc_project.mart_daily_revenue' was properly closed.
[0m15:17:48.066594 [info ] [MainThread]: 
[0m15:17:48.066594 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 1.68 seconds (1.68s).
[0m15:17:48.067701 [debug] [MainThread]: Command end result
[0m15:17:48.091670 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\manifest.json
[0m15:17:48.093670 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\semantic_manifest.json
[0m15:17:48.098523 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\run_results.json
[0m15:17:48.098523 [info ] [MainThread]: 
[0m15:17:48.099530 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:17:48.099530 [info ] [MainThread]: 
[0m15:17:48.100548 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m15:17:48.101250 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 3 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:17:48.102265 [debug] [MainThread]: Command `dbt run` succeeded at 15:17:48.102265 after 3.55 seconds
[0m15:17:48.103254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A294A35950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2949F3A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2949F3AD0>]}
[0m15:17:48.103254 [debug] [MainThread]: Flushing usage events
[0m15:17:48.849811 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:18:45.072118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F50B01910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F50AFF810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F50AFF890>]}


============================== 15:18:45.076119 | d0a9cb06-057e-4a2e-b241-d761d2507b7c ==============================
[0m15:18:45.076119 [info ] [MainThread]: Running with dbt=1.10.15
[0m15:18:45.077118 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '.', 'invocation_command': 'dbt docs generate --profiles-dir . --no-partial-parse', 'cache_selected_only': 'False', 'log_format': 'default', 'write_json': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\alexm\\Desktop\\python\\azure-taxi-platform\\dbt_project\\logs', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m15:18:45.338880 [error] [MainThread]: Encountered an error:
Runtime Error
  at path []: Additional properties are not allowed ('docs' was unexpected)

Error encountered in C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\dbt_project.yml
[0m15:18:45.340873 [debug] [MainThread]: Command `dbt docs generate` failed at 15:18:45.340873 after 0.34 seconds
[0m15:18:45.340873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F50AFED50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F50B00D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F50B03F90>]}
[0m15:18:45.341873 [debug] [MainThread]: Flushing usage events
[0m15:18:46.110360 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:19:39.851548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A0B34D2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A0B6A1490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A0B6A0110>]}


============================== 15:19:39.855541 | 5f713837-28f7-4e77-8e7a-0e32378e987e ==============================
[0m15:19:39.855541 [info ] [MainThread]: Running with dbt=1.10.15
[0m15:19:39.855541 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '.', 'cache_selected_only': 'False', 'log_format': 'default', 'write_json': 'True', 'invocation_command': 'dbt docs generate --profiles-dir . --no-partial-parse', 'warn_error': 'None', 'log_path': 'C:\\Users\\alexm\\Desktop\\python\\azure-taxi-platform\\dbt_project\\logs', 'partial_parse': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m15:19:40.165603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f713837-28f7-4e77-8e7a-0e32378e987e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A0A6DFB50>]}
[0m15:19:40.208952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5f713837-28f7-4e77-8e7a-0e32378e987e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A0B6F6CD0>]}
[0m15:19:40.209952 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m15:19:40.425783 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m15:19:40.426783 [debug] [MainThread]: Partial parsing not enabled
[0m15:19:41.382535 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m15:19:41.383535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5f713837-28f7-4e77-8e7a-0e32378e987e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A0D414C90>]}
[0m15:19:41.479126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f713837-28f7-4e77-8e7a-0e32378e987e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A0D4E55D0>]}
[0m15:19:41.501575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f713837-28f7-4e77-8e7a-0e32378e987e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A0D686090>]}
[0m15:19:41.502574 [info ] [MainThread]: Found 8 models, 15 data tests, 535 macros
[0m15:19:41.503574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f713837-28f7-4e77-8e7a-0e32378e987e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A0D1C3F10>]}
[0m15:19:41.505576 [info ] [MainThread]: 
[0m15:19:41.505576 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:19:41.506574 [info ] [MainThread]: 
[0m15:19:41.506574 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m15:19:41.511587 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_sqldb-taxi-platform_bronze_bronze'
[0m15:19:41.523580 [debug] [ThreadPool]: dbt-sqlserver
[0m15:19:41.523580 [debug] [ThreadPool]: Using sqlserver connection "list_sqldb-taxi-platform_bronze_bronze"
[0m15:19:41.523580 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "list_sqldb-taxi-platform_bronze_bronze"} */
USE [sqldb-taxi-platform];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze_bronze'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m15:19:41.524581 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:19:41.524581 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:19:42.119720 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:19:42.167567 [debug] [ThreadPool]: SQL status: OK in 1.000 seconds
[0m15:19:42.168564 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_bronze: ROLLBACK
[0m15:19:42.169564 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_bronze: Close
[0m15:19:42.169564 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sqldb-taxi-platform_bronze_bronze, now list_sqldb-taxi-platform_bronze_silver)
[0m15:19:42.172563 [debug] [ThreadPool]: dbt-sqlserver
[0m15:19:42.172563 [debug] [ThreadPool]: Using sqlserver connection "list_sqldb-taxi-platform_bronze_silver"
[0m15:19:42.172563 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "list_sqldb-taxi-platform_bronze_silver"} */
USE [sqldb-taxi-platform];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze_silver'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m15:19:42.173565 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:19:42.173565 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:19:42.174565 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:19:42.221701 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:19:42.222703 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_silver: ROLLBACK
[0m15:19:42.222703 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_silver: Close
[0m15:19:42.223702 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sqldb-taxi-platform_bronze_silver, now list_sqldb-taxi-platform_bronze_gold)
[0m15:19:42.226731 [debug] [ThreadPool]: dbt-sqlserver
[0m15:19:42.227728 [debug] [ThreadPool]: Using sqlserver connection "list_sqldb-taxi-platform_bronze_gold"
[0m15:19:42.227728 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_gold: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "list_sqldb-taxi-platform_bronze_gold"} */
USE [sqldb-taxi-platform];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze_gold'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m15:19:42.227728 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:19:42.228721 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:19:42.228721 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:19:42.276663 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:19:42.277661 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_gold: ROLLBACK
[0m15:19:42.278661 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_gold: Close
[0m15:19:42.279660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f713837-28f7-4e77-8e7a-0e32378e987e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A0D4EB290>]}
[0m15:19:42.283653 [debug] [Thread-1 (]: Began running node model.taxi_nyc_project.dim_date
[0m15:19:42.283653 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.taxi_nyc_project.dim_date'
[0m15:19:42.284664 [debug] [Thread-1 (]: Began compiling node model.taxi_nyc_project.dim_date
[0m15:19:42.290660 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_nyc_project.dim_date"
[0m15:19:42.291654 [debug] [Thread-1 (]: Began executing node model.taxi_nyc_project.dim_date
[0m15:19:42.291654 [debug] [Thread-1 (]: Finished running node model.taxi_nyc_project.dim_date
[0m15:19:42.292662 [debug] [Thread-1 (]: Began running node model.taxi_nyc_project.dim_payment_type
[0m15:19:42.292662 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_nyc_project.dim_date, now model.taxi_nyc_project.dim_payment_type)
[0m15:19:42.293653 [debug] [Thread-1 (]: Began compiling node model.taxi_nyc_project.dim_payment_type
[0m15:19:42.295660 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_nyc_project.dim_payment_type"
[0m15:19:42.296661 [debug] [Thread-1 (]: Began executing node model.taxi_nyc_project.dim_payment_type
[0m15:19:42.297663 [debug] [Thread-1 (]: Finished running node model.taxi_nyc_project.dim_payment_type
[0m15:19:42.297663 [debug] [Thread-1 (]: Began running node model.taxi_nyc_project.stg_trips
[0m15:19:42.298661 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_nyc_project.dim_payment_type, now model.taxi_nyc_project.stg_trips)
[0m15:19:42.298661 [debug] [Thread-1 (]: Began compiling node model.taxi_nyc_project.stg_trips
[0m15:19:42.300660 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_nyc_project.stg_trips"
[0m15:19:42.301700 [debug] [Thread-1 (]: Began executing node model.taxi_nyc_project.stg_trips
[0m15:19:42.301700 [debug] [Thread-1 (]: Finished running node model.taxi_nyc_project.stg_trips
[0m15:19:42.302693 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_dim_date_date_key.881d0a31b6
[0m15:19:42.303501 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_nyc_project.stg_trips, now test.taxi_nyc_project.not_null_dim_date_date_key.881d0a31b6)
[0m15:19:42.303501 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_dim_date_date_key.881d0a31b6
[0m15:19:42.309507 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_dim_date_date_key.881d0a31b6"
[0m15:19:42.310507 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_dim_date_date_key.881d0a31b6
[0m15:19:42.311507 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_dim_date_date_key.881d0a31b6
[0m15:19:42.311507 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.unique_dim_date_date_key.0869fd48f9
[0m15:19:42.312507 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_dim_date_date_key.881d0a31b6, now test.taxi_nyc_project.unique_dim_date_date_key.0869fd48f9)
[0m15:19:42.312507 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.unique_dim_date_date_key.0869fd48f9
[0m15:19:42.317507 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.unique_dim_date_date_key.0869fd48f9"
[0m15:19:42.317507 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.unique_dim_date_date_key.0869fd48f9
[0m15:19:42.318517 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.unique_dim_date_date_key.0869fd48f9
[0m15:19:42.318517 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626
[0m15:19:42.319507 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.unique_dim_date_date_key.0869fd48f9, now test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626)
[0m15:19:42.319507 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626
[0m15:19:42.323015 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626"
[0m15:19:42.323015 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626
[0m15:19:42.324018 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626
[0m15:19:42.324018 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58
[0m15:19:42.325015 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626, now test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58)
[0m15:19:42.325015 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58
[0m15:19:42.328015 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58"
[0m15:19:42.329015 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58
[0m15:19:42.329015 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58
[0m15:19:42.330015 [debug] [Thread-1 (]: Began running node model.taxi_nyc_project.fact_trips
[0m15:19:42.330015 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58, now model.taxi_nyc_project.fact_trips)
[0m15:19:42.330015 [debug] [Thread-1 (]: Began compiling node model.taxi_nyc_project.fact_trips
[0m15:19:42.333015 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_nyc_project.fact_trips"
[0m15:19:42.333015 [debug] [Thread-1 (]: Began executing node model.taxi_nyc_project.fact_trips
[0m15:19:42.334015 [debug] [Thread-1 (]: Finished running node model.taxi_nyc_project.fact_trips
[0m15:19:42.334015 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec
[0m15:19:42.335015 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_nyc_project.fact_trips, now test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec)
[0m15:19:42.335015 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec
[0m15:19:42.339016 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec"
[0m15:19:42.340015 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec
[0m15:19:42.341027 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec
[0m15:19:42.341027 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d
[0m15:19:42.341027 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec, now test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d)
[0m15:19:42.342015 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d
[0m15:19:42.345016 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d"
[0m15:19:42.345526 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d
[0m15:19:42.346524 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d
[0m15:19:42.346524 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b
[0m15:19:42.347524 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d, now test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b)
[0m15:19:42.347524 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b
[0m15:19:42.350524 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b"
[0m15:19:42.351524 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b
[0m15:19:42.351524 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b
[0m15:19:42.352524 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74
[0m15:19:42.356619 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b, now test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74)
[0m15:19:42.357604 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74
[0m15:19:42.360591 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74"
[0m15:19:42.361526 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74
[0m15:19:42.361526 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74
[0m15:19:42.362592 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c
[0m15:19:42.362592 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74, now test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c)
[0m15:19:42.362592 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c
[0m15:19:42.365530 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c"
[0m15:19:42.366530 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c
[0m15:19:42.367525 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c
[0m15:19:42.367525 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae
[0m15:19:42.368525 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c, now test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae)
[0m15:19:42.368525 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae
[0m15:19:42.372529 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae"
[0m15:19:42.372529 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae
[0m15:19:42.373523 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae
[0m15:19:42.373523 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b
[0m15:19:42.374530 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae, now test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b)
[0m15:19:42.374530 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b
[0m15:19:42.377529 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b"
[0m15:19:42.378530 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b
[0m15:19:42.378530 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b
[0m15:19:42.379531 [debug] [Thread-1 (]: Began running node model.taxi_nyc_project.mart_daily_revenue
[0m15:19:42.379531 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b, now model.taxi_nyc_project.mart_daily_revenue)
[0m15:19:42.379531 [debug] [Thread-1 (]: Began compiling node model.taxi_nyc_project.mart_daily_revenue
[0m15:19:42.382529 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_nyc_project.mart_daily_revenue"
[0m15:19:42.382529 [debug] [Thread-1 (]: Began executing node model.taxi_nyc_project.mart_daily_revenue
[0m15:19:42.383526 [debug] [Thread-1 (]: Finished running node model.taxi_nyc_project.mart_daily_revenue
[0m15:19:42.383526 [debug] [Thread-1 (]: Began running node model.taxi_nyc_project.mart_tip_by_payment_type
[0m15:19:42.384530 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_nyc_project.mart_daily_revenue, now model.taxi_nyc_project.mart_tip_by_payment_type)
[0m15:19:42.384530 [debug] [Thread-1 (]: Began compiling node model.taxi_nyc_project.mart_tip_by_payment_type
[0m15:19:42.387077 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_nyc_project.mart_tip_by_payment_type"
[0m15:19:42.388071 [debug] [Thread-1 (]: Began executing node model.taxi_nyc_project.mart_tip_by_payment_type
[0m15:19:42.389072 [debug] [Thread-1 (]: Finished running node model.taxi_nyc_project.mart_tip_by_payment_type
[0m15:19:42.389072 [debug] [Thread-1 (]: Began running node model.taxi_nyc_project.mart_trips_by_hour
[0m15:19:42.389072 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_nyc_project.mart_tip_by_payment_type, now model.taxi_nyc_project.mart_trips_by_hour)
[0m15:19:42.390063 [debug] [Thread-1 (]: Began compiling node model.taxi_nyc_project.mart_trips_by_hour
[0m15:19:42.392070 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_nyc_project.mart_trips_by_hour"
[0m15:19:42.393070 [debug] [Thread-1 (]: Began executing node model.taxi_nyc_project.mart_trips_by_hour
[0m15:19:42.393070 [debug] [Thread-1 (]: Finished running node model.taxi_nyc_project.mart_trips_by_hour
[0m15:19:42.394076 [debug] [Thread-1 (]: Began running node model.taxi_nyc_project.mart_zone_revenue
[0m15:19:42.394076 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_nyc_project.mart_trips_by_hour, now model.taxi_nyc_project.mart_zone_revenue)
[0m15:19:42.394076 [debug] [Thread-1 (]: Began compiling node model.taxi_nyc_project.mart_zone_revenue
[0m15:19:42.397608 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_nyc_project.mart_zone_revenue"
[0m15:19:42.398610 [debug] [Thread-1 (]: Began executing node model.taxi_nyc_project.mart_zone_revenue
[0m15:19:42.398610 [debug] [Thread-1 (]: Finished running node model.taxi_nyc_project.mart_zone_revenue
[0m15:19:42.399616 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c
[0m15:19:42.399616 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_nyc_project.mart_zone_revenue, now test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c)
[0m15:19:42.400611 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c
[0m15:19:42.403610 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c"
[0m15:19:42.403610 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c
[0m15:19:42.404605 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c
[0m15:19:42.404605 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442
[0m15:19:42.405612 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c, now test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442)
[0m15:19:42.405612 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442
[0m15:19:42.408610 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442"
[0m15:19:42.409604 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442
[0m15:19:42.409604 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442
[0m15:19:42.410606 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6
[0m15:19:42.410606 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442, now test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6)
[0m15:19:42.410606 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6
[0m15:19:42.414603 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6"
[0m15:19:42.415606 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6
[0m15:19:42.415606 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6
[0m15:19:42.416605 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e
[0m15:19:42.416605 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6, now test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e)
[0m15:19:42.416605 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e
[0m15:19:42.419611 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e"
[0m15:19:42.420611 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e
[0m15:19:42.421604 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e
[0m15:19:42.422619 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:19:42.422619 [debug] [MainThread]: Connection 'list_sqldb-taxi-platform_bronze_gold' was properly closed.
[0m15:19:42.422619 [debug] [MainThread]: Connection 'test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e' was properly closed.
[0m15:19:42.425613 [debug] [MainThread]: Command end result
[0m15:19:42.536759 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\manifest.json
[0m15:19:42.538758 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\semantic_manifest.json
[0m15:19:42.545759 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\run_results.json
[0m15:19:42.547759 [debug] [MainThread]: Acquiring new sqlserver connection 'generate_catalog'
[0m15:19:42.547759 [info ] [MainThread]: Building catalog
[0m15:19:42.555758 [debug] [ThreadPool]: Acquiring new sqlserver connection 'sqldb-taxi-platform.information_schema'
[0m15:19:42.562758 [debug] [ThreadPool]: dbt-sqlserver
[0m15:19:42.563758 [debug] [ThreadPool]: Using sqlserver connection "sqldb-taxi-platform.information_schema"
[0m15:19:42.563758 [debug] [ThreadPool]: On sqldb-taxi-platform.information_schema: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "sqldb-taxi-platform.information_schema"} */
with
    principals as (
        select
            name as principal_name,
            principal_id as principal_id
        from
            sys.database_principals with (nolock)
    ),

    schemas as (
        select
            name as schema_name,
            schema_id as schema_id,
            principal_id as principal_id
        from
            sys.schemas with (nolock)
    ),

    tables as (
        select
            object_id,
            name as table_name,
            schema_id as schema_id,
            principal_id as principal_id,
            'BASE TABLE' as table_type
        from
            sys.tables with (nolock)
    ),

    tables_with_metadata as (
        select
            object_id,
            table_name,
            schema_name,
            coalesce(tables.principal_id, schemas.principal_id) as owner_principal_id,
            table_type
        from
            tables
        join schemas on tables.schema_id = schemas.schema_id
    ),

    views as (
        select
            object_id,
            name as table_name,
            schema_id as schema_id,
            principal_id as principal_id,
            'VIEW' as table_type
        from
            sys.views with (nolock)
    ),

    views_with_metadata as (
        select
            object_id,
            table_name,
            schema_name,
            coalesce(views.principal_id, schemas.principal_id) as owner_principal_id,
            table_type
        from
            views
        join schemas on views.schema_id = schemas.schema_id
    ),

    tables_and_views as (
        select
            object_id,
            table_name,
            schema_name,
            principal_name,
            table_type
        from
            tables_with_metadata
        join principals on tables_with_metadata.owner_principal_id = principals.principal_id
        union all
        select
            object_id,
            table_name,
            schema_name,
            principal_name,
            table_type
        from
            views_with_metadata
        join principals on views_with_metadata.owner_principal_id = principals.principal_id
    ),

    cols as (

        select
            c.object_id,
            c.name as column_name,
            c.column_id as column_index,
            t.name as column_type
        from sys.columns as c with (nolock)
        left join sys.types as t on c.system_type_id = t.system_type_id
    )

    select
        DB_NAME() as table_database,
        tv.schema_name as table_schema,
        tv.table_name,
        tv.table_type,
        null as table_comment,
        tv.principal_name as table_owner,
        cols.column_name,
        cols.column_index,
        cols.column_type,
        null as column_comment
    from tables_and_views tv
    join cols on tv.object_id = cols.object_id
    where (
                (
                    upper(tv.schema_name) = upper('bronze_silver')
                    and upper(tv.table_name) = upper('dim_date')
                )
             or 
                (
                    upper(tv.schema_name) = upper('bronze_gold')
                    and upper(tv.table_name) = upper('mart_zone_revenue')
                )
             or 
                (
                    upper(tv.schema_name) = upper('bronze_silver')
                    and upper(tv.table_name) = upper('dim_payment_type')
                )
             or 
                (
                    upper(tv.schema_name) = upper('bronze_silver')
                    and upper(tv.table_name) = upper('fact_trips')
                )
             or 
                (
                    upper(tv.schema_name) = upper('bronze_gold')
                    and upper(tv.table_name) = upper('mart_daily_revenue')
                )
             or 
                (
                    upper(tv.schema_name) = upper('bronze_gold')
                    and upper(tv.table_name) = upper('mart_tip_by_payment_type')
                )
             or 
                (
                    upper(tv.schema_name) = upper('bronze_gold')
                    and upper(tv.table_name) = upper('mart_trips_by_hour')
                )
             or 
                (
                    upper(tv.schema_name) = upper('bronze_bronze')
                    and upper(tv.table_name) = upper('stg_trips')
                )
            )

    order by column_index
    
    OPTION (LABEL = 'dbt-sqlserver');

[0m15:19:42.564758 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:19:42.564758 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:19:42.565758 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:19:42.715871 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:19:42.719872 [debug] [ThreadPool]: On sqldb-taxi-platform.information_schema: ROLLBACK
[0m15:19:42.719872 [debug] [ThreadPool]: On sqldb-taxi-platform.information_schema: Close
[0m15:19:42.731033 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\catalog.json
[0m15:19:42.754577 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\manifest.json
[0m15:19:42.757935 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\semantic_manifest.json
[0m15:19:42.758935 [info ] [MainThread]: Catalog written to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\catalog.json
[0m15:19:42.759935 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 3 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:19:42.761936 [debug] [MainThread]: Command `dbt docs generate` succeeded at 15:19:42.761936 after 2.98 seconds
[0m15:19:42.762952 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m15:19:42.762952 [debug] [MainThread]: Connection 'sqldb-taxi-platform.information_schema' was properly closed.
[0m15:19:42.762952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A08518810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A04C82950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A085A5050>]}
[0m15:19:42.763943 [debug] [MainThread]: Flushing usage events
[0m15:19:43.503995 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:19:53.565733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001889E5237D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001889E54C090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001889E5217D0>]}


============================== 15:19:53.569740 | 79d011a7-5798-4cb1-be44-94b4e8230cab ==============================
[0m15:19:53.569740 [info ] [MainThread]: Running with dbt=1.10.15
[0m15:19:53.569740 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'target_path': 'None', 'printer_width': '80', 'use_colors': 'True', 'profiles_dir': '.', 'warn_error': 'None', 'log_path': 'C:\\Users\\alexm\\Desktop\\python\\azure-taxi-platform\\dbt_project\\logs', 'partial_parse': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt docs serve --profiles-dir . --no-partial-parse', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m15:19:53.889565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '79d011a7-5798-4cb1-be44-94b4e8230cab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001889FE49190>]}
[0m15:19:53.935167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '79d011a7-5798-4cb1-be44-94b4e8230cab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001889D5194D0>]}
[0m15:24:04.577274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022168C12350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221689B6CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221689B6E90>]}


============================== 15:24:04.580963 | 6a26b8d1-8c59-43c4-bca7-358baf59e05f ==============================
[0m15:24:04.580963 [info ] [MainThread]: Running with dbt=1.10.15
[0m15:24:04.581967 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'log_format': 'default', 'use_colors': 'True', 'write_json': 'True', 'profiles_dir': '.', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'False', 'log_path': 'C:\\Users\\alexm\\Desktop\\python\\azure-taxi-platform\\dbt_project\\logs', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt run -s gold.mart_daily_revenue --profiles-dir . --no-partial-parse', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m15:24:04.921487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6a26b8d1-8c59-43c4-bca7-358baf59e05f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002216A49C190>]}
[0m15:24:04.966553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6a26b8d1-8c59-43c4-bca7-358baf59e05f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022167C094D0>]}
[0m15:24:04.967552 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m15:24:05.190274 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m15:24:05.191279 [debug] [MainThread]: Partial parsing not enabled
[0m15:24:06.143597 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m15:24:06.143597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6a26b8d1-8c59-43c4-bca7-358baf59e05f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002216A8B22D0>]}
[0m15:24:06.237452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6a26b8d1-8c59-43c4-bca7-358baf59e05f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002216A993490>]}
[0m15:24:06.297629 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\manifest.json
[0m15:24:06.300638 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\semantic_manifest.json
[0m15:24:06.322040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6a26b8d1-8c59-43c4-bca7-358baf59e05f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002216AC6A250>]}
[0m15:24:06.323032 [info ] [MainThread]: Found 8 models, 15 data tests, 535 macros
[0m15:24:06.323032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a26b8d1-8c59-43c4-bca7-358baf59e05f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002216AAB8490>]}
[0m15:24:06.325041 [info ] [MainThread]: 
[0m15:24:06.325041 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:24:06.326032 [info ] [MainThread]: 
[0m15:24:06.326032 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m15:24:06.328033 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_sqldb-taxi-platform'
[0m15:24:06.339033 [debug] [ThreadPool]: dbt-sqlserver
[0m15:24:06.339033 [debug] [ThreadPool]: Using sqlserver connection "list_sqldb-taxi-platform"
[0m15:24:06.340033 [debug] [ThreadPool]: On list_sqldb-taxi-platform: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "list_sqldb-taxi-platform"} */
USE [sqldb-taxi-platform];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m15:24:06.340033 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:24:06.341033 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:24:06.930311 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:24:06.974425 [debug] [ThreadPool]: SQL status: OK in 1.000 seconds
[0m15:24:06.976427 [debug] [ThreadPool]: On list_sqldb-taxi-platform: Close
[0m15:24:06.981335 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_sqldb-taxi-platform_bronze_bronze'
[0m15:24:06.986487 [debug] [ThreadPool]: dbt-sqlserver
[0m15:24:06.986487 [debug] [ThreadPool]: Using sqlserver connection "list_sqldb-taxi-platform_bronze_bronze"
[0m15:24:06.987524 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "list_sqldb-taxi-platform_bronze_bronze"} */
USE [sqldb-taxi-platform];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze_bronze'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m15:24:06.987524 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:24:06.987524 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:24:06.988500 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:24:07.035223 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:24:07.036241 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_bronze: ROLLBACK
[0m15:24:07.037231 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_bronze: Close
[0m15:24:07.037231 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sqldb-taxi-platform_bronze_bronze, now list_sqldb-taxi-platform_bronze_silver)
[0m15:24:07.039175 [debug] [ThreadPool]: dbt-sqlserver
[0m15:24:07.040175 [debug] [ThreadPool]: Using sqlserver connection "list_sqldb-taxi-platform_bronze_silver"
[0m15:24:07.040175 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "list_sqldb-taxi-platform_bronze_silver"} */
USE [sqldb-taxi-platform];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze_silver'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m15:24:07.040175 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:24:07.041177 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:24:07.041177 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:24:07.088372 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:24:07.089379 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_silver: ROLLBACK
[0m15:24:07.089379 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_silver: Close
[0m15:24:07.090358 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sqldb-taxi-platform_bronze_silver, now list_sqldb-taxi-platform_bronze_gold)
[0m15:24:07.092364 [debug] [ThreadPool]: dbt-sqlserver
[0m15:24:07.093368 [debug] [ThreadPool]: Using sqlserver connection "list_sqldb-taxi-platform_bronze_gold"
[0m15:24:07.093368 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_gold: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "list_sqldb-taxi-platform_bronze_gold"} */
USE [sqldb-taxi-platform];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze_gold'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m15:24:07.093368 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:24:07.094347 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:24:07.094347 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:24:07.141256 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:24:07.143251 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_gold: ROLLBACK
[0m15:24:07.143251 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_gold: Close
[0m15:24:07.144251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a26b8d1-8c59-43c4-bca7-358baf59e05f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002216AB5FB50>]}
[0m15:24:07.145273 [debug] [MainThread]: On master: COMMIT
[0m15:24:07.148269 [debug] [Thread-1 (]: Began running node model.taxi_nyc_project.mart_daily_revenue
[0m15:24:07.149276 [info ] [Thread-1 (]: 1 of 1 START sql table model bronze_gold.mart_daily_revenue .................... [RUN]
[0m15:24:07.149276 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.taxi_nyc_project.mart_daily_revenue'
[0m15:24:07.150272 [debug] [Thread-1 (]: Began compiling node model.taxi_nyc_project.mart_daily_revenue
[0m15:24:07.155796 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_nyc_project.mart_daily_revenue"
[0m15:24:07.156802 [debug] [Thread-1 (]: Began executing node model.taxi_nyc_project.mart_daily_revenue
[0m15:24:07.182826 [debug] [Thread-1 (]: dbt-sqlserver
[0m15:24:07.187825 [debug] [Thread-1 (]: Applying DROP to: "sqldb-taxi-platform"."bronze_gold"."mart_daily_revenue__dbt_tmp__dbt_tmp_vw"
[0m15:24:07.191841 [debug] [Thread-1 (]: dbt-sqlserver
[0m15:24:07.192848 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_daily_revenue"
[0m15:24:07.192848 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_daily_revenue"} */

        USE [sqldb-taxi-platform];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'sqldb-taxi-platform'
        and refs.referenced_schema_name = 'bronze_gold'
        and refs.referenced_entity_name = 'mart_daily_revenue__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m15:24:07.192848 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:24:07.193854 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:24:07.193854 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:24:07.240875 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:24:07.242871 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_daily_revenue"
[0m15:24:07.242871 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_daily_revenue"} */

      
      
    
    USE [sqldb-taxi-platform];
    EXEC('DROP view IF EXISTS "bronze_gold"."mart_daily_revenue__dbt_tmp__dbt_tmp_vw";');

[0m15:24:07.287074 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:24:07.297097 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_nyc_project.mart_daily_revenue"
[0m15:24:07.298097 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_daily_revenue"
[0m15:24:07.299090 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_daily_revenue"} */

  
    USE [sqldb-taxi-platform];
    USE [sqldb-taxi-platform];
    
    

    

    
    USE [sqldb-taxi-platform];
    EXEC('
        create view "bronze_gold"."mart_daily_revenue__dbt_tmp__dbt_tmp_vw" as 

select
    pickup_date                as trip_date,
    count(*)                   as trip_count,
    sum(total_amount)          as total_revenue,
    avg(total_amount)          as avg_revenue_per_trip
from "sqldb-taxi-platform"."bronze_silver"."fact_trips"
group by
    pickup_date;;
    ')

EXEC('
            SELECT * INTO "sqldb-taxi-platform"."bronze_gold"."mart_daily_revenue__dbt_tmp" FROM "sqldb-taxi-platform"."bronze_gold"."mart_daily_revenue__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS bronze_gold.mart_daily_revenue__dbt_tmp__dbt_tmp_vw')



    
    use [sqldb-taxi-platform];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'bronze_gold_mart_daily_revenue__dbt_tmp_cci'
        AND object_id=object_id('bronze_gold_mart_daily_revenue__dbt_tmp')
    )
    DROP index "bronze_gold"."mart_daily_revenue__dbt_tmp".bronze_gold_mart_daily_revenue__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX bronze_gold_mart_daily_revenue__dbt_tmp_cci
    ON "bronze_gold"."mart_daily_revenue__dbt_tmp"

   


  
[0m15:24:07.406418 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:24:07.411408 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_daily_revenue"
[0m15:24:07.412410 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_daily_revenue"} */
USE [sqldb-taxi-platform];
      EXEC sp_rename 'bronze_gold.mart_daily_revenue', 'mart_daily_revenue__dbt_backup'
[0m15:24:07.460358 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:24:07.464358 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_daily_revenue"
[0m15:24:07.464358 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_daily_revenue"} */
USE [sqldb-taxi-platform];
      EXEC sp_rename 'bronze_gold.mart_daily_revenue__dbt_tmp', 'mart_daily_revenue'
[0m15:24:07.512233 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:24:07.574167 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_daily_revenue: COMMIT
[0m15:24:07.577170 [debug] [Thread-1 (]: Applying DROP to: "sqldb-taxi-platform"."bronze_gold"."mart_daily_revenue__dbt_backup"
[0m15:24:07.577170 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_daily_revenue"
[0m15:24:07.578167 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_daily_revenue"} */

      
    USE [sqldb-taxi-platform];
    EXEC('DROP table IF EXISTS "bronze_gold"."mart_daily_revenue__dbt_backup";');

[0m15:24:07.625701 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:24:07.627701 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_daily_revenue: Close
[0m15:24:07.629692 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a26b8d1-8c59-43c4-bca7-358baf59e05f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002216AB85390>]}
[0m15:24:07.630699 [info ] [Thread-1 (]: 1 of 1 OK created sql table model bronze_gold.mart_daily_revenue ............... [[32mOK[0m in 0.48s]
[0m15:24:07.631329 [debug] [Thread-1 (]: Finished running node model.taxi_nyc_project.mart_daily_revenue
[0m15:24:07.632425 [debug] [MainThread]: On master: COMMIT
[0m15:24:07.633400 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:24:07.633400 [debug] [MainThread]: Connection 'list_sqldb-taxi-platform' was properly closed.
[0m15:24:07.633400 [debug] [MainThread]: Connection 'list_sqldb-taxi-platform_bronze_gold' was properly closed.
[0m15:24:07.633400 [debug] [MainThread]: Connection 'model.taxi_nyc_project.mart_daily_revenue' was properly closed.
[0m15:24:07.634400 [info ] [MainThread]: 
[0m15:24:07.634400 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.31 seconds (1.31s).
[0m15:24:07.635427 [debug] [MainThread]: Command end result
[0m15:24:07.659906 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\manifest.json
[0m15:24:07.661903 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\semantic_manifest.json
[0m15:24:07.666462 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\run_results.json
[0m15:24:07.667438 [info ] [MainThread]: 
[0m15:24:07.667950 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:24:07.668950 [info ] [MainThread]: 
[0m15:24:07.668950 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:24:07.669961 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 3 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:24:07.670635 [debug] [MainThread]: Command `dbt run` succeeded at 15:24:07.670635 after 3.16 seconds
[0m15:24:07.671657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221689B6E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022162163950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002216A9B4D90>]}
[0m15:24:07.671657 [debug] [MainThread]: Flushing usage events
[0m15:24:08.430994 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:24:16.173543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0CC2516D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0CC251410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0CC250450>]}


============================== 15:24:16.177544 | ef4ef68c-9bb7-4856-9088-2031eb3c152a ==============================
[0m15:24:16.177544 [info ] [MainThread]: Running with dbt=1.10.15
[0m15:24:16.178544 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '.', 'write_json': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'use_colors': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\alexm\\Desktop\\python\\azure-taxi-platform\\dbt_project\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt docs generate --profiles-dir . --no-partial-parse', 'printer_width': '80', 'target_path': 'None'}
[0m15:24:16.494707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ef4ef68c-9bb7-4856-9088-2031eb3c152a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0CB256F10>]}
[0m15:24:16.537708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ef4ef68c-9bb7-4856-9088-2031eb3c152a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0CDAE2490>]}
[0m15:24:16.538708 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m15:24:16.762793 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m15:24:16.763783 [debug] [MainThread]: Partial parsing not enabled
[0m15:24:17.728832 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m15:24:17.730112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ef4ef68c-9bb7-4856-9088-2031eb3c152a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0CDEC4390>]}
[0m15:24:17.823686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef4ef68c-9bb7-4856-9088-2031eb3c152a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0CE05C4D0>]}
[0m15:24:17.844692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef4ef68c-9bb7-4856-9088-2031eb3c152a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0CE23DA50>]}
[0m15:24:17.845684 [info ] [MainThread]: Found 8 models, 15 data tests, 535 macros
[0m15:24:17.845684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef4ef68c-9bb7-4856-9088-2031eb3c152a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0CE1A9710>]}
[0m15:24:17.847691 [info ] [MainThread]: 
[0m15:24:17.848686 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:24:17.849680 [info ] [MainThread]: 
[0m15:24:17.849680 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m15:24:17.854687 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_sqldb-taxi-platform_bronze_gold'
[0m15:24:17.866680 [debug] [ThreadPool]: dbt-sqlserver
[0m15:24:17.866680 [debug] [ThreadPool]: Using sqlserver connection "list_sqldb-taxi-platform_bronze_gold"
[0m15:24:17.867681 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_gold: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "list_sqldb-taxi-platform_bronze_gold"} */
USE [sqldb-taxi-platform];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze_gold'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m15:24:17.867681 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:24:17.867681 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:24:18.413231 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:24:18.460908 [debug] [ThreadPool]: SQL status: OK in 1.000 seconds
[0m15:24:18.462920 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_gold: ROLLBACK
[0m15:24:18.462920 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_gold: Close
[0m15:24:18.463907 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sqldb-taxi-platform_bronze_gold, now list_sqldb-taxi-platform_bronze_silver)
[0m15:24:18.466914 [debug] [ThreadPool]: dbt-sqlserver
[0m15:24:18.466914 [debug] [ThreadPool]: Using sqlserver connection "list_sqldb-taxi-platform_bronze_silver"
[0m15:24:18.466914 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "list_sqldb-taxi-platform_bronze_silver"} */
USE [sqldb-taxi-platform];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze_silver'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m15:24:18.467914 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:24:18.467914 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:24:18.467914 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:24:18.516279 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:24:18.517288 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_silver: ROLLBACK
[0m15:24:18.517288 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_silver: Close
[0m15:24:18.518284 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sqldb-taxi-platform_bronze_silver, now list_sqldb-taxi-platform_bronze_bronze)
[0m15:24:18.521284 [debug] [ThreadPool]: dbt-sqlserver
[0m15:24:18.521284 [debug] [ThreadPool]: Using sqlserver connection "list_sqldb-taxi-platform_bronze_bronze"
[0m15:24:18.522284 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "list_sqldb-taxi-platform_bronze_bronze"} */
USE [sqldb-taxi-platform];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze_bronze'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m15:24:18.522284 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:24:18.522284 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:24:18.523283 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:24:18.570645 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:24:18.571580 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_bronze: ROLLBACK
[0m15:24:18.571580 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_bronze: Close
[0m15:24:18.572587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef4ef68c-9bb7-4856-9088-2031eb3c152a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0CE2BD190>]}
[0m15:24:18.576580 [debug] [Thread-1 (]: Began running node model.taxi_nyc_project.dim_date
[0m15:24:18.577577 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.taxi_nyc_project.dim_date'
[0m15:24:18.577577 [debug] [Thread-1 (]: Began compiling node model.taxi_nyc_project.dim_date
[0m15:24:18.583584 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_nyc_project.dim_date"
[0m15:24:18.584580 [debug] [Thread-1 (]: Began executing node model.taxi_nyc_project.dim_date
[0m15:24:18.585578 [debug] [Thread-1 (]: Finished running node model.taxi_nyc_project.dim_date
[0m15:24:18.585578 [debug] [Thread-1 (]: Began running node model.taxi_nyc_project.dim_payment_type
[0m15:24:18.585578 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_nyc_project.dim_date, now model.taxi_nyc_project.dim_payment_type)
[0m15:24:18.586577 [debug] [Thread-1 (]: Began compiling node model.taxi_nyc_project.dim_payment_type
[0m15:24:18.588588 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_nyc_project.dim_payment_type"
[0m15:24:18.589584 [debug] [Thread-1 (]: Began executing node model.taxi_nyc_project.dim_payment_type
[0m15:24:18.590579 [debug] [Thread-1 (]: Finished running node model.taxi_nyc_project.dim_payment_type
[0m15:24:18.590579 [debug] [Thread-1 (]: Began running node model.taxi_nyc_project.stg_trips
[0m15:24:18.591577 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_nyc_project.dim_payment_type, now model.taxi_nyc_project.stg_trips)
[0m15:24:18.591577 [debug] [Thread-1 (]: Began compiling node model.taxi_nyc_project.stg_trips
[0m15:24:18.593584 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_nyc_project.stg_trips"
[0m15:24:18.594584 [debug] [Thread-1 (]: Began executing node model.taxi_nyc_project.stg_trips
[0m15:24:18.594584 [debug] [Thread-1 (]: Finished running node model.taxi_nyc_project.stg_trips
[0m15:24:18.595578 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_dim_date_date_key.881d0a31b6
[0m15:24:18.596577 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_nyc_project.stg_trips, now test.taxi_nyc_project.not_null_dim_date_date_key.881d0a31b6)
[0m15:24:18.596577 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_dim_date_date_key.881d0a31b6
[0m15:24:18.602612 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_dim_date_date_key.881d0a31b6"
[0m15:24:18.603606 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_dim_date_date_key.881d0a31b6
[0m15:24:18.603606 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_dim_date_date_key.881d0a31b6
[0m15:24:18.604615 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.unique_dim_date_date_key.0869fd48f9
[0m15:24:18.604615 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_dim_date_date_key.881d0a31b6, now test.taxi_nyc_project.unique_dim_date_date_key.0869fd48f9)
[0m15:24:18.605612 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.unique_dim_date_date_key.0869fd48f9
[0m15:24:18.609612 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.unique_dim_date_date_key.0869fd48f9"
[0m15:24:18.610606 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.unique_dim_date_date_key.0869fd48f9
[0m15:24:18.610606 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.unique_dim_date_date_key.0869fd48f9
[0m15:24:18.611616 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626
[0m15:24:18.611616 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.unique_dim_date_date_key.0869fd48f9, now test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626)
[0m15:24:18.611616 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626
[0m15:24:18.614612 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626"
[0m15:24:18.615605 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626
[0m15:24:18.616616 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626
[0m15:24:18.616616 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58
[0m15:24:18.616616 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626, now test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58)
[0m15:24:18.617617 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58
[0m15:24:18.620613 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58"
[0m15:24:18.620613 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58
[0m15:24:18.621607 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58
[0m15:24:18.621607 [debug] [Thread-1 (]: Began running node model.taxi_nyc_project.fact_trips
[0m15:24:18.622606 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58, now model.taxi_nyc_project.fact_trips)
[0m15:24:18.622606 [debug] [Thread-1 (]: Began compiling node model.taxi_nyc_project.fact_trips
[0m15:24:18.624612 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_nyc_project.fact_trips"
[0m15:24:18.625616 [debug] [Thread-1 (]: Began executing node model.taxi_nyc_project.fact_trips
[0m15:24:18.626606 [debug] [Thread-1 (]: Finished running node model.taxi_nyc_project.fact_trips
[0m15:24:18.626606 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec
[0m15:24:18.627606 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_nyc_project.fact_trips, now test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec)
[0m15:24:18.627606 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec
[0m15:24:18.631613 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec"
[0m15:24:18.631613 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec
[0m15:24:18.632606 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec
[0m15:24:18.632606 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d
[0m15:24:18.633606 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec, now test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d)
[0m15:24:18.633606 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d
[0m15:24:18.636640 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d"
[0m15:24:18.637631 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d
[0m15:24:18.637631 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d
[0m15:24:18.638630 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b
[0m15:24:18.638630 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d, now test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b)
[0m15:24:18.638630 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b
[0m15:24:18.641635 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b"
[0m15:24:18.642630 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b
[0m15:24:18.642630 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b
[0m15:24:18.643640 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74
[0m15:24:18.643640 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b, now test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74)
[0m15:24:18.644641 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74
[0m15:24:18.647174 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74"
[0m15:24:18.647174 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74
[0m15:24:18.648168 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74
[0m15:24:18.648168 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c
[0m15:24:18.649167 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74, now test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c)
[0m15:24:18.649167 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c
[0m15:24:18.652173 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c"
[0m15:24:18.653167 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c
[0m15:24:18.653167 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c
[0m15:24:18.654175 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae
[0m15:24:18.654175 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c, now test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae)
[0m15:24:18.654175 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae
[0m15:24:18.657181 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae"
[0m15:24:18.658174 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae
[0m15:24:18.659174 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae
[0m15:24:18.659174 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b
[0m15:24:18.659174 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae, now test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b)
[0m15:24:18.660185 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b
[0m15:24:18.662180 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b"
[0m15:24:18.663181 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b
[0m15:24:18.664175 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b
[0m15:24:18.664175 [debug] [Thread-1 (]: Began running node model.taxi_nyc_project.mart_daily_revenue
[0m15:24:18.665174 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b, now model.taxi_nyc_project.mart_daily_revenue)
[0m15:24:18.665174 [debug] [Thread-1 (]: Began compiling node model.taxi_nyc_project.mart_daily_revenue
[0m15:24:18.667181 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_nyc_project.mart_daily_revenue"
[0m15:24:18.668175 [debug] [Thread-1 (]: Began executing node model.taxi_nyc_project.mart_daily_revenue
[0m15:24:18.668175 [debug] [Thread-1 (]: Finished running node model.taxi_nyc_project.mart_daily_revenue
[0m15:24:18.669184 [debug] [Thread-1 (]: Began running node model.taxi_nyc_project.mart_tip_by_payment_type
[0m15:24:18.669184 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_nyc_project.mart_daily_revenue, now model.taxi_nyc_project.mart_tip_by_payment_type)
[0m15:24:18.669184 [debug] [Thread-1 (]: Began compiling node model.taxi_nyc_project.mart_tip_by_payment_type
[0m15:24:18.672180 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_nyc_project.mart_tip_by_payment_type"
[0m15:24:18.672180 [debug] [Thread-1 (]: Began executing node model.taxi_nyc_project.mart_tip_by_payment_type
[0m15:24:18.673175 [debug] [Thread-1 (]: Finished running node model.taxi_nyc_project.mart_tip_by_payment_type
[0m15:24:18.673175 [debug] [Thread-1 (]: Began running node model.taxi_nyc_project.mart_trips_by_hour
[0m15:24:18.674174 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_nyc_project.mart_tip_by_payment_type, now model.taxi_nyc_project.mart_trips_by_hour)
[0m15:24:18.674174 [debug] [Thread-1 (]: Began compiling node model.taxi_nyc_project.mart_trips_by_hour
[0m15:24:18.676692 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_nyc_project.mart_trips_by_hour"
[0m15:24:18.676692 [debug] [Thread-1 (]: Began executing node model.taxi_nyc_project.mart_trips_by_hour
[0m15:24:18.677689 [debug] [Thread-1 (]: Finished running node model.taxi_nyc_project.mart_trips_by_hour
[0m15:24:18.677689 [debug] [Thread-1 (]: Began running node model.taxi_nyc_project.mart_zone_revenue
[0m15:24:18.678685 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_nyc_project.mart_trips_by_hour, now model.taxi_nyc_project.mart_zone_revenue)
[0m15:24:18.678685 [debug] [Thread-1 (]: Began compiling node model.taxi_nyc_project.mart_zone_revenue
[0m15:24:18.681692 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_nyc_project.mart_zone_revenue"
[0m15:24:18.682685 [debug] [Thread-1 (]: Began executing node model.taxi_nyc_project.mart_zone_revenue
[0m15:24:18.682685 [debug] [Thread-1 (]: Finished running node model.taxi_nyc_project.mart_zone_revenue
[0m15:24:18.683685 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c
[0m15:24:18.683685 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_nyc_project.mart_zone_revenue, now test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c)
[0m15:24:18.683685 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c
[0m15:24:18.687031 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c"
[0m15:24:18.688038 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c
[0m15:24:18.688038 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c
[0m15:24:18.688038 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442
[0m15:24:18.689021 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c, now test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442)
[0m15:24:18.689021 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442
[0m15:24:18.692027 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442"
[0m15:24:18.693021 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442
[0m15:24:18.693021 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442
[0m15:24:18.694021 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6
[0m15:24:18.694021 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442, now test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6)
[0m15:24:18.694021 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6
[0m15:24:18.697546 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6"
[0m15:24:18.698543 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6
[0m15:24:18.699538 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6
[0m15:24:18.699538 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e
[0m15:24:18.699538 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6, now test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e)
[0m15:24:18.700548 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e
[0m15:24:18.702544 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e"
[0m15:24:18.703544 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e
[0m15:24:18.704538 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e
[0m15:24:18.705538 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:24:18.705538 [debug] [MainThread]: Connection 'list_sqldb-taxi-platform_bronze_bronze' was properly closed.
[0m15:24:18.706538 [debug] [MainThread]: Connection 'test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e' was properly closed.
[0m15:24:18.708545 [debug] [MainThread]: Command end result
[0m15:24:18.819224 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\manifest.json
[0m15:24:18.821257 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\semantic_manifest.json
[0m15:24:18.827178 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\run_results.json
[0m15:24:18.829177 [debug] [MainThread]: Acquiring new sqlserver connection 'generate_catalog'
[0m15:24:18.829177 [info ] [MainThread]: Building catalog
[0m15:24:18.837695 [debug] [ThreadPool]: Acquiring new sqlserver connection 'sqldb-taxi-platform.information_schema'
[0m15:24:18.843693 [debug] [ThreadPool]: dbt-sqlserver
[0m15:24:18.844695 [debug] [ThreadPool]: Using sqlserver connection "sqldb-taxi-platform.information_schema"
[0m15:24:18.844695 [debug] [ThreadPool]: On sqldb-taxi-platform.information_schema: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "sqldb-taxi-platform.information_schema"} */
with
    principals as (
        select
            name as principal_name,
            principal_id as principal_id
        from
            sys.database_principals with (nolock)
    ),

    schemas as (
        select
            name as schema_name,
            schema_id as schema_id,
            principal_id as principal_id
        from
            sys.schemas with (nolock)
    ),

    tables as (
        select
            object_id,
            name as table_name,
            schema_id as schema_id,
            principal_id as principal_id,
            'BASE TABLE' as table_type
        from
            sys.tables with (nolock)
    ),

    tables_with_metadata as (
        select
            object_id,
            table_name,
            schema_name,
            coalesce(tables.principal_id, schemas.principal_id) as owner_principal_id,
            table_type
        from
            tables
        join schemas on tables.schema_id = schemas.schema_id
    ),

    views as (
        select
            object_id,
            name as table_name,
            schema_id as schema_id,
            principal_id as principal_id,
            'VIEW' as table_type
        from
            sys.views with (nolock)
    ),

    views_with_metadata as (
        select
            object_id,
            table_name,
            schema_name,
            coalesce(views.principal_id, schemas.principal_id) as owner_principal_id,
            table_type
        from
            views
        join schemas on views.schema_id = schemas.schema_id
    ),

    tables_and_views as (
        select
            object_id,
            table_name,
            schema_name,
            principal_name,
            table_type
        from
            tables_with_metadata
        join principals on tables_with_metadata.owner_principal_id = principals.principal_id
        union all
        select
            object_id,
            table_name,
            schema_name,
            principal_name,
            table_type
        from
            views_with_metadata
        join principals on views_with_metadata.owner_principal_id = principals.principal_id
    ),

    cols as (

        select
            c.object_id,
            c.name as column_name,
            c.column_id as column_index,
            t.name as column_type
        from sys.columns as c with (nolock)
        left join sys.types as t on c.system_type_id = t.system_type_id
    )

    select
        DB_NAME() as table_database,
        tv.schema_name as table_schema,
        tv.table_name,
        tv.table_type,
        null as table_comment,
        tv.principal_name as table_owner,
        cols.column_name,
        cols.column_index,
        cols.column_type,
        null as column_comment
    from tables_and_views tv
    join cols on tv.object_id = cols.object_id
    where (
                (
                    upper(tv.schema_name) = upper('bronze_bronze')
                    and upper(tv.table_name) = upper('stg_trips')
                )
             or 
                (
                    upper(tv.schema_name) = upper('bronze_silver')
                    and upper(tv.table_name) = upper('fact_trips')
                )
             or 
                (
                    upper(tv.schema_name) = upper('bronze_silver')
                    and upper(tv.table_name) = upper('dim_date')
                )
             or 
                (
                    upper(tv.schema_name) = upper('bronze_gold')
                    and upper(tv.table_name) = upper('mart_daily_revenue')
                )
             or 
                (
                    upper(tv.schema_name) = upper('bronze_gold')
                    and upper(tv.table_name) = upper('mart_trips_by_hour')
                )
             or 
                (
                    upper(tv.schema_name) = upper('bronze_gold')
                    and upper(tv.table_name) = upper('mart_zone_revenue')
                )
             or 
                (
                    upper(tv.schema_name) = upper('bronze_silver')
                    and upper(tv.table_name) = upper('dim_payment_type')
                )
             or 
                (
                    upper(tv.schema_name) = upper('bronze_gold')
                    and upper(tv.table_name) = upper('mart_tip_by_payment_type')
                )
            )

    order by column_index
    
    OPTION (LABEL = 'dbt-sqlserver');

[0m15:24:18.845697 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:24:18.846214 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:24:18.846214 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:24:19.030189 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:24:19.034201 [debug] [ThreadPool]: On sqldb-taxi-platform.information_schema: ROLLBACK
[0m15:24:19.034201 [debug] [ThreadPool]: On sqldb-taxi-platform.information_schema: Close
[0m15:24:19.044493 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\catalog.json
[0m15:24:19.066466 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\manifest.json
[0m15:24:19.068456 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\semantic_manifest.json
[0m15:24:19.069456 [info ] [MainThread]: Catalog written to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\catalog.json
[0m15:24:19.074160 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 3 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:24:19.075177 [debug] [MainThread]: Command `dbt docs generate` succeeded at 15:24:19.075177 after 2.96 seconds
[0m15:24:19.075177 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m15:24:19.076185 [debug] [MainThread]: Connection 'sqldb-taxi-platform.information_schema' was properly closed.
[0m15:24:19.076185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0CE2DF710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0C5862950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0C9155190>]}
[0m15:24:19.076185 [debug] [MainThread]: Flushing usage events
[0m15:24:19.814716 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:24:21.571289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA73380610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA733813D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA73381D90>]}


============================== 15:24:21.575290 | d143d3b7-53f5-42a5-bda7-50a7552ef4c9 ==============================
[0m15:24:21.575290 [info ] [MainThread]: Running with dbt=1.10.15
[0m15:24:21.576291 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'no_print': 'None', 'log_format': 'default', 'printer_width': '80', 'invocation_command': 'dbt docs serve --profiles-dir . --no-partial-parse', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\alexm\\Desktop\\python\\azure-taxi-platform\\dbt_project\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m15:24:21.886484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd143d3b7-53f5-42a5-bda7-50a7552ef4c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA723B3910>]}
[0m15:24:21.930530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd143d3b7-53f5-42a5-bda7-50a7552ef4c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA72379510>]}
[0m15:27:24.136305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C50D3F2A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C50D3F2A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C50D3F06D0>]}


============================== 15:27:24.139305 | e0899c14-f1c0-47f5-b01a-d1450ebf50ca ==============================
[0m15:27:24.139305 [info ] [MainThread]: Running with dbt=1.10.15
[0m15:27:24.140312 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'warn_error': 'None', 'log_path': 'C:\\Users\\alexm\\Desktop\\python\\azure-taxi-platform\\dbt_project\\logs', 'partial_parse': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': '.', 'invocation_command': 'dbt test --profiles-dir . --no-partial-parse', 'printer_width': '80', 'write_json': 'True'}
[0m15:27:24.479437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e0899c14-f1c0-47f5-b01a-d1450ebf50ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C50EC4CA90>]}
[0m15:27:24.529147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e0899c14-f1c0-47f5-b01a-d1450ebf50ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C50C3B55D0>]}
[0m15:27:24.530147 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m15:27:24.754973 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m15:27:24.755980 [debug] [MainThread]: Partial parsing not enabled
[0m15:27:25.773798 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m15:27:25.774317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e0899c14-f1c0-47f5-b01a-d1450ebf50ca', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C50F211890>]}
[0m15:27:25.871821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e0899c14-f1c0-47f5-b01a-d1450ebf50ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C50F319610>]}
[0m15:27:25.935466 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\manifest.json
[0m15:27:25.937457 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\semantic_manifest.json
[0m15:27:25.966344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e0899c14-f1c0-47f5-b01a-d1450ebf50ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C50F5AF5D0>]}
[0m15:27:25.967332 [info ] [MainThread]: Found 8 models, 16 data tests, 535 macros
[0m15:27:25.967332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0899c14-f1c0-47f5-b01a-d1450ebf50ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C50F15DCD0>]}
[0m15:27:25.969343 [info ] [MainThread]: 
[0m15:27:25.970338 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:27:25.970338 [info ] [MainThread]: 
[0m15:27:25.971332 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m15:27:25.976339 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_sqldb-taxi-platform_bronze_silver'
[0m15:27:25.988348 [debug] [ThreadPool]: dbt-sqlserver
[0m15:27:25.988865 [debug] [ThreadPool]: Using sqlserver connection "list_sqldb-taxi-platform_bronze_silver"
[0m15:27:25.988865 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "list_sqldb-taxi-platform_bronze_silver"} */
USE [sqldb-taxi-platform];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze_silver'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m15:27:25.989864 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:27:25.989864 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:27:26.589617 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:27:26.638730 [debug] [ThreadPool]: SQL status: OK in 1.000 seconds
[0m15:27:26.639754 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_silver: ROLLBACK
[0m15:27:26.639754 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_silver: Close
[0m15:27:26.640739 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sqldb-taxi-platform_bronze_silver, now list_sqldb-taxi-platform_bronze_gold)
[0m15:27:26.643676 [debug] [ThreadPool]: dbt-sqlserver
[0m15:27:26.643676 [debug] [ThreadPool]: Using sqlserver connection "list_sqldb-taxi-platform_bronze_gold"
[0m15:27:26.644676 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_gold: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "list_sqldb-taxi-platform_bronze_gold"} */
USE [sqldb-taxi-platform];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze_gold'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m15:27:26.644676 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:27:26.644676 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:27:26.645684 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:27:26.692670 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:27:26.694182 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_gold: ROLLBACK
[0m15:27:26.694182 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_gold: Close
[0m15:27:26.694182 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sqldb-taxi-platform_bronze_gold, now list_sqldb-taxi-platform_bronze_bronze)
[0m15:27:26.696979 [debug] [ThreadPool]: dbt-sqlserver
[0m15:27:26.697978 [debug] [ThreadPool]: Using sqlserver connection "list_sqldb-taxi-platform_bronze_bronze"
[0m15:27:26.697978 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "list_sqldb-taxi-platform_bronze_bronze"} */
USE [sqldb-taxi-platform];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze_bronze'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m15:27:26.697978 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:27:26.698978 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:27:26.698978 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:27:26.746856 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:27:26.748839 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_bronze: ROLLBACK
[0m15:27:26.748839 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_bronze: Close
[0m15:27:26.749790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0899c14-f1c0-47f5-b01a-d1450ebf50ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C50F55B210>]}
[0m15:27:26.749790 [debug] [MainThread]: On master: COMMIT
[0m15:27:26.753778 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec
[0m15:27:26.754787 [info ] [Thread-1 (]: 1 of 16 START test accepted_values_stg_trips_payment_type__1__2__3__4__5__6 .... [RUN]
[0m15:27:26.754787 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec'
[0m15:27:26.755785 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec
[0m15:27:26.761784 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec"
[0m15:27:26.762785 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec
[0m15:27:26.779865 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec"
[0m15:27:26.780864 [debug] [Thread-1 (]: Using sqlserver connection "test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec"
[0m15:27:26.780864 [debug] [Thread-1 (]: On test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec"} */

    -- Create target schema if it does not
  USE [sqldb-taxi-platform];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'bronze')
  BEGIN
    EXEC('CREATE SCHEMA [bronze]')
  END

  

  
  EXEC('create view 
    [bronze].[testview_f33210bcd4b055fe9687c095053b88a1_16668]
   as 
    
    
    

with all_values as (

    select
        payment_type as value_field,
        count(*) as n_records

    from "sqldb-taxi-platform"."bronze_bronze"."stg_trips"
    group by payment_type

)

select *
from all_values
where value_field not in (
    ''1'',''2'',''3'',''4'',''5'',''6''
)



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [bronze].[testview_f33210bcd4b055fe9687c095053b88a1_16668]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [bronze].[testview_f33210bcd4b055fe9687c095053b88a1_16668]
  ;')
[0m15:27:26.781859 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:27:26.781859 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:27:26.782858 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:27:26.841890 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:27:26.844881 [debug] [Thread-1 (]: On test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec: ROLLBACK
[0m15:27:26.845887 [debug] [Thread-1 (]: On test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec: Close
[0m15:27:26.845887 [info ] [Thread-1 (]: 1 of 16 PASS accepted_values_stg_trips_payment_type__1__2__3__4__5__6 .......... [[32mPASS[0m in 0.09s]
[0m15:27:26.846906 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec
[0m15:27:26.846906 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d
[0m15:27:26.847984 [info ] [Thread-1 (]: 2 of 16 START test accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99 ... [RUN]
[0m15:27:26.847984 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec, now test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d)
[0m15:27:26.848979 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d
[0m15:27:26.909495 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d"
[0m15:27:26.910495 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d
[0m15:27:26.912495 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d"
[0m15:27:26.913495 [debug] [Thread-1 (]: Using sqlserver connection "test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d"
[0m15:27:26.913495 [debug] [Thread-1 (]: On test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d"} */

    -- Create target schema if it does not
  USE [sqldb-taxi-platform];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'bronze')
  BEGIN
    EXEC('CREATE SCHEMA [bronze]')
  END

  

  
  EXEC('create view 
    [bronze].[testview_4dded7e06fdf8cf96858af6f2dabdb0d_18920]
   as 
    
    
    

with all_values as (

    select
        rate_code_id as value_field,
        count(*) as n_records

    from "sqldb-taxi-platform"."bronze_bronze"."stg_trips"
    group by rate_code_id

)

select *
from all_values
where value_field not in (
    ''1'',''2'',''3'',''4'',''5'',''99''
)



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [bronze].[testview_4dded7e06fdf8cf96858af6f2dabdb0d_18920]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [bronze].[testview_4dded7e06fdf8cf96858af6f2dabdb0d_18920]
  ;')
[0m15:27:26.914495 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:27:26.914495 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:27:26.915574 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:27:26.973552 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:27:26.976547 [debug] [Thread-1 (]: On test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d: ROLLBACK
[0m15:27:26.976547 [debug] [Thread-1 (]: On test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d: Close
[0m15:27:26.977546 [info ] [Thread-1 (]: 2 of 16 PASS accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99 ......... [[32mPASS[0m in 0.13s]
[0m15:27:26.977546 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d
[0m15:27:26.978546 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_dim_date_date_key.881d0a31b6
[0m15:27:26.978546 [info ] [Thread-1 (]: 3 of 16 START test not_null_dim_date_date_key .................................. [RUN]
[0m15:27:26.979548 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d, now test.taxi_nyc_project.not_null_dim_date_date_key.881d0a31b6)
[0m15:27:26.979548 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_dim_date_date_key.881d0a31b6
[0m15:27:26.985547 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_dim_date_date_key.881d0a31b6"
[0m15:27:26.986547 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_dim_date_date_key.881d0a31b6
[0m15:27:26.989546 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_nyc_project.not_null_dim_date_date_key.881d0a31b6"
[0m15:27:26.990545 [debug] [Thread-1 (]: Using sqlserver connection "test.taxi_nyc_project.not_null_dim_date_date_key.881d0a31b6"
[0m15:27:26.990545 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_dim_date_date_key.881d0a31b6: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "test.taxi_nyc_project.not_null_dim_date_date_key.881d0a31b6"} */

    -- Create target schema if it does not
  USE [sqldb-taxi-platform];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'bronze')
  BEGIN
    EXEC('CREATE SCHEMA [bronze]')
  END

  

  
  EXEC('create view 
    [bronze].[testview_97a1514f1de409d55b5193a479b57439_15908]
   as 
    
    
    



select date_key
from "sqldb-taxi-platform"."bronze_silver"."dim_date"
where date_key is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [bronze].[testview_97a1514f1de409d55b5193a479b57439_15908]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [bronze].[testview_97a1514f1de409d55b5193a479b57439_15908]
  ;')
[0m15:27:26.991546 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:27:26.992549 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:27:26.992549 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:27:27.054927 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:27:27.055927 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_dim_date_date_key.881d0a31b6: ROLLBACK
[0m15:27:27.056935 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_dim_date_date_key.881d0a31b6: Close
[0m15:27:27.056935 [info ] [Thread-1 (]: 3 of 16 PASS not_null_dim_date_date_key ........................................ [[32mPASS[0m in 0.08s]
[0m15:27:27.057940 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_dim_date_date_key.881d0a31b6
[0m15:27:27.057940 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626
[0m15:27:27.058927 [info ] [Thread-1 (]: 4 of 16 START test not_null_dim_payment_type_payment_type ...................... [RUN]
[0m15:27:27.058927 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_dim_date_date_key.881d0a31b6, now test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626)
[0m15:27:27.059926 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626
[0m15:27:27.062933 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626"
[0m15:27:27.063932 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626
[0m15:27:27.066758 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626"
[0m15:27:27.068746 [debug] [Thread-1 (]: Using sqlserver connection "test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626"
[0m15:27:27.068746 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626"} */

    -- Create target schema if it does not
  USE [sqldb-taxi-platform];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'bronze')
  BEGIN
    EXEC('CREATE SCHEMA [bronze]')
  END

  

  
  EXEC('create view 
    [bronze].[testview_2ad2dc6a1d72454bc6f07cc7701e665e_18054]
   as 
    
    
    



select payment_type
from "sqldb-taxi-platform"."bronze_silver"."dim_payment_type"
where payment_type is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [bronze].[testview_2ad2dc6a1d72454bc6f07cc7701e665e_18054]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [bronze].[testview_2ad2dc6a1d72454bc6f07cc7701e665e_18054]
  ;')
[0m15:27:27.068746 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:27:27.069757 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:27:27.069757 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:27:27.125333 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:27:27.127339 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626: ROLLBACK
[0m15:27:27.127339 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626: Close
[0m15:27:27.128344 [info ] [Thread-1 (]: 4 of 16 PASS not_null_dim_payment_type_payment_type ............................ [[32mPASS[0m in 0.07s]
[0m15:27:27.129352 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626
[0m15:27:27.129352 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c
[0m15:27:27.129352 [info ] [Thread-1 (]: 5 of 16 START test not_null_fact_trips_pickup_date ............................. [RUN]
[0m15:27:27.130347 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626, now test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c)
[0m15:27:27.130347 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c
[0m15:27:27.135342 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c"
[0m15:27:27.136333 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c
[0m15:27:27.138339 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c"
[0m15:27:27.139333 [debug] [Thread-1 (]: Using sqlserver connection "test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c"
[0m15:27:27.139333 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c"} */

    -- Create target schema if it does not
  USE [sqldb-taxi-platform];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'bronze')
  BEGIN
    EXEC('CREATE SCHEMA [bronze]')
  END

  

  
  EXEC('create view 
    [bronze].[testview_7d112b4bacf9180b503a254961208261_5002]
   as 
    
    
    



select pickup_date
from "sqldb-taxi-platform"."bronze_silver"."fact_trips"
where pickup_date is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [bronze].[testview_7d112b4bacf9180b503a254961208261_5002]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [bronze].[testview_7d112b4bacf9180b503a254961208261_5002]
  ;')
[0m15:27:27.140332 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:27:27.140332 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:27:27.140332 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:27:27.197705 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:27:27.199719 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c: ROLLBACK
[0m15:27:27.199719 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c: Close
[0m15:27:27.200711 [info ] [Thread-1 (]: 5 of 16 PASS not_null_fact_trips_pickup_date ................................... [[32mPASS[0m in 0.07s]
[0m15:27:27.201711 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c
[0m15:27:27.201711 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442
[0m15:27:27.202710 [info ] [Thread-1 (]: 6 of 16 START test not_null_fact_trips_trip_id ................................. [RUN]
[0m15:27:27.202710 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c, now test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442)
[0m15:27:27.203710 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442
[0m15:27:27.207724 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442"
[0m15:27:27.208724 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442
[0m15:27:27.211724 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442"
[0m15:27:27.212724 [debug] [Thread-1 (]: Using sqlserver connection "test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442"
[0m15:27:27.213718 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442"} */

    -- Create target schema if it does not
  USE [sqldb-taxi-platform];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'bronze')
  BEGIN
    EXEC('CREATE SCHEMA [bronze]')
  END

  

  
  EXEC('create view 
    [bronze].[testview_20905412c48dcf3bfd76540d3b87984e_11724]
   as 
    
    
    



select trip_id
from "sqldb-taxi-platform"."bronze_silver"."fact_trips"
where trip_id is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [bronze].[testview_20905412c48dcf3bfd76540d3b87984e_11724]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [bronze].[testview_20905412c48dcf3bfd76540d3b87984e_11724]
  ;')
[0m15:27:27.213718 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:27:27.213718 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:27:27.214719 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:27:27.270486 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:27:27.271488 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442: ROLLBACK
[0m15:27:27.272488 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442: Close
[0m15:27:27.273488 [info ] [Thread-1 (]: 6 of 16 PASS not_null_fact_trips_trip_id ....................................... [[32mPASS[0m in 0.07s]
[0m15:27:27.273488 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442
[0m15:27:27.274487 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b
[0m15:27:27.274487 [info ] [Thread-1 (]: 7 of 16 START test not_null_stg_trips_dropoff_datetime ......................... [RUN]
[0m15:27:27.274487 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442, now test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b)
[0m15:27:27.275487 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b
[0m15:27:27.279488 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b"
[0m15:27:27.279488 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b
[0m15:27:27.282487 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b"
[0m15:27:27.282487 [debug] [Thread-1 (]: Using sqlserver connection "test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b"
[0m15:27:27.283487 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b"} */

    -- Create target schema if it does not
  USE [sqldb-taxi-platform];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'bronze')
  BEGIN
    EXEC('CREATE SCHEMA [bronze]')
  END

  

  
  EXEC('create view 
    [bronze].[testview_4c8d3f315598f1637f069cf3074df17a_17251]
   as 
    
    
    



select dropoff_datetime
from "sqldb-taxi-platform"."bronze_bronze"."stg_trips"
where dropoff_datetime is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [bronze].[testview_4c8d3f315598f1637f069cf3074df17a_17251]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [bronze].[testview_4c8d3f315598f1637f069cf3074df17a_17251]
  ;')
[0m15:27:27.283487 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:27:27.284487 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:27:27.284487 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:27:27.340004 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:27:27.342006 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b: ROLLBACK
[0m15:27:27.342006 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b: Close
[0m15:27:27.343004 [info ] [Thread-1 (]: 7 of 16 PASS not_null_stg_trips_dropoff_datetime ............................... [[32mPASS[0m in 0.07s]
[0m15:27:27.343535 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b
[0m15:27:27.343535 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74
[0m15:27:27.344517 [info ] [Thread-1 (]: 8 of 16 START test not_null_stg_trips_fare_amount .............................. [RUN]
[0m15:27:27.344517 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b, now test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74)
[0m15:27:27.345517 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74
[0m15:27:27.348518 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74"
[0m15:27:27.349517 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74
[0m15:27:27.351517 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74"
[0m15:27:27.352517 [debug] [Thread-1 (]: Using sqlserver connection "test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74"
[0m15:27:27.353517 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74"} */

    -- Create target schema if it does not
  USE [sqldb-taxi-platform];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'bronze')
  BEGIN
    EXEC('CREATE SCHEMA [bronze]')
  END

  

  
  EXEC('create view 
    [bronze].[testview_9ea19f17f3a1a85ec021164b6969d1d9_9352]
   as 
    
    
    



select fare_amount
from "sqldb-taxi-platform"."bronze_bronze"."stg_trips"
where fare_amount is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [bronze].[testview_9ea19f17f3a1a85ec021164b6969d1d9_9352]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [bronze].[testview_9ea19f17f3a1a85ec021164b6969d1d9_9352]
  ;')
[0m15:27:27.353517 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:27:27.353517 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:27:27.354517 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:27:27.410484 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:27:27.411492 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74: ROLLBACK
[0m15:27:27.412488 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74: Close
[0m15:27:27.412488 [info ] [Thread-1 (]: 8 of 16 PASS not_null_stg_trips_fare_amount .................................... [[32mPASS[0m in 0.07s]
[0m15:27:27.413483 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74
[0m15:27:27.413483 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c
[0m15:27:27.414483 [info ] [Thread-1 (]: 9 of 16 START test not_null_stg_trips_pickup_datetime .......................... [RUN]
[0m15:27:27.414483 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74, now test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c)
[0m15:27:27.415499 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c
[0m15:27:27.418516 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c"
[0m15:27:27.419511 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c
[0m15:27:27.421506 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c"
[0m15:27:27.422508 [debug] [Thread-1 (]: Using sqlserver connection "test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c"
[0m15:27:27.423507 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c"} */

    -- Create target schema if it does not
  USE [sqldb-taxi-platform];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'bronze')
  BEGIN
    EXEC('CREATE SCHEMA [bronze]')
  END

  

  
  EXEC('create view 
    [bronze].[testview_c8f1217ea7ae423f95431cf67128255c_2831]
   as 
    
    
    



select pickup_datetime
from "sqldb-taxi-platform"."bronze_bronze"."stg_trips"
where pickup_datetime is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [bronze].[testview_c8f1217ea7ae423f95431cf67128255c_2831]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [bronze].[testview_c8f1217ea7ae423f95431cf67128255c_2831]
  ;')
[0m15:27:27.423507 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:27:27.423507 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:27:27.424518 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:27:27.480151 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:27:27.482147 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c: ROLLBACK
[0m15:27:27.483143 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c: Close
[0m15:27:27.483143 [info ] [Thread-1 (]: 9 of 16 PASS not_null_stg_trips_pickup_datetime ................................ [[32mPASS[0m in 0.07s]
[0m15:27:27.484145 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c
[0m15:27:27.484145 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae
[0m15:27:27.485144 [info ] [Thread-1 (]: 10 of 16 START test not_null_stg_trips_total_amount ............................ [RUN]
[0m15:27:27.485144 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c, now test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae)
[0m15:27:27.486145 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae
[0m15:27:27.490145 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae"
[0m15:27:27.491143 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae
[0m15:27:27.493152 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae"
[0m15:27:27.494143 [debug] [Thread-1 (]: Using sqlserver connection "test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae"
[0m15:27:27.494143 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae"} */

    -- Create target schema if it does not
  USE [sqldb-taxi-platform];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'bronze')
  BEGIN
    EXEC('CREATE SCHEMA [bronze]')
  END

  

  
  EXEC('create view 
    [bronze].[testview_83c247fd7dcf1f459750c2de25501c63_15359]
   as 
    
    
    



select total_amount
from "sqldb-taxi-platform"."bronze_bronze"."stg_trips"
where total_amount is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [bronze].[testview_83c247fd7dcf1f459750c2de25501c63_15359]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [bronze].[testview_83c247fd7dcf1f459750c2de25501c63_15359]
  ;')
[0m15:27:27.495144 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:27:27.495144 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:27:27.496144 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:27:27.551975 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:27:27.553975 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae: ROLLBACK
[0m15:27:27.553975 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae: Close
[0m15:27:27.554976 [info ] [Thread-1 (]: 10 of 16 PASS not_null_stg_trips_total_amount .................................. [[32mPASS[0m in 0.07s]
[0m15:27:27.554976 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae
[0m15:27:27.555975 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b
[0m15:27:27.555975 [info ] [Thread-1 (]: 11 of 16 START test not_null_stg_trips_trip_distance ........................... [RUN]
[0m15:27:27.556976 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae, now test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b)
[0m15:27:27.556976 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b
[0m15:27:27.560974 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b"
[0m15:27:27.561974 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b
[0m15:27:27.564975 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b"
[0m15:27:27.565984 [debug] [Thread-1 (]: Using sqlserver connection "test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b"
[0m15:27:27.566976 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b"} */

    -- Create target schema if it does not
  USE [sqldb-taxi-platform];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'bronze')
  BEGIN
    EXEC('CREATE SCHEMA [bronze]')
  END

  

  
  EXEC('create view 
    [bronze].[testview_98902cdd2f59126a71dede1190f25913_5267]
   as 
    
    
    



select trip_distance
from "sqldb-taxi-platform"."bronze_bronze"."stg_trips"
where trip_distance is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [bronze].[testview_98902cdd2f59126a71dede1190f25913_5267]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [bronze].[testview_98902cdd2f59126a71dede1190f25913_5267]
  ;')
[0m15:27:27.566976 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:27:27.567976 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:27:27.567976 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:27:27.623782 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:27:27.624782 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b: ROLLBACK
[0m15:27:27.625782 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b: Close
[0m15:27:27.625782 [info ] [Thread-1 (]: 11 of 16 PASS not_null_stg_trips_trip_distance ................................. [[32mPASS[0m in 0.07s]
[0m15:27:27.626781 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b
[0m15:27:27.626781 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6
[0m15:27:27.627782 [info ] [Thread-1 (]: 12 of 16 START test relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_  [RUN]
[0m15:27:27.628782 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b, now test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6)
[0m15:27:27.628782 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6
[0m15:27:27.633319 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6"
[0m15:27:27.634296 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6
[0m15:27:27.637298 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6"
[0m15:27:27.638297 [debug] [Thread-1 (]: Using sqlserver connection "test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6"
[0m15:27:27.639296 [debug] [Thread-1 (]: On test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6"} */

    -- Create target schema if it does not
  USE [sqldb-taxi-platform];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'bronze')
  BEGIN
    EXEC('CREATE SCHEMA [bronze]')
  END

  

  
  EXEC('create view 
    [bronze].[testview_fe69b692e4963f1fa2cf4dd07e39b696_1555]
   as 
    
    
    

with child as (
    select payment_type as from_field
    from "sqldb-taxi-platform"."bronze_silver"."fact_trips"
    where payment_type is not null
),

parent as (
    select payment_type as to_field
    from "sqldb-taxi-platform"."bronze_silver"."dim_payment_type"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [bronze].[testview_fe69b692e4963f1fa2cf4dd07e39b696_1555]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [bronze].[testview_fe69b692e4963f1fa2cf4dd07e39b696_1555]
  ;')
[0m15:27:27.639296 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:27:27.639296 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:27:27.640296 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:27:27.700511 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:27:27.701511 [debug] [Thread-1 (]: On test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6: ROLLBACK
[0m15:27:27.702518 [debug] [Thread-1 (]: On test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6: Close
[0m15:27:27.703513 [info ] [Thread-1 (]: 12 of 16 PASS relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_  [[32mPASS[0m in 0.07s]
[0m15:27:27.703513 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6
[0m15:27:27.704512 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.relationships_fact_trips_pickup_date__date_key__ref_dim_date_.ed5309b1a6
[0m15:27:27.704512 [info ] [Thread-1 (]: 13 of 16 START test relationships_fact_trips_pickup_date__date_key__ref_dim_date_  [RUN]
[0m15:27:27.705512 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6, now test.taxi_nyc_project.relationships_fact_trips_pickup_date__date_key__ref_dim_date_.ed5309b1a6)
[0m15:27:27.705512 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.relationships_fact_trips_pickup_date__date_key__ref_dim_date_.ed5309b1a6
[0m15:27:27.709511 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.relationships_fact_trips_pickup_date__date_key__ref_dim_date_.ed5309b1a6"
[0m15:27:27.710513 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.relationships_fact_trips_pickup_date__date_key__ref_dim_date_.ed5309b1a6
[0m15:27:27.712511 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_nyc_project.relationships_fact_trips_pickup_date__date_key__ref_dim_date_.ed5309b1a6"
[0m15:27:27.713512 [debug] [Thread-1 (]: Using sqlserver connection "test.taxi_nyc_project.relationships_fact_trips_pickup_date__date_key__ref_dim_date_.ed5309b1a6"
[0m15:27:27.714511 [debug] [Thread-1 (]: On test.taxi_nyc_project.relationships_fact_trips_pickup_date__date_key__ref_dim_date_.ed5309b1a6: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "test.taxi_nyc_project.relationships_fact_trips_pickup_date__date_key__ref_dim_date_.ed5309b1a6"} */

    -- Create target schema if it does not
  USE [sqldb-taxi-platform];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'bronze')
  BEGIN
    EXEC('CREATE SCHEMA [bronze]')
  END

  

  
  EXEC('create view 
    [bronze].[testview_b629aa227657300b15c0f9be86057eab_16672]
   as 
    
    
    

with child as (
    select pickup_date as from_field
    from "sqldb-taxi-platform"."bronze_silver"."fact_trips"
    where pickup_date is not null
),

parent as (
    select date_key as to_field
    from "sqldb-taxi-platform"."bronze_silver"."dim_date"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [bronze].[testview_b629aa227657300b15c0f9be86057eab_16672]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [bronze].[testview_b629aa227657300b15c0f9be86057eab_16672]
  ;')
[0m15:27:27.714511 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:27:27.715513 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:27:27.715513 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:27:27.780423 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:27:27.782987 [debug] [Thread-1 (]: On test.taxi_nyc_project.relationships_fact_trips_pickup_date__date_key__ref_dim_date_.ed5309b1a6: ROLLBACK
[0m15:27:27.783526 [debug] [Thread-1 (]: On test.taxi_nyc_project.relationships_fact_trips_pickup_date__date_key__ref_dim_date_.ed5309b1a6: Close
[0m15:27:27.783526 [error] [Thread-1 (]: 13 of 16 FAIL 486063 relationships_fact_trips_pickup_date__date_key__ref_dim_date_  [[31mFAIL 486063[0m in 0.08s]
[0m15:27:27.784521 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.relationships_fact_trips_pickup_date__date_key__ref_dim_date_.ed5309b1a6
[0m15:27:27.784521 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.unique_dim_date_date_key.0869fd48f9
[0m15:27:27.785522 [info ] [Thread-1 (]: 14 of 16 START test unique_dim_date_date_key ................................... [RUN]
[0m15:27:27.785522 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.relationships_fact_trips_pickup_date__date_key__ref_dim_date_.ed5309b1a6, now test.taxi_nyc_project.unique_dim_date_date_key.0869fd48f9)
[0m15:27:27.786521 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.unique_dim_date_date_key.0869fd48f9
[0m15:27:27.791520 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.unique_dim_date_date_key.0869fd48f9"
[0m15:27:27.792520 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.unique_dim_date_date_key.0869fd48f9
[0m15:27:27.794520 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_nyc_project.unique_dim_date_date_key.0869fd48f9"
[0m15:27:27.795520 [debug] [Thread-1 (]: Using sqlserver connection "test.taxi_nyc_project.unique_dim_date_date_key.0869fd48f9"
[0m15:27:27.795520 [debug] [Thread-1 (]: On test.taxi_nyc_project.unique_dim_date_date_key.0869fd48f9: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "test.taxi_nyc_project.unique_dim_date_date_key.0869fd48f9"} */

    -- Create target schema if it does not
  USE [sqldb-taxi-platform];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'bronze')
  BEGIN
    EXEC('CREATE SCHEMA [bronze]')
  END

  

  
  EXEC('create view 
    [bronze].[testview_a400e2b5a883a058e35f384156d65f3b_10322]
   as 
    
    
    

select
    date_key as unique_field,
    count(*) as n_records

from "sqldb-taxi-platform"."bronze_silver"."dim_date"
where date_key is not null
group by date_key
having count(*) > 1



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [bronze].[testview_a400e2b5a883a058e35f384156d65f3b_10322]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [bronze].[testview_a400e2b5a883a058e35f384156d65f3b_10322]
  ;')
[0m15:27:27.796513 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:27:27.796513 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:27:27.796513 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:27:27.855659 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:27:27.856660 [debug] [Thread-1 (]: On test.taxi_nyc_project.unique_dim_date_date_key.0869fd48f9: ROLLBACK
[0m15:27:27.857660 [debug] [Thread-1 (]: On test.taxi_nyc_project.unique_dim_date_date_key.0869fd48f9: Close
[0m15:27:27.857660 [info ] [Thread-1 (]: 14 of 16 PASS unique_dim_date_date_key ......................................... [[32mPASS[0m in 0.07s]
[0m15:27:27.858659 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.unique_dim_date_date_key.0869fd48f9
[0m15:27:27.859660 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58
[0m15:27:27.859660 [info ] [Thread-1 (]: 15 of 16 START test unique_dim_payment_type_payment_type ....................... [RUN]
[0m15:27:27.859660 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.unique_dim_date_date_key.0869fd48f9, now test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58)
[0m15:27:27.860681 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58
[0m15:27:27.864199 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58"
[0m15:27:27.865192 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58
[0m15:27:27.867993 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58"
[0m15:27:27.868983 [debug] [Thread-1 (]: Using sqlserver connection "test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58"
[0m15:27:27.868983 [debug] [Thread-1 (]: On test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58"} */

    -- Create target schema if it does not
  USE [sqldb-taxi-platform];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'bronze')
  BEGIN
    EXEC('CREATE SCHEMA [bronze]')
  END

  

  
  EXEC('create view 
    [bronze].[testview_5fb5eb828135bf31fab7f64ef24093d1_17006]
   as 
    
    
    

select
    payment_type as unique_field,
    count(*) as n_records

from "sqldb-taxi-platform"."bronze_silver"."dim_payment_type"
where payment_type is not null
group by payment_type
having count(*) > 1



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [bronze].[testview_5fb5eb828135bf31fab7f64ef24093d1_17006]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [bronze].[testview_5fb5eb828135bf31fab7f64ef24093d1_17006]
  ;')
[0m15:27:27.869983 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:27:27.869983 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:27:27.870982 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:27:27.927347 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:27:27.928355 [debug] [Thread-1 (]: On test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58: ROLLBACK
[0m15:27:27.929354 [debug] [Thread-1 (]: On test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58: Close
[0m15:27:27.929354 [info ] [Thread-1 (]: 15 of 16 PASS unique_dim_payment_type_payment_type ............................. [[32mPASS[0m in 0.07s]
[0m15:27:27.930357 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58
[0m15:27:27.930357 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e
[0m15:27:27.931347 [info ] [Thread-1 (]: 16 of 16 START test unique_fact_trips_trip_id .................................. [RUN]
[0m15:27:27.932348 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58, now test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e)
[0m15:27:27.932348 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e
[0m15:27:27.936354 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e"
[0m15:27:27.936354 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e
[0m15:27:27.939941 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e"
[0m15:27:27.940933 [debug] [Thread-1 (]: Using sqlserver connection "test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e"
[0m15:27:27.941933 [debug] [Thread-1 (]: On test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e"} */

    -- Create target schema if it does not
  USE [sqldb-taxi-platform];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'bronze')
  BEGIN
    EXEC('CREATE SCHEMA [bronze]')
  END

  

  
  EXEC('create view 
    [bronze].[testview_2a9748c0e241ec04f816d7766bd33ba6_18859]
   as 
    
    
    

select
    trip_id as unique_field,
    count(*) as n_records

from "sqldb-taxi-platform"."bronze_silver"."fact_trips"
where trip_id is not null
group by trip_id
having count(*) > 1



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [bronze].[testview_2a9748c0e241ec04f816d7766bd33ba6_18859]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [bronze].[testview_2a9748c0e241ec04f816d7766bd33ba6_18859]
  ;')
[0m15:27:27.941933 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:27:27.941933 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:27:27.942941 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:27:28.075037 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:27:28.076054 [debug] [Thread-1 (]: On test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e: ROLLBACK
[0m15:27:28.077054 [debug] [Thread-1 (]: On test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e: Close
[0m15:27:28.077054 [info ] [Thread-1 (]: 16 of 16 PASS unique_fact_trips_trip_id ........................................ [[32mPASS[0m in 0.15s]
[0m15:27:28.078628 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e
[0m15:27:28.079625 [debug] [MainThread]: On master: COMMIT
[0m15:27:28.079625 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:27:28.079625 [debug] [MainThread]: Connection 'list_sqldb-taxi-platform_bronze_bronze' was properly closed.
[0m15:27:28.080626 [debug] [MainThread]: Connection 'test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e' was properly closed.
[0m15:27:28.080626 [info ] [MainThread]: 
[0m15:27:28.081626 [info ] [MainThread]: Finished running 16 data tests in 0 hours 0 minutes and 2.11 seconds (2.11s).
[0m15:27:28.083633 [debug] [MainThread]: Command end result
[0m15:27:28.109276 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\manifest.json
[0m15:27:28.112089 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\semantic_manifest.json
[0m15:27:28.118082 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\run_results.json
[0m15:27:28.118082 [info ] [MainThread]: 
[0m15:27:28.119082 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:27:28.119082 [info ] [MainThread]: 
[0m15:27:28.120498 [error] [MainThread]: [31mFailure in test relationships_fact_trips_pickup_date__date_key__ref_dim_date_ (models\schema.yml)[0m
[0m15:27:28.120498 [error] [MainThread]:   Got 486063 results, configured to fail if != 0
[0m15:27:28.121502 [info ] [MainThread]: 
[0m15:27:28.121502 [info ] [MainThread]:   compiled code at target\compiled\taxi_nyc_project\models\schema.yml\relationships_fact_trips_pickup_date__date_key__ref_dim_date_.sql
[0m15:27:28.122492 [info ] [MainThread]: 
[0m15:27:28.122492 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=16
[0m15:27:28.123493 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 4 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:27:28.124492 [debug] [MainThread]: Command `dbt test` failed at 15:27:28.123493 after 4.05 seconds
[0m15:27:28.124539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C50D071490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C50F2DD290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C50C38D590>]}
[0m15:27:28.125053 [debug] [MainThread]: Flushing usage events
[0m15:27:28.902238 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:36:56.200459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023576D12910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023576D612D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023576D12050>]}


============================== 15:36:56.204006 | 7192791d-9305-49af-8f2e-3959dfabfd5f ==============================
[0m15:36:56.204006 [info ] [MainThread]: Running with dbt=1.10.15
[0m15:36:56.205004 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'log_format': 'default', 'cache_selected_only': 'False', 'invocation_command': 'dbt run --profiles-dir . --no-partial-parse', 'target_path': 'None', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\alexm\\Desktop\\python\\azure-taxi-platform\\dbt_project\\logs', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m15:36:56.520446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7192791d-9305-49af-8f2e-3959dfabfd5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023576D11990>]}
[0m15:36:56.564446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7192791d-9305-49af-8f2e-3959dfabfd5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023575D19490>]}
[0m15:36:56.564446 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m15:36:56.783462 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m15:36:56.783462 [debug] [MainThread]: Partial parsing not enabled
[0m15:36:57.749496 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m15:36:57.750496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7192791d-9305-49af-8f2e-3959dfabfd5f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023578BA8610>]}
[0m15:36:57.840496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7192791d-9305-49af-8f2e-3959dfabfd5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235789B21D0>]}
[0m15:36:57.898999 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\manifest.json
[0m15:36:57.901000 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\semantic_manifest.json
[0m15:36:57.921000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7192791d-9305-49af-8f2e-3959dfabfd5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023578DC4790>]}
[0m15:36:57.922017 [info ] [MainThread]: Found 7 models, 13 data tests, 535 macros
[0m15:36:57.923002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7192791d-9305-49af-8f2e-3959dfabfd5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023578A0DF10>]}
[0m15:36:57.924001 [info ] [MainThread]: 
[0m15:36:57.925000 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:36:57.925000 [info ] [MainThread]: 
[0m15:36:57.926000 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m15:36:57.931000 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_sqldb-taxi-platform'
[0m15:36:57.942000 [debug] [ThreadPool]: dbt-sqlserver
[0m15:36:57.943010 [debug] [ThreadPool]: Using sqlserver connection "list_sqldb-taxi-platform"
[0m15:36:57.943010 [debug] [ThreadPool]: On list_sqldb-taxi-platform: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "list_sqldb-taxi-platform"} */
USE [sqldb-taxi-platform];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m15:36:57.944007 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:36:57.944007 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:36:58.583202 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:36:58.632394 [debug] [ThreadPool]: SQL status: OK in 1.000 seconds
[0m15:36:58.633382 [debug] [ThreadPool]: On list_sqldb-taxi-platform: Close
[0m15:36:58.636383 [debug] [ThreadPool]: dbt-sqlserver
[0m15:36:58.636383 [debug] [ThreadPool]: Using sqlserver connection "list_sqldb-taxi-platform"
[0m15:36:58.637386 [debug] [ThreadPool]: On list_sqldb-taxi-platform: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "list_sqldb-taxi-platform"} */
USE [sqldb-taxi-platform];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m15:36:58.637386 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:36:58.637386 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:36:58.638377 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:36:58.687418 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:36:58.688430 [debug] [ThreadPool]: On list_sqldb-taxi-platform: Close
[0m15:36:58.691431 [debug] [ThreadPool]: dbt-sqlserver
[0m15:36:58.691883 [debug] [ThreadPool]: Using sqlserver connection "list_sqldb-taxi-platform"
[0m15:36:58.691883 [debug] [ThreadPool]: On list_sqldb-taxi-platform: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "list_sqldb-taxi-platform"} */
USE [sqldb-taxi-platform];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m15:36:58.691883 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:36:58.692888 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:36:58.692888 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:36:58.742705 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:36:58.743644 [debug] [ThreadPool]: On list_sqldb-taxi-platform: Close
[0m15:36:58.745636 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_sqldb-taxi-platform_bronze_gold'
[0m15:36:58.750641 [debug] [ThreadPool]: dbt-sqlserver
[0m15:36:58.750641 [debug] [ThreadPool]: Using sqlserver connection "list_sqldb-taxi-platform_bronze_gold"
[0m15:36:58.750641 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_gold: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "list_sqldb-taxi-platform_bronze_gold"} */
USE [sqldb-taxi-platform];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze_gold'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m15:36:58.751635 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:36:58.751635 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:36:58.752644 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:36:58.805230 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:36:58.806229 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_gold: ROLLBACK
[0m15:36:58.807238 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_gold: Close
[0m15:36:58.807238 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sqldb-taxi-platform_bronze_gold, now list_sqldb-taxi-platform_bronze_bronze)
[0m15:36:58.809560 [debug] [ThreadPool]: dbt-sqlserver
[0m15:36:58.810559 [debug] [ThreadPool]: Using sqlserver connection "list_sqldb-taxi-platform_bronze_bronze"
[0m15:36:58.810559 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "list_sqldb-taxi-platform_bronze_bronze"} */
USE [sqldb-taxi-platform];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze_bronze'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m15:36:58.810559 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:36:58.811559 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:36:58.811559 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:36:58.865432 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:36:58.866270 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_bronze: ROLLBACK
[0m15:36:58.866270 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_bronze: Close
[0m15:36:58.867266 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sqldb-taxi-platform_bronze_bronze, now list_sqldb-taxi-platform_bronze_silver)
[0m15:36:58.869272 [debug] [ThreadPool]: dbt-sqlserver
[0m15:36:58.869272 [debug] [ThreadPool]: Using sqlserver connection "list_sqldb-taxi-platform_bronze_silver"
[0m15:36:58.870265 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "list_sqldb-taxi-platform_bronze_silver"} */
USE [sqldb-taxi-platform];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze_silver'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m15:36:58.870265 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:36:58.870265 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:36:58.871272 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:36:58.925298 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:36:58.926298 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_silver: ROLLBACK
[0m15:36:58.926298 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_silver: Close
[0m15:36:58.928298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7192791d-9305-49af-8f2e-3959dfabfd5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023578BE27D0>]}
[0m15:36:58.928298 [debug] [MainThread]: On master: COMMIT
[0m15:36:58.932223 [debug] [Thread-1 (]: Began running node model.taxi_nyc_project.dim_payment_type
[0m15:36:58.933183 [info ] [Thread-1 (]: 1 of 7 START sql table model bronze_silver.dim_payment_type .................... [RUN]
[0m15:36:58.933183 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.taxi_nyc_project.dim_payment_type'
[0m15:36:58.934187 [debug] [Thread-1 (]: Began compiling node model.taxi_nyc_project.dim_payment_type
[0m15:36:58.940185 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_nyc_project.dim_payment_type"
[0m15:36:58.940185 [debug] [Thread-1 (]: Began executing node model.taxi_nyc_project.dim_payment_type
[0m15:36:58.967185 [debug] [Thread-1 (]: dbt-sqlserver
[0m15:36:58.972185 [debug] [Thread-1 (]: Applying DROP to: "sqldb-taxi-platform"."bronze_silver"."dim_payment_type__dbt_tmp__dbt_tmp_vw"
[0m15:36:58.977185 [debug] [Thread-1 (]: dbt-sqlserver
[0m15:36:58.977185 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.dim_payment_type"
[0m15:36:58.978181 [debug] [Thread-1 (]: On model.taxi_nyc_project.dim_payment_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.dim_payment_type"} */

        USE [sqldb-taxi-platform];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'sqldb-taxi-platform'
        and refs.referenced_schema_name = 'bronze_silver'
        and refs.referenced_entity_name = 'dim_payment_type__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m15:36:58.978181 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:36:58.978181 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:36:58.979178 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:36:59.030333 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:36:59.031390 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.dim_payment_type"
[0m15:36:59.031390 [debug] [Thread-1 (]: On model.taxi_nyc_project.dim_payment_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.dim_payment_type"} */

      
      
    
    USE [sqldb-taxi-platform];
    EXEC('DROP view IF EXISTS "bronze_silver"."dim_payment_type__dbt_tmp__dbt_tmp_vw";');

[0m15:36:59.083424 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:36:59.092424 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_nyc_project.dim_payment_type"
[0m15:36:59.093424 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.dim_payment_type"
[0m15:36:59.094511 [debug] [Thread-1 (]: On model.taxi_nyc_project.dim_payment_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.dim_payment_type"} */

  
    USE [sqldb-taxi-platform];
    USE [sqldb-taxi-platform];
    
    

    

    
    USE [sqldb-taxi-platform];
    EXEC('
        create view "bronze_silver"."dim_payment_type__dbt_tmp__dbt_tmp_vw" as 

select * from (
    values
        (1, ''Credit card''),
        (2, ''Cash''),
        (3, ''No charge''),
        (4, ''Dispute''),
        (5, ''Unknown''),
        (6, ''Voided trip'')
) as t(payment_type, payment_type_desc);
    ')

EXEC('
            SELECT * INTO "sqldb-taxi-platform"."bronze_silver"."dim_payment_type__dbt_tmp" FROM "sqldb-taxi-platform"."bronze_silver"."dim_payment_type__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS bronze_silver.dim_payment_type__dbt_tmp__dbt_tmp_vw')



    
    use [sqldb-taxi-platform];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'bronze_silver_dim_payment_type__dbt_tmp_cci'
        AND object_id=object_id('bronze_silver_dim_payment_type__dbt_tmp')
    )
    DROP index "bronze_silver"."dim_payment_type__dbt_tmp".bronze_silver_dim_payment_type__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX bronze_silver_dim_payment_type__dbt_tmp_cci
    ON "bronze_silver"."dim_payment_type__dbt_tmp"

   


  
[0m15:36:59.200209 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:36:59.205945 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.dim_payment_type"
[0m15:36:59.206945 [debug] [Thread-1 (]: On model.taxi_nyc_project.dim_payment_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.dim_payment_type"} */
USE [sqldb-taxi-platform];
      EXEC sp_rename 'bronze_silver.dim_payment_type', 'dim_payment_type__dbt_backup'
[0m15:36:59.259698 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:36:59.308717 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.dim_payment_type"
[0m15:36:59.309717 [debug] [Thread-1 (]: On model.taxi_nyc_project.dim_payment_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.dim_payment_type"} */
USE [sqldb-taxi-platform];
      EXEC sp_rename 'bronze_silver.dim_payment_type__dbt_tmp', 'dim_payment_type'
[0m15:36:59.362496 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:36:59.377494 [debug] [Thread-1 (]: On model.taxi_nyc_project.dim_payment_type: COMMIT
[0m15:36:59.380494 [debug] [Thread-1 (]: Applying DROP to: "sqldb-taxi-platform"."bronze_silver"."dim_payment_type__dbt_backup"
[0m15:36:59.380494 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.dim_payment_type"
[0m15:36:59.381495 [debug] [Thread-1 (]: On model.taxi_nyc_project.dim_payment_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.dim_payment_type"} */

      
    USE [sqldb-taxi-platform];
    EXEC('DROP table IF EXISTS "bronze_silver"."dim_payment_type__dbt_backup";');

[0m15:36:59.433314 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:36:59.436228 [debug] [Thread-1 (]: On model.taxi_nyc_project.dim_payment_type: Close
[0m15:36:59.437348 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7192791d-9305-49af-8f2e-3959dfabfd5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023578ED17D0>]}
[0m15:36:59.438228 [info ] [Thread-1 (]: 1 of 7 OK created sql table model bronze_silver.dim_payment_type ............... [[32mOK[0m in 0.50s]
[0m15:36:59.439222 [debug] [Thread-1 (]: Finished running node model.taxi_nyc_project.dim_payment_type
[0m15:36:59.439222 [debug] [Thread-1 (]: Began running node model.taxi_nyc_project.stg_trips
[0m15:36:59.440221 [info ] [Thread-1 (]: 2 of 7 START sql table model bronze_bronze.stg_trips ........................... [RUN]
[0m15:36:59.440221 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_nyc_project.dim_payment_type, now model.taxi_nyc_project.stg_trips)
[0m15:36:59.441220 [debug] [Thread-1 (]: Began compiling node model.taxi_nyc_project.stg_trips
[0m15:36:59.443229 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_nyc_project.stg_trips"
[0m15:36:59.444222 [debug] [Thread-1 (]: Began executing node model.taxi_nyc_project.stg_trips
[0m15:36:59.447229 [debug] [Thread-1 (]: dbt-sqlserver
[0m15:36:59.449228 [debug] [Thread-1 (]: Applying DROP to: "sqldb-taxi-platform"."bronze_bronze"."stg_trips__dbt_tmp__dbt_tmp_vw"
[0m15:36:59.449228 [debug] [Thread-1 (]: dbt-sqlserver
[0m15:36:59.450223 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.stg_trips"
[0m15:36:59.450223 [debug] [Thread-1 (]: On model.taxi_nyc_project.stg_trips: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.stg_trips"} */

        USE [sqldb-taxi-platform];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'sqldb-taxi-platform'
        and refs.referenced_schema_name = 'bronze_bronze'
        and refs.referenced_entity_name = 'stg_trips__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m15:36:59.450223 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:36:59.451221 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:36:59.451221 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:36:59.501612 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:36:59.503606 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.stg_trips"
[0m15:36:59.503606 [debug] [Thread-1 (]: On model.taxi_nyc_project.stg_trips: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.stg_trips"} */

      
      
    
    USE [sqldb-taxi-platform];
    EXEC('DROP view IF EXISTS "bronze_bronze"."stg_trips__dbt_tmp__dbt_tmp_vw";');

[0m15:36:59.551936 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:36:59.553943 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_nyc_project.stg_trips"
[0m15:36:59.554936 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.stg_trips"
[0m15:36:59.554936 [debug] [Thread-1 (]: On model.taxi_nyc_project.stg_trips: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.stg_trips"} */

  
    USE [sqldb-taxi-platform];
    USE [sqldb-taxi-platform];
    
    

    

    
    USE [sqldb-taxi-platform];
    EXEC('
        create view "bronze_bronze"."stg_trips__dbt_tmp__dbt_tmp_vw" as 

select
    cast(VendorID as int)                             as vendor_id,
    cast(tpep_pickup_datetime as datetime2)           as pickup_datetime,
    cast(tpep_dropoff_datetime as datetime2)          as dropoff_datetime,
    cast(passenger_count as int)                      as passenger_count,
    cast(trip_distance as float)                      as trip_distance,
    cast(RatecodeID as int)                           as rate_code_id,
    upper(store_and_fwd_flag)                         as store_and_fwd_flag,
    cast(PULocationID as int)                         as pu_location_id,
    cast(DOLocationID as int)                         as do_location_id,
    cast(payment_type as int)                         as payment_type,
    cast(fare_amount as decimal(10,2))                as fare_amount,
    cast(extra as decimal(10,2))                      as extra,
    cast(mta_tax as decimal(10,2))                    as mta_tax,
    cast(tip_amount as decimal(10,2))                 as tip_amount,
    cast(tolls_amount as decimal(10,2))               as tolls_amount,
    cast(improvement_surcharge as decimal(10,2))      as improvement_surcharge,
    cast(total_amount as decimal(10,2))               as total_amount,
    cast(congestion_surcharge as decimal(10,2))       as congestion_surcharge,
    cast(Airport_fee as decimal(10,2))                as airport_fee,
    cast(cbd_congestion_fee as decimal(10,2))         as cbd_congestion_fee
from raw.yellow_trips_2025_08
where
    trip_distance >= 0
    and fare_amount >= 0
    and total_amount >= 0
    and tpep_pickup_datetime is not null
    and tpep_dropoff_datetime is not null
    and tpep_dropoff_datetime >= tpep_pickup_datetime;;
    ')

EXEC('
            SELECT * INTO "sqldb-taxi-platform"."bronze_bronze"."stg_trips__dbt_tmp" FROM "sqldb-taxi-platform"."bronze_bronze"."stg_trips__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS bronze_bronze.stg_trips__dbt_tmp__dbt_tmp_vw')



    
    use [sqldb-taxi-platform];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'bronze_bronze_stg_trips__dbt_tmp_cci'
        AND object_id=object_id('bronze_bronze_stg_trips__dbt_tmp')
    )
    DROP index "bronze_bronze"."stg_trips__dbt_tmp".bronze_bronze_stg_trips__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX bronze_bronze_stg_trips__dbt_tmp_cci
    ON "bronze_bronze"."stg_trips__dbt_tmp"

   


  
[0m15:37:23.321754 [debug] [Thread-1 (]: SQL status: OK in 24.000 seconds
[0m15:37:23.324761 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.stg_trips"
[0m15:37:23.324761 [debug] [Thread-1 (]: On model.taxi_nyc_project.stg_trips: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.stg_trips"} */
USE [sqldb-taxi-platform];
      EXEC sp_rename 'bronze_bronze.stg_trips', 'stg_trips__dbt_backup'
[0m15:37:23.378479 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:37:23.382423 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.stg_trips"
[0m15:37:23.382423 [debug] [Thread-1 (]: On model.taxi_nyc_project.stg_trips: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.stg_trips"} */
USE [sqldb-taxi-platform];
      EXEC sp_rename 'bronze_bronze.stg_trips__dbt_tmp', 'stg_trips'
[0m15:37:23.436109 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:37:23.438179 [debug] [Thread-1 (]: On model.taxi_nyc_project.stg_trips: COMMIT
[0m15:37:23.440185 [debug] [Thread-1 (]: Applying DROP to: "sqldb-taxi-platform"."bronze_bronze"."stg_trips__dbt_backup"
[0m15:37:23.440185 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.stg_trips"
[0m15:37:23.441185 [debug] [Thread-1 (]: On model.taxi_nyc_project.stg_trips: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.stg_trips"} */

      
    USE [sqldb-taxi-platform];
    EXEC('DROP table IF EXISTS "bronze_bronze"."stg_trips__dbt_backup";');

[0m15:37:23.495340 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:37:23.497414 [debug] [Thread-1 (]: On model.taxi_nyc_project.stg_trips: Close
[0m15:37:23.497414 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7192791d-9305-49af-8f2e-3959dfabfd5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023578ED16D0>]}
[0m15:37:23.498423 [info ] [Thread-1 (]: 2 of 7 OK created sql table model bronze_bronze.stg_trips ...................... [[32mOK[0m in 24.06s]
[0m15:37:23.498911 [debug] [Thread-1 (]: Finished running node model.taxi_nyc_project.stg_trips
[0m15:37:23.499927 [debug] [Thread-1 (]: Began running node model.taxi_nyc_project.fact_trips
[0m15:37:23.499927 [info ] [Thread-1 (]: 3 of 7 START sql table model bronze_silver.fact_trips .......................... [RUN]
[0m15:37:23.501129 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_nyc_project.stg_trips, now model.taxi_nyc_project.fact_trips)
[0m15:37:23.501129 [debug] [Thread-1 (]: Began compiling node model.taxi_nyc_project.fact_trips
[0m15:37:23.505134 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_nyc_project.fact_trips"
[0m15:37:23.506134 [debug] [Thread-1 (]: Began executing node model.taxi_nyc_project.fact_trips
[0m15:37:23.508134 [debug] [Thread-1 (]: dbt-sqlserver
[0m15:37:23.510134 [debug] [Thread-1 (]: Applying DROP to: "sqldb-taxi-platform"."bronze_silver"."fact_trips__dbt_tmp__dbt_tmp_vw"
[0m15:37:23.511134 [debug] [Thread-1 (]: dbt-sqlserver
[0m15:37:23.511134 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.fact_trips"
[0m15:37:23.512134 [debug] [Thread-1 (]: On model.taxi_nyc_project.fact_trips: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.fact_trips"} */

        USE [sqldb-taxi-platform];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'sqldb-taxi-platform'
        and refs.referenced_schema_name = 'bronze_silver'
        and refs.referenced_entity_name = 'fact_trips__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m15:37:23.512134 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:37:23.513134 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:37:23.513134 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:37:23.564670 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:37:23.565673 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.fact_trips"
[0m15:37:23.566671 [debug] [Thread-1 (]: On model.taxi_nyc_project.fact_trips: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.fact_trips"} */

      
      
    
    USE [sqldb-taxi-platform];
    EXEC('DROP view IF EXISTS "bronze_silver"."fact_trips__dbt_tmp__dbt_tmp_vw";');

[0m15:37:23.616552 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:37:23.619563 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_nyc_project.fact_trips"
[0m15:37:23.619563 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.fact_trips"
[0m15:37:23.620556 [debug] [Thread-1 (]: On model.taxi_nyc_project.fact_trips: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.fact_trips"} */

  
    USE [sqldb-taxi-platform];
    USE [sqldb-taxi-platform];
    
    

    

    
    USE [sqldb-taxi-platform];
    EXEC('
        create view "bronze_silver"."fact_trips__dbt_tmp__dbt_tmp_vw" as 

with base as (

    select
        -- simple surrogate key
        cast(
            row_number() over (
                order by pickup_datetime, pu_location_id, do_location_id
            ) as bigint
        )                                           as trip_id,

        -- time fields
        pickup_datetime,
        dropoff_datetime,
        datediff(minute, pickup_datetime, dropoff_datetime)
                                                    as trip_duration_minutes,
        cast(pickup_datetime as date)               as pickup_date,
        datepart(hour, pickup_datetime)             as pickup_hour,
        datename(weekday, pickup_datetime)          as pickup_day_name,
        datepart(weekday, pickup_datetime)          as pickup_day_of_week,

        -- original numeric fields
        passenger_count,
        trip_distance,
        rate_code_id,
        pu_location_id,
        do_location_id,
        payment_type,
        fare_amount,
        extra,
        mta_tax,
        tip_amount,
        tolls_amount,
        improvement_surcharge,
        total_amount,
        congestion_surcharge,
        airport_fee,
        cbd_congestion_fee

    from "sqldb-taxi-platform"."bronze_bronze"."stg_trips"

)

select
    *,
    case 
        when fare_amount > 0 
            then cast(tip_amount / fare_amount * 100.0 as float)
        else null
    end                                             as tip_pct
from base;;
    ')

EXEC('
            SELECT * INTO "sqldb-taxi-platform"."bronze_silver"."fact_trips__dbt_tmp" FROM "sqldb-taxi-platform"."bronze_silver"."fact_trips__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS bronze_silver.fact_trips__dbt_tmp__dbt_tmp_vw')



    
    use [sqldb-taxi-platform];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'bronze_silver_fact_trips__dbt_tmp_cci'
        AND object_id=object_id('bronze_silver_fact_trips__dbt_tmp')
    )
    DROP index "bronze_silver"."fact_trips__dbt_tmp".bronze_silver_fact_trips__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX bronze_silver_fact_trips__dbt_tmp_cci
    ON "bronze_silver"."fact_trips__dbt_tmp"

   


  
[0m15:37:53.784415 [debug] [Thread-1 (]: SQL status: OK in 30.000 seconds
[0m15:37:53.787409 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.fact_trips"
[0m15:37:53.787409 [debug] [Thread-1 (]: On model.taxi_nyc_project.fact_trips: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.fact_trips"} */
USE [sqldb-taxi-platform];
      EXEC sp_rename 'bronze_silver.fact_trips', 'fact_trips__dbt_backup'
[0m15:37:53.840572 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:37:53.842564 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.fact_trips"
[0m15:37:53.843566 [debug] [Thread-1 (]: On model.taxi_nyc_project.fact_trips: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.fact_trips"} */
USE [sqldb-taxi-platform];
      EXEC sp_rename 'bronze_silver.fact_trips__dbt_tmp', 'fact_trips'
[0m15:37:53.895379 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:37:53.897379 [debug] [Thread-1 (]: On model.taxi_nyc_project.fact_trips: COMMIT
[0m15:37:53.899385 [debug] [Thread-1 (]: Applying DROP to: "sqldb-taxi-platform"."bronze_silver"."fact_trips__dbt_backup"
[0m15:37:53.900383 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.fact_trips"
[0m15:37:53.900383 [debug] [Thread-1 (]: On model.taxi_nyc_project.fact_trips: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.fact_trips"} */

      
    USE [sqldb-taxi-platform];
    EXEC('DROP table IF EXISTS "bronze_silver"."fact_trips__dbt_backup";');

[0m15:37:53.953501 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:37:53.955487 [debug] [Thread-1 (]: On model.taxi_nyc_project.fact_trips: Close
[0m15:37:53.955487 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7192791d-9305-49af-8f2e-3959dfabfd5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023578AB2310>]}
[0m15:37:53.956511 [info ] [Thread-1 (]: 3 of 7 OK created sql table model bronze_silver.fact_trips ..................... [[32mOK[0m in 30.45s]
[0m15:37:53.956511 [debug] [Thread-1 (]: Finished running node model.taxi_nyc_project.fact_trips
[0m15:37:53.957428 [debug] [Thread-1 (]: Began running node model.taxi_nyc_project.mart_daily_revenue
[0m15:37:53.958425 [info ] [Thread-1 (]: 4 of 7 START sql table model bronze_gold.mart_daily_revenue .................... [RUN]
[0m15:37:53.959428 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_nyc_project.fact_trips, now model.taxi_nyc_project.mart_daily_revenue)
[0m15:37:53.959428 [debug] [Thread-1 (]: Began compiling node model.taxi_nyc_project.mart_daily_revenue
[0m15:37:53.962423 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_nyc_project.mart_daily_revenue"
[0m15:37:53.963424 [debug] [Thread-1 (]: Began executing node model.taxi_nyc_project.mart_daily_revenue
[0m15:37:53.966425 [debug] [Thread-1 (]: dbt-sqlserver
[0m15:37:53.968424 [debug] [Thread-1 (]: Applying DROP to: "sqldb-taxi-platform"."bronze_gold"."mart_daily_revenue__dbt_tmp__dbt_tmp_vw"
[0m15:37:53.968424 [debug] [Thread-1 (]: dbt-sqlserver
[0m15:37:53.969423 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_daily_revenue"
[0m15:37:53.969423 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_daily_revenue"} */

        USE [sqldb-taxi-platform];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'sqldb-taxi-platform'
        and refs.referenced_schema_name = 'bronze_gold'
        and refs.referenced_entity_name = 'mart_daily_revenue__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m15:37:53.969423 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:37:53.970423 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:37:53.970423 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:37:54.020742 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:37:54.021748 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_daily_revenue"
[0m15:37:54.022749 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_daily_revenue"} */

      
      
    
    USE [sqldb-taxi-platform];
    EXEC('DROP view IF EXISTS "bronze_gold"."mart_daily_revenue__dbt_tmp__dbt_tmp_vw";');

[0m15:37:54.070743 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:37:54.074751 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_nyc_project.mart_daily_revenue"
[0m15:37:54.074751 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_daily_revenue"
[0m15:37:54.075746 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_daily_revenue"} */

  
    USE [sqldb-taxi-platform];
    USE [sqldb-taxi-platform];
    
    

    

    
    USE [sqldb-taxi-platform];
    EXEC('
        create view "bronze_gold"."mart_daily_revenue__dbt_tmp__dbt_tmp_vw" as 

select
    pickup_date                as trip_date,
    count(*)                   as trip_count,
    sum(total_amount)          as total_revenue,
    avg(total_amount)          as avg_revenue_per_trip
from "sqldb-taxi-platform"."bronze_silver"."fact_trips"
group by
    pickup_date;;
    ')

EXEC('
            SELECT * INTO "sqldb-taxi-platform"."bronze_gold"."mart_daily_revenue__dbt_tmp" FROM "sqldb-taxi-platform"."bronze_gold"."mart_daily_revenue__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS bronze_gold.mart_daily_revenue__dbt_tmp__dbt_tmp_vw')



    
    use [sqldb-taxi-platform];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'bronze_gold_mart_daily_revenue__dbt_tmp_cci'
        AND object_id=object_id('bronze_gold_mart_daily_revenue__dbt_tmp')
    )
    DROP index "bronze_gold"."mart_daily_revenue__dbt_tmp".bronze_gold_mart_daily_revenue__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX bronze_gold_mart_daily_revenue__dbt_tmp_cci
    ON "bronze_gold"."mart_daily_revenue__dbt_tmp"

   


  
[0m15:37:54.397256 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:37:54.400255 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_daily_revenue"
[0m15:37:54.400255 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_daily_revenue"} */
USE [sqldb-taxi-platform];
      EXEC sp_rename 'bronze_gold.mart_daily_revenue', 'mart_daily_revenue__dbt_backup'
[0m15:37:54.494586 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:37:54.497133 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_daily_revenue"
[0m15:37:54.497133 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_daily_revenue"} */
USE [sqldb-taxi-platform];
      EXEC sp_rename 'bronze_gold.mart_daily_revenue__dbt_tmp', 'mart_daily_revenue'
[0m15:37:54.549530 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:37:54.550916 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_daily_revenue: COMMIT
[0m15:37:54.552911 [debug] [Thread-1 (]: Applying DROP to: "sqldb-taxi-platform"."bronze_gold"."mart_daily_revenue__dbt_backup"
[0m15:37:54.553905 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_daily_revenue"
[0m15:37:54.553905 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_daily_revenue"} */

      
    USE [sqldb-taxi-platform];
    EXEC('DROP table IF EXISTS "bronze_gold"."mart_daily_revenue__dbt_backup";');

[0m15:37:54.611406 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:37:54.611964 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_daily_revenue: Close
[0m15:37:54.612959 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7192791d-9305-49af-8f2e-3959dfabfd5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023578EDB850>]}
[0m15:37:54.612959 [info ] [Thread-1 (]: 4 of 7 OK created sql table model bronze_gold.mart_daily_revenue ............... [[32mOK[0m in 0.65s]
[0m15:37:54.614149 [debug] [Thread-1 (]: Finished running node model.taxi_nyc_project.mart_daily_revenue
[0m15:37:54.614149 [debug] [Thread-1 (]: Began running node model.taxi_nyc_project.mart_tip_by_payment_type
[0m15:37:54.615234 [info ] [Thread-1 (]: 5 of 7 START sql table model bronze_gold.mart_tip_by_payment_type .............. [RUN]
[0m15:37:54.615234 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_nyc_project.mart_daily_revenue, now model.taxi_nyc_project.mart_tip_by_payment_type)
[0m15:37:54.616237 [debug] [Thread-1 (]: Began compiling node model.taxi_nyc_project.mart_tip_by_payment_type
[0m15:37:54.619175 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_nyc_project.mart_tip_by_payment_type"
[0m15:37:54.620162 [debug] [Thread-1 (]: Began executing node model.taxi_nyc_project.mart_tip_by_payment_type
[0m15:37:54.622216 [debug] [Thread-1 (]: dbt-sqlserver
[0m15:37:54.624218 [debug] [Thread-1 (]: Applying DROP to: "sqldb-taxi-platform"."bronze_gold"."mart_tip_by_payment_type__dbt_tmp__dbt_tmp_vw"
[0m15:37:54.625224 [debug] [Thread-1 (]: dbt-sqlserver
[0m15:37:54.625224 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_tip_by_payment_type"
[0m15:37:54.626252 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_tip_by_payment_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_tip_by_payment_type"} */

        USE [sqldb-taxi-platform];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'sqldb-taxi-platform'
        and refs.referenced_schema_name = 'bronze_gold'
        and refs.referenced_entity_name = 'mart_tip_by_payment_type__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m15:37:54.626252 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:37:54.626252 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:37:54.627224 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:37:54.678627 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:37:54.679634 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_tip_by_payment_type"
[0m15:37:54.679634 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_tip_by_payment_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_tip_by_payment_type"} */

      
      
    
    USE [sqldb-taxi-platform];
    EXEC('DROP view IF EXISTS "bronze_gold"."mart_tip_by_payment_type__dbt_tmp__dbt_tmp_vw";');

[0m15:37:54.727615 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:37:54.729605 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_nyc_project.mart_tip_by_payment_type"
[0m15:37:54.730548 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_tip_by_payment_type"
[0m15:37:54.731548 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_tip_by_payment_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_tip_by_payment_type"} */

  
    USE [sqldb-taxi-platform];
    USE [sqldb-taxi-platform];
    
    

    

    
    USE [sqldb-taxi-platform];
    EXEC('
        create view "bronze_gold"."mart_tip_by_payment_type__dbt_tmp__dbt_tmp_vw" as 

select
    d.payment_type_desc   as payment_type,
    avg(f.tip_pct)        as avg_tip_pct
from "sqldb-taxi-platform"."bronze_silver"."fact_trips" f
join "sqldb-taxi-platform"."bronze_silver"."dim_payment_type" d
    on f.payment_type = d.payment_type
where f.tip_pct is not null
group by
    d.payment_type_desc;;
    ')

EXEC('
            SELECT * INTO "sqldb-taxi-platform"."bronze_gold"."mart_tip_by_payment_type__dbt_tmp" FROM "sqldb-taxi-platform"."bronze_gold"."mart_tip_by_payment_type__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS bronze_gold.mart_tip_by_payment_type__dbt_tmp__dbt_tmp_vw')



    
    use [sqldb-taxi-platform];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'bronze_gold_mart_tip_by_payment_type__dbt_tmp_cci'
        AND object_id=object_id('bronze_gold_mart_tip_by_payment_type__dbt_tmp')
    )
    DROP index "bronze_gold"."mart_tip_by_payment_type__dbt_tmp".bronze_gold_mart_tip_by_payment_type__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX bronze_gold_mart_tip_by_payment_type__dbt_tmp_cci
    ON "bronze_gold"."mart_tip_by_payment_type__dbt_tmp"

   


  
[0m15:37:55.259296 [debug] [Thread-1 (]: SQL status: OK in 1.000 seconds
[0m15:37:55.262369 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_tip_by_payment_type"
[0m15:37:55.263372 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_tip_by_payment_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_tip_by_payment_type"} */
USE [sqldb-taxi-platform];
      EXEC sp_rename 'bronze_gold.mart_tip_by_payment_type', 'mart_tip_by_payment_type__dbt_backup'
[0m15:37:55.315502 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:37:55.318503 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_tip_by_payment_type"
[0m15:37:55.318503 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_tip_by_payment_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_tip_by_payment_type"} */
USE [sqldb-taxi-platform];
      EXEC sp_rename 'bronze_gold.mart_tip_by_payment_type__dbt_tmp', 'mart_tip_by_payment_type'
[0m15:37:55.370268 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:37:55.372268 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_tip_by_payment_type: COMMIT
[0m15:37:55.374268 [debug] [Thread-1 (]: Applying DROP to: "sqldb-taxi-platform"."bronze_gold"."mart_tip_by_payment_type__dbt_backup"
[0m15:37:55.375376 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_tip_by_payment_type"
[0m15:37:55.375376 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_tip_by_payment_type: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_tip_by_payment_type"} */

      
    USE [sqldb-taxi-platform];
    EXEC('DROP table IF EXISTS "bronze_gold"."mart_tip_by_payment_type__dbt_backup";');

[0m15:37:55.427810 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:37:55.428835 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_tip_by_payment_type: Close
[0m15:37:55.429885 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7192791d-9305-49af-8f2e-3959dfabfd5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023578986290>]}
[0m15:37:55.429885 [info ] [Thread-1 (]: 5 of 7 OK created sql table model bronze_gold.mart_tip_by_payment_type ......... [[32mOK[0m in 0.81s]
[0m15:37:55.430876 [debug] [Thread-1 (]: Finished running node model.taxi_nyc_project.mart_tip_by_payment_type
[0m15:37:55.430876 [debug] [Thread-1 (]: Began running node model.taxi_nyc_project.mart_trips_by_hour
[0m15:37:55.431822 [info ] [Thread-1 (]: 6 of 7 START sql table model bronze_gold.mart_trips_by_hour .................... [RUN]
[0m15:37:55.431822 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_nyc_project.mart_tip_by_payment_type, now model.taxi_nyc_project.mart_trips_by_hour)
[0m15:37:55.432879 [debug] [Thread-1 (]: Began compiling node model.taxi_nyc_project.mart_trips_by_hour
[0m15:37:55.436866 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_nyc_project.mart_trips_by_hour"
[0m15:37:55.437400 [debug] [Thread-1 (]: Began executing node model.taxi_nyc_project.mart_trips_by_hour
[0m15:37:55.440397 [debug] [Thread-1 (]: dbt-sqlserver
[0m15:37:55.442397 [debug] [Thread-1 (]: Applying DROP to: "sqldb-taxi-platform"."bronze_gold"."mart_trips_by_hour__dbt_tmp__dbt_tmp_vw"
[0m15:37:55.442397 [debug] [Thread-1 (]: dbt-sqlserver
[0m15:37:55.443398 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_trips_by_hour"
[0m15:37:55.443398 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_trips_by_hour: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_trips_by_hour"} */

        USE [sqldb-taxi-platform];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'sqldb-taxi-platform'
        and refs.referenced_schema_name = 'bronze_gold'
        and refs.referenced_entity_name = 'mart_trips_by_hour__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m15:37:55.443398 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:37:55.444398 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:37:55.444398 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:37:55.494801 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:37:55.495800 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_trips_by_hour"
[0m15:37:55.496800 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_trips_by_hour: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_trips_by_hour"} */

      
      
    
    USE [sqldb-taxi-platform];
    EXEC('DROP view IF EXISTS "bronze_gold"."mart_trips_by_hour__dbt_tmp__dbt_tmp_vw";');

[0m15:37:55.545091 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:37:55.546648 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_nyc_project.mart_trips_by_hour"
[0m15:37:55.547647 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_trips_by_hour"
[0m15:37:55.548647 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_trips_by_hour: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_trips_by_hour"} */

  
    USE [sqldb-taxi-platform];
    USE [sqldb-taxi-platform];
    
    

    

    
    USE [sqldb-taxi-platform];
    EXEC('
        create view "bronze_gold"."mart_trips_by_hour__dbt_tmp__dbt_tmp_vw" as 

select
    pickup_hour      as hour_of_day,
    pickup_day_name  as day_of_week,
    count(*)         as trip_count
from "sqldb-taxi-platform"."bronze_silver"."fact_trips"
group by
    pickup_hour,
    pickup_day_name;;
    ')

EXEC('
            SELECT * INTO "sqldb-taxi-platform"."bronze_gold"."mart_trips_by_hour__dbt_tmp" FROM "sqldb-taxi-platform"."bronze_gold"."mart_trips_by_hour__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS bronze_gold.mart_trips_by_hour__dbt_tmp__dbt_tmp_vw')



    
    use [sqldb-taxi-platform];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'bronze_gold_mart_trips_by_hour__dbt_tmp_cci'
        AND object_id=object_id('bronze_gold_mart_trips_by_hour__dbt_tmp')
    )
    DROP index "bronze_gold"."mart_trips_by_hour__dbt_tmp".bronze_gold_mart_trips_by_hour__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX bronze_gold_mart_trips_by_hour__dbt_tmp_cci
    ON "bronze_gold"."mart_trips_by_hour__dbt_tmp"

   


  
[0m15:37:56.495430 [debug] [Thread-1 (]: SQL status: OK in 1.000 seconds
[0m15:37:56.498448 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_trips_by_hour"
[0m15:37:56.498448 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_trips_by_hour: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_trips_by_hour"} */
USE [sqldb-taxi-platform];
      EXEC sp_rename 'bronze_gold.mart_trips_by_hour', 'mart_trips_by_hour__dbt_backup'
[0m15:37:56.551278 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:37:56.554052 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_trips_by_hour"
[0m15:37:56.555049 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_trips_by_hour: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_trips_by_hour"} */
USE [sqldb-taxi-platform];
      EXEC sp_rename 'bronze_gold.mart_trips_by_hour__dbt_tmp', 'mart_trips_by_hour'
[0m15:37:56.606913 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:37:56.607923 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_trips_by_hour: COMMIT
[0m15:37:56.610922 [debug] [Thread-1 (]: Applying DROP to: "sqldb-taxi-platform"."bronze_gold"."mart_trips_by_hour__dbt_backup"
[0m15:37:56.610922 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_trips_by_hour"
[0m15:37:56.611923 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_trips_by_hour: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_trips_by_hour"} */

      
    USE [sqldb-taxi-platform];
    EXEC('DROP table IF EXISTS "bronze_gold"."mart_trips_by_hour__dbt_backup";');

[0m15:37:56.664251 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:37:56.665250 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_trips_by_hour: Close
[0m15:37:56.665250 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7192791d-9305-49af-8f2e-3959dfabfd5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002357868E7D0>]}
[0m15:37:56.666257 [info ] [Thread-1 (]: 6 of 7 OK created sql table model bronze_gold.mart_trips_by_hour ............... [[32mOK[0m in 1.23s]
[0m15:37:56.667250 [debug] [Thread-1 (]: Finished running node model.taxi_nyc_project.mart_trips_by_hour
[0m15:37:56.667250 [debug] [Thread-1 (]: Began running node model.taxi_nyc_project.mart_zone_revenue
[0m15:37:56.668256 [info ] [Thread-1 (]: 7 of 7 START sql table model bronze_gold.mart_zone_revenue ..................... [RUN]
[0m15:37:56.668256 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_nyc_project.mart_trips_by_hour, now model.taxi_nyc_project.mart_zone_revenue)
[0m15:37:56.669259 [debug] [Thread-1 (]: Began compiling node model.taxi_nyc_project.mart_zone_revenue
[0m15:37:56.671258 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_nyc_project.mart_zone_revenue"
[0m15:37:56.672257 [debug] [Thread-1 (]: Began executing node model.taxi_nyc_project.mart_zone_revenue
[0m15:37:56.675294 [debug] [Thread-1 (]: dbt-sqlserver
[0m15:37:56.676826 [debug] [Thread-1 (]: Applying DROP to: "sqldb-taxi-platform"."bronze_gold"."mart_zone_revenue__dbt_tmp__dbt_tmp_vw"
[0m15:37:56.677823 [debug] [Thread-1 (]: dbt-sqlserver
[0m15:37:56.677823 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_zone_revenue"
[0m15:37:56.678826 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_zone_revenue: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_zone_revenue"} */

        USE [sqldb-taxi-platform];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'sqldb-taxi-platform'
        and refs.referenced_schema_name = 'bronze_gold'
        and refs.referenced_entity_name = 'mart_zone_revenue__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m15:37:56.678826 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:37:56.678826 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:37:56.679818 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:37:56.730217 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:37:56.731183 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_zone_revenue"
[0m15:37:56.731183 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_zone_revenue: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_zone_revenue"} */

      
      
    
    USE [sqldb-taxi-platform];
    EXEC('DROP view IF EXISTS "bronze_gold"."mart_zone_revenue__dbt_tmp__dbt_tmp_vw";');

[0m15:37:56.780358 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:37:56.781269 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_nyc_project.mart_zone_revenue"
[0m15:37:56.782266 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_zone_revenue"
[0m15:37:56.782266 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_zone_revenue: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_zone_revenue"} */

  
    USE [sqldb-taxi-platform];
    USE [sqldb-taxi-platform];
    
    

    

    
    USE [sqldb-taxi-platform];
    EXEC('
        create view "bronze_gold"."mart_zone_revenue__dbt_tmp__dbt_tmp_vw" as 

select
    pu_location_id             as pickup_zone_id,
    count(*)                   as trip_count,
    sum(total_amount)          as total_revenue
from "sqldb-taxi-platform"."bronze_silver"."fact_trips"
group by
    pu_location_id;;
    ')

EXEC('
            SELECT * INTO "sqldb-taxi-platform"."bronze_gold"."mart_zone_revenue__dbt_tmp" FROM "sqldb-taxi-platform"."bronze_gold"."mart_zone_revenue__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS bronze_gold.mart_zone_revenue__dbt_tmp__dbt_tmp_vw')



    
    use [sqldb-taxi-platform];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'bronze_gold_mart_zone_revenue__dbt_tmp_cci'
        AND object_id=object_id('bronze_gold_mart_zone_revenue__dbt_tmp')
    )
    DROP index "bronze_gold"."mart_zone_revenue__dbt_tmp".bronze_gold_mart_zone_revenue__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX bronze_gold_mart_zone_revenue__dbt_tmp_cci
    ON "bronze_gold"."mart_zone_revenue__dbt_tmp"

   


  
[0m15:37:57.120729 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:37:57.124767 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_zone_revenue"
[0m15:37:57.124767 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_zone_revenue: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_zone_revenue"} */
USE [sqldb-taxi-platform];
      EXEC sp_rename 'bronze_gold.mart_zone_revenue', 'mart_zone_revenue__dbt_backup'
[0m15:37:57.178277 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:37:57.181276 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_zone_revenue"
[0m15:37:57.181276 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_zone_revenue: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_zone_revenue"} */
USE [sqldb-taxi-platform];
      EXEC sp_rename 'bronze_gold.mart_zone_revenue__dbt_tmp', 'mart_zone_revenue'
[0m15:37:57.234166 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:37:57.236147 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_zone_revenue: COMMIT
[0m15:37:57.238143 [debug] [Thread-1 (]: Applying DROP to: "sqldb-taxi-platform"."bronze_gold"."mart_zone_revenue__dbt_backup"
[0m15:37:57.238143 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_zone_revenue"
[0m15:37:57.239153 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_zone_revenue: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_zone_revenue"} */

      
    USE [sqldb-taxi-platform];
    EXEC('DROP table IF EXISTS "bronze_gold"."mart_zone_revenue__dbt_backup";');

[0m15:37:57.291171 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:37:57.292165 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_zone_revenue: Close
[0m15:37:57.293172 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7192791d-9305-49af-8f2e-3959dfabfd5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235789A9350>]}
[0m15:37:57.293172 [info ] [Thread-1 (]: 7 of 7 OK created sql table model bronze_gold.mart_zone_revenue ................ [[32mOK[0m in 0.62s]
[0m15:37:57.294165 [debug] [Thread-1 (]: Finished running node model.taxi_nyc_project.mart_zone_revenue
[0m15:37:57.295164 [debug] [MainThread]: On master: COMMIT
[0m15:37:57.296174 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:37:57.296174 [debug] [MainThread]: Connection 'list_sqldb-taxi-platform' was properly closed.
[0m15:37:57.296174 [debug] [MainThread]: Connection 'list_sqldb-taxi-platform_bronze_silver' was properly closed.
[0m15:37:57.296174 [debug] [MainThread]: Connection 'model.taxi_nyc_project.mart_zone_revenue' was properly closed.
[0m15:37:57.297164 [info ] [MainThread]: 
[0m15:37:57.297164 [info ] [MainThread]: Finished running 7 table models in 0 hours 0 minutes and 59.37 seconds (59.37s).
[0m15:37:57.299222 [debug] [MainThread]: Command end result
[0m15:37:57.321226 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\manifest.json
[0m15:37:57.323226 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\semantic_manifest.json
[0m15:37:57.328226 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\run_results.json
[0m15:37:57.329220 [info ] [MainThread]: 
[0m15:37:57.329220 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:37:57.330233 [info ] [MainThread]: 
[0m15:37:57.330233 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m15:37:57.331228 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 3 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:37:57.332219 [debug] [MainThread]: Command `dbt run` succeeded at 15:37:57.332219 after 61.19 seconds
[0m15:37:57.333226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023576D40610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002357031F850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235702A3350>]}
[0m15:37:57.333226 [debug] [MainThread]: Flushing usage events
[0m15:37:58.202648 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:37:59.886677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C84FB3690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C84FE0DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C84FE1E50>]}


============================== 15:37:59.889685 | be5e12d9-4baa-4503-9daa-de5f45049e37 ==============================
[0m15:37:59.889685 [info ] [MainThread]: Running with dbt=1.10.15
[0m15:37:59.890676 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'no_print': 'None', 'use_colors': 'True', 'profiles_dir': '.', 'cache_selected_only': 'False', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\alexm\\Desktop\\python\\azure-taxi-platform\\dbt_project\\logs', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir . --no-partial-parse', 'printer_width': '80', 'write_json': 'True'}
[0m15:38:00.216717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be5e12d9-4baa-4503-9daa-de5f45049e37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C868A4490>]}
[0m15:38:00.263200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be5e12d9-4baa-4503-9daa-de5f45049e37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C83FA9350>]}
[0m15:38:00.264206 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m15:38:00.490550 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m15:38:00.491551 [debug] [MainThread]: Partial parsing not enabled
[0m15:38:01.521976 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m15:38:01.522993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'be5e12d9-4baa-4503-9daa-de5f45049e37', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C86D980D0>]}
[0m15:38:01.614052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be5e12d9-4baa-4503-9daa-de5f45049e37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C86D50A10>]}
[0m15:38:01.671999 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\manifest.json
[0m15:38:01.674999 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\semantic_manifest.json
[0m15:38:01.701993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be5e12d9-4baa-4503-9daa-de5f45049e37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C86E966D0>]}
[0m15:38:01.701993 [info ] [MainThread]: Found 7 models, 13 data tests, 535 macros
[0m15:38:01.702992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be5e12d9-4baa-4503-9daa-de5f45049e37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C87120A10>]}
[0m15:38:01.704993 [info ] [MainThread]: 
[0m15:38:01.704993 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:38:01.705992 [info ] [MainThread]: 
[0m15:38:01.705992 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m15:38:01.711518 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_sqldb-taxi-platform_bronze_silver'
[0m15:38:01.722511 [debug] [ThreadPool]: dbt-sqlserver
[0m15:38:01.723511 [debug] [ThreadPool]: Using sqlserver connection "list_sqldb-taxi-platform_bronze_silver"
[0m15:38:01.723511 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "list_sqldb-taxi-platform_bronze_silver"} */
USE [sqldb-taxi-platform];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze_silver'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m15:38:01.723511 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:38:01.724514 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:38:02.320670 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:38:02.387790 [debug] [ThreadPool]: SQL status: OK in 1.000 seconds
[0m15:38:02.388791 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_silver: ROLLBACK
[0m15:38:02.389800 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_silver: Close
[0m15:38:02.389800 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sqldb-taxi-platform_bronze_silver, now list_sqldb-taxi-platform_bronze_bronze)
[0m15:38:02.392799 [debug] [ThreadPool]: dbt-sqlserver
[0m15:38:02.392799 [debug] [ThreadPool]: Using sqlserver connection "list_sqldb-taxi-platform_bronze_bronze"
[0m15:38:02.392799 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "list_sqldb-taxi-platform_bronze_bronze"} */
USE [sqldb-taxi-platform];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze_bronze'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m15:38:02.393801 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:38:02.393801 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:38:02.394790 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:38:02.461263 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:38:02.462246 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_bronze: ROLLBACK
[0m15:38:02.462246 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_bronze: Close
[0m15:38:02.463258 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sqldb-taxi-platform_bronze_bronze, now list_sqldb-taxi-platform_bronze_gold)
[0m15:38:02.465259 [debug] [ThreadPool]: dbt-sqlserver
[0m15:38:02.465259 [debug] [ThreadPool]: Using sqlserver connection "list_sqldb-taxi-platform_bronze_gold"
[0m15:38:02.466251 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_gold: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "list_sqldb-taxi-platform_bronze_gold"} */
USE [sqldb-taxi-platform];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze_gold'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m15:38:02.466251 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:38:02.466251 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:38:02.466251 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:38:02.533026 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:38:02.534081 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_gold: ROLLBACK
[0m15:38:02.534081 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_gold: Close
[0m15:38:02.535097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be5e12d9-4baa-4503-9daa-de5f45049e37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C86B00B10>]}
[0m15:38:02.536044 [debug] [MainThread]: On master: COMMIT
[0m15:38:02.539456 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec
[0m15:38:02.540467 [info ] [Thread-1 (]: 1 of 13 START test accepted_values_stg_trips_payment_type__1__2__3__4__5__6 .... [RUN]
[0m15:38:02.541456 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec'
[0m15:38:02.541456 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec
[0m15:38:02.548462 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec"
[0m15:38:02.549463 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec
[0m15:38:02.564463 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec"
[0m15:38:02.565462 [debug] [Thread-1 (]: Using sqlserver connection "test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec"
[0m15:38:02.566455 [debug] [Thread-1 (]: On test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec"} */

    -- Create target schema if it does not
  USE [sqldb-taxi-platform];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'bronze')
  BEGIN
    EXEC('CREATE SCHEMA [bronze]')
  END

  

  
  EXEC('create view 
    [bronze].[testview_f33210bcd4b055fe9687c095053b88a1_13711]
   as 
    
    
    

with all_values as (

    select
        payment_type as value_field,
        count(*) as n_records

    from "sqldb-taxi-platform"."bronze_bronze"."stg_trips"
    group by payment_type

)

select *
from all_values
where value_field not in (
    ''1'',''2'',''3'',''4'',''5'',''6''
)



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [bronze].[testview_f33210bcd4b055fe9687c095053b88a1_13711]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [bronze].[testview_f33210bcd4b055fe9687c095053b88a1_13711]
  ;')
[0m15:38:02.566455 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:38:02.566455 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:38:02.567461 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:38:02.938837 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:38:02.941838 [debug] [Thread-1 (]: On test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec: ROLLBACK
[0m15:38:02.942838 [debug] [Thread-1 (]: On test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec: Close
[0m15:38:02.942838 [info ] [Thread-1 (]: 1 of 13 PASS accepted_values_stg_trips_payment_type__1__2__3__4__5__6 .......... [[32mPASS[0m in 0.40s]
[0m15:38:02.943831 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec
[0m15:38:02.944832 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d
[0m15:38:02.944832 [info ] [Thread-1 (]: 2 of 13 START test accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99 ... [RUN]
[0m15:38:02.945831 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec, now test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d)
[0m15:38:02.945831 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d
[0m15:38:02.949838 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d"
[0m15:38:02.949838 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d
[0m15:38:02.951841 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d"
[0m15:38:02.952838 [debug] [Thread-1 (]: Using sqlserver connection "test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d"
[0m15:38:02.953831 [debug] [Thread-1 (]: On test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d"} */

    -- Create target schema if it does not
  USE [sqldb-taxi-platform];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'bronze')
  BEGIN
    EXEC('CREATE SCHEMA [bronze]')
  END

  

  
  EXEC('create view 
    [bronze].[testview_4dded7e06fdf8cf96858af6f2dabdb0d_16227]
   as 
    
    
    

with all_values as (

    select
        rate_code_id as value_field,
        count(*) as n_records

    from "sqldb-taxi-platform"."bronze_bronze"."stg_trips"
    group by rate_code_id

)

select *
from all_values
where value_field not in (
    ''1'',''2'',''3'',''4'',''5'',''99''
)



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [bronze].[testview_4dded7e06fdf8cf96858af6f2dabdb0d_16227]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [bronze].[testview_4dded7e06fdf8cf96858af6f2dabdb0d_16227]
  ;')
[0m15:38:02.953831 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:38:02.954841 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:38:02.954841 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:38:03.227392 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:38:03.229166 [debug] [Thread-1 (]: On test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d: ROLLBACK
[0m15:38:03.229166 [debug] [Thread-1 (]: On test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d: Close
[0m15:38:03.229166 [info ] [Thread-1 (]: 2 of 13 PASS accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99 ......... [[32mPASS[0m in 0.28s]
[0m15:38:03.230363 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d
[0m15:38:03.230363 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626
[0m15:38:03.231442 [info ] [Thread-1 (]: 3 of 13 START test not_null_dim_payment_type_payment_type ...................... [RUN]
[0m15:38:03.231442 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d, now test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626)
[0m15:38:03.232418 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626
[0m15:38:03.238381 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626"
[0m15:38:03.239375 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626
[0m15:38:03.288922 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626"
[0m15:38:03.290923 [debug] [Thread-1 (]: Using sqlserver connection "test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626"
[0m15:38:03.290923 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626"} */

    -- Create target schema if it does not
  USE [sqldb-taxi-platform];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'bronze')
  BEGIN
    EXEC('CREATE SCHEMA [bronze]')
  END

  

  
  EXEC('create view 
    [bronze].[testview_2ad2dc6a1d72454bc6f07cc7701e665e_4144]
   as 
    
    
    



select payment_type
from "sqldb-taxi-platform"."bronze_silver"."dim_payment_type"
where payment_type is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [bronze].[testview_2ad2dc6a1d72454bc6f07cc7701e665e_4144]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [bronze].[testview_2ad2dc6a1d72454bc6f07cc7701e665e_4144]
  ;')
[0m15:38:03.290923 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:38:03.291916 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:38:03.291916 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:38:03.347467 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:38:03.348477 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626: ROLLBACK
[0m15:38:03.348477 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626: Close
[0m15:38:03.349477 [info ] [Thread-1 (]: 3 of 13 PASS not_null_dim_payment_type_payment_type ............................ [[32mPASS[0m in 0.12s]
[0m15:38:03.350477 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626
[0m15:38:03.350477 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c
[0m15:38:03.350477 [info ] [Thread-1 (]: 4 of 13 START test not_null_fact_trips_pickup_date ............................. [RUN]
[0m15:38:03.351477 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626, now test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c)
[0m15:38:03.351477 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c
[0m15:38:03.355477 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c"
[0m15:38:03.356476 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c
[0m15:38:03.358477 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c"
[0m15:38:03.358477 [debug] [Thread-1 (]: Using sqlserver connection "test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c"
[0m15:38:03.359477 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c"} */

    -- Create target schema if it does not
  USE [sqldb-taxi-platform];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'bronze')
  BEGIN
    EXEC('CREATE SCHEMA [bronze]')
  END

  

  
  EXEC('create view 
    [bronze].[testview_7d112b4bacf9180b503a254961208261_6610]
   as 
    
    
    



select pickup_date
from "sqldb-taxi-platform"."bronze_silver"."fact_trips"
where pickup_date is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [bronze].[testview_7d112b4bacf9180b503a254961208261_6610]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [bronze].[testview_7d112b4bacf9180b503a254961208261_6610]
  ;')
[0m15:38:03.359477 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:38:03.360477 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:38:03.360477 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:38:03.417163 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:38:03.418160 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c: ROLLBACK
[0m15:38:03.419151 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c: Close
[0m15:38:03.419151 [info ] [Thread-1 (]: 4 of 13 PASS not_null_fact_trips_pickup_date ................................... [[32mPASS[0m in 0.07s]
[0m15:38:03.420151 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c
[0m15:38:03.421105 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442
[0m15:38:03.421105 [info ] [Thread-1 (]: 5 of 13 START test not_null_fact_trips_trip_id ................................. [RUN]
[0m15:38:03.422088 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c, now test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442)
[0m15:38:03.422218 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442
[0m15:38:03.426094 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442"
[0m15:38:03.427095 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442
[0m15:38:03.429089 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442"
[0m15:38:03.429089 [debug] [Thread-1 (]: Using sqlserver connection "test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442"
[0m15:38:03.430097 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442"} */

    -- Create target schema if it does not
  USE [sqldb-taxi-platform];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'bronze')
  BEGIN
    EXEC('CREATE SCHEMA [bronze]')
  END

  

  
  EXEC('create view 
    [bronze].[testview_20905412c48dcf3bfd76540d3b87984e_1458]
   as 
    
    
    



select trip_id
from "sqldb-taxi-platform"."bronze_silver"."fact_trips"
where trip_id is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [bronze].[testview_20905412c48dcf3bfd76540d3b87984e_1458]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [bronze].[testview_20905412c48dcf3bfd76540d3b87984e_1458]
  ;')
[0m15:38:03.430097 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:38:03.431087 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:38:03.431087 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:38:03.731457 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:38:03.732451 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442: ROLLBACK
[0m15:38:03.733459 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442: Close
[0m15:38:03.733459 [info ] [Thread-1 (]: 5 of 13 PASS not_null_fact_trips_trip_id ....................................... [[32mPASS[0m in 0.31s]
[0m15:38:03.734459 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442
[0m15:38:03.734459 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b
[0m15:38:03.735451 [info ] [Thread-1 (]: 6 of 13 START test not_null_stg_trips_dropoff_datetime ......................... [RUN]
[0m15:38:03.736450 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442, now test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b)
[0m15:38:03.736450 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b
[0m15:38:03.739458 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b"
[0m15:38:03.740457 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b
[0m15:38:03.742450 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b"
[0m15:38:03.743458 [debug] [Thread-1 (]: Using sqlserver connection "test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b"
[0m15:38:03.744463 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b"} */

    -- Create target schema if it does not
  USE [sqldb-taxi-platform];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'bronze')
  BEGIN
    EXEC('CREATE SCHEMA [bronze]')
  END

  

  
  EXEC('create view 
    [bronze].[testview_4c8d3f315598f1637f069cf3074df17a_18670]
   as 
    
    
    



select dropoff_datetime
from "sqldb-taxi-platform"."bronze_bronze"."stg_trips"
where dropoff_datetime is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [bronze].[testview_4c8d3f315598f1637f069cf3074df17a_18670]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [bronze].[testview_4c8d3f315598f1637f069cf3074df17a_18670]
  ;')
[0m15:38:03.744463 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:38:03.744463 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:38:03.745451 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:38:04.308034 [debug] [Thread-1 (]: SQL status: OK in 1.000 seconds
[0m15:38:04.309985 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b: ROLLBACK
[0m15:38:04.309985 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b: Close
[0m15:38:04.310945 [info ] [Thread-1 (]: 6 of 13 PASS not_null_stg_trips_dropoff_datetime ............................... [[32mPASS[0m in 0.58s]
[0m15:38:04.311946 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b
[0m15:38:04.311946 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74
[0m15:38:04.311946 [info ] [Thread-1 (]: 7 of 13 START test not_null_stg_trips_fare_amount .............................. [RUN]
[0m15:38:04.312944 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b, now test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74)
[0m15:38:04.312944 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74
[0m15:38:04.316950 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74"
[0m15:38:04.316950 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74
[0m15:38:04.318953 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74"
[0m15:38:04.320089 [debug] [Thread-1 (]: Using sqlserver connection "test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74"
[0m15:38:04.320944 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74"} */

    -- Create target schema if it does not
  USE [sqldb-taxi-platform];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'bronze')
  BEGIN
    EXEC('CREATE SCHEMA [bronze]')
  END

  

  
  EXEC('create view 
    [bronze].[testview_9ea19f17f3a1a85ec021164b6969d1d9_3200]
   as 
    
    
    



select fare_amount
from "sqldb-taxi-platform"."bronze_bronze"."stg_trips"
where fare_amount is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [bronze].[testview_9ea19f17f3a1a85ec021164b6969d1d9_3200]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [bronze].[testview_9ea19f17f3a1a85ec021164b6969d1d9_3200]
  ;')
[0m15:38:04.320944 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:38:04.320944 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:38:04.321954 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:38:04.848539 [debug] [Thread-1 (]: SQL status: OK in 1.000 seconds
[0m15:38:04.850469 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74: ROLLBACK
[0m15:38:04.850469 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74: Close
[0m15:38:04.851467 [info ] [Thread-1 (]: 7 of 13 PASS not_null_stg_trips_fare_amount .................................... [[32mPASS[0m in 0.54s]
[0m15:38:04.852482 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74
[0m15:38:04.852482 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c
[0m15:38:04.852482 [info ] [Thread-1 (]: 8 of 13 START test not_null_stg_trips_pickup_datetime .......................... [RUN]
[0m15:38:04.853513 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74, now test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c)
[0m15:38:04.853513 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c
[0m15:38:04.858474 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c"
[0m15:38:04.859479 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c
[0m15:38:04.861477 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c"
[0m15:38:04.862469 [debug] [Thread-1 (]: Using sqlserver connection "test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c"
[0m15:38:04.862469 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c"} */

    -- Create target schema if it does not
  USE [sqldb-taxi-platform];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'bronze')
  BEGIN
    EXEC('CREATE SCHEMA [bronze]')
  END

  

  
  EXEC('create view 
    [bronze].[testview_c8f1217ea7ae423f95431cf67128255c_11232]
   as 
    
    
    



select pickup_datetime
from "sqldb-taxi-platform"."bronze_bronze"."stg_trips"
where pickup_datetime is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [bronze].[testview_c8f1217ea7ae423f95431cf67128255c_11232]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [bronze].[testview_c8f1217ea7ae423f95431cf67128255c_11232]
  ;')
[0m15:38:04.863467 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:38:04.863467 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:38:04.863467 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:38:05.436271 [debug] [Thread-1 (]: SQL status: OK in 1.000 seconds
[0m15:38:05.437304 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c: ROLLBACK
[0m15:38:05.438391 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c: Close
[0m15:38:05.438391 [info ] [Thread-1 (]: 8 of 13 PASS not_null_stg_trips_pickup_datetime ................................ [[32mPASS[0m in 0.58s]
[0m15:38:05.439349 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c
[0m15:38:05.440315 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae
[0m15:38:05.440315 [info ] [Thread-1 (]: 9 of 13 START test not_null_stg_trips_total_amount ............................. [RUN]
[0m15:38:05.441314 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c, now test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae)
[0m15:38:05.441314 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae
[0m15:38:05.445321 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae"
[0m15:38:05.446321 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae
[0m15:38:05.448320 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae"
[0m15:38:05.449321 [debug] [Thread-1 (]: Using sqlserver connection "test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae"
[0m15:38:05.449321 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae"} */

    -- Create target schema if it does not
  USE [sqldb-taxi-platform];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'bronze')
  BEGIN
    EXEC('CREATE SCHEMA [bronze]')
  END

  

  
  EXEC('create view 
    [bronze].[testview_83c247fd7dcf1f459750c2de25501c63_7673]
   as 
    
    
    



select total_amount
from "sqldb-taxi-platform"."bronze_bronze"."stg_trips"
where total_amount is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [bronze].[testview_83c247fd7dcf1f459750c2de25501c63_7673]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [bronze].[testview_83c247fd7dcf1f459750c2de25501c63_7673]
  ;')
[0m15:38:05.449321 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:38:05.450321 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:38:05.450321 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:38:05.987500 [debug] [Thread-1 (]: SQL status: OK in 1.000 seconds
[0m15:38:05.988506 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae: ROLLBACK
[0m15:38:05.989500 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae: Close
[0m15:38:05.989500 [info ] [Thread-1 (]: 9 of 13 PASS not_null_stg_trips_total_amount ................................... [[32mPASS[0m in 0.55s]
[0m15:38:05.990500 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae
[0m15:38:05.990500 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b
[0m15:38:05.991500 [info ] [Thread-1 (]: 10 of 13 START test not_null_stg_trips_trip_distance ........................... [RUN]
[0m15:38:05.991500 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae, now test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b)
[0m15:38:05.992505 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b
[0m15:38:05.995506 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b"
[0m15:38:05.996500 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b
[0m15:38:05.998507 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b"
[0m15:38:05.999505 [debug] [Thread-1 (]: Using sqlserver connection "test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b"
[0m15:38:05.999505 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b"} */

    -- Create target schema if it does not
  USE [sqldb-taxi-platform];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'bronze')
  BEGIN
    EXEC('CREATE SCHEMA [bronze]')
  END

  

  
  EXEC('create view 
    [bronze].[testview_98902cdd2f59126a71dede1190f25913_9727]
   as 
    
    
    



select trip_distance
from "sqldb-taxi-platform"."bronze_bronze"."stg_trips"
where trip_distance is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [bronze].[testview_98902cdd2f59126a71dede1190f25913_9727]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [bronze].[testview_98902cdd2f59126a71dede1190f25913_9727]
  ;')
[0m15:38:06.000500 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:38:06.000500 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:38:06.001499 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:38:06.658555 [debug] [Thread-1 (]: SQL status: OK in 1.000 seconds
[0m15:38:06.659632 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b: ROLLBACK
[0m15:38:06.660638 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b: Close
[0m15:38:06.660638 [info ] [Thread-1 (]: 10 of 13 PASS not_null_stg_trips_trip_distance ................................. [[32mPASS[0m in 0.67s]
[0m15:38:06.661802 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b
[0m15:38:06.661802 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6
[0m15:38:06.662860 [info ] [Thread-1 (]: 11 of 13 START test relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_  [RUN]
[0m15:38:06.662860 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b, now test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6)
[0m15:38:06.663832 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6
[0m15:38:06.667846 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6"
[0m15:38:06.668849 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6
[0m15:38:06.669849 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6"
[0m15:38:06.670846 [debug] [Thread-1 (]: Using sqlserver connection "test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6"
[0m15:38:06.671840 [debug] [Thread-1 (]: On test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6"} */

    -- Create target schema if it does not
  USE [sqldb-taxi-platform];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'bronze')
  BEGIN
    EXEC('CREATE SCHEMA [bronze]')
  END

  

  
  EXEC('create view 
    [bronze].[testview_fe69b692e4963f1fa2cf4dd07e39b696_5822]
   as 
    
    
    

with child as (
    select payment_type as from_field
    from "sqldb-taxi-platform"."bronze_silver"."fact_trips"
    where payment_type is not null
),

parent as (
    select payment_type as to_field
    from "sqldb-taxi-platform"."bronze_silver"."dim_payment_type"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [bronze].[testview_fe69b692e4963f1fa2cf4dd07e39b696_5822]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [bronze].[testview_fe69b692e4963f1fa2cf4dd07e39b696_5822]
  ;')
[0m15:38:06.671840 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:38:06.671840 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:38:06.672851 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:38:06.734066 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:38:06.735138 [debug] [Thread-1 (]: On test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6: ROLLBACK
[0m15:38:06.735138 [debug] [Thread-1 (]: On test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6: Close
[0m15:38:06.736122 [info ] [Thread-1 (]: 11 of 13 PASS relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_  [[32mPASS[0m in 0.07s]
[0m15:38:06.737151 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6
[0m15:38:06.737151 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58
[0m15:38:06.738087 [info ] [Thread-1 (]: 12 of 13 START test unique_dim_payment_type_payment_type ....................... [RUN]
[0m15:38:06.738087 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6, now test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58)
[0m15:38:06.739136 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58
[0m15:38:06.744124 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58"
[0m15:38:06.744124 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58
[0m15:38:06.748124 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58"
[0m15:38:06.749123 [debug] [Thread-1 (]: Using sqlserver connection "test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58"
[0m15:38:06.749123 [debug] [Thread-1 (]: On test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58"} */

    -- Create target schema if it does not
  USE [sqldb-taxi-platform];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'bronze')
  BEGIN
    EXEC('CREATE SCHEMA [bronze]')
  END

  

  
  EXEC('create view 
    [bronze].[testview_5fb5eb828135bf31fab7f64ef24093d1_12264]
   as 
    
    
    

select
    payment_type as unique_field,
    count(*) as n_records

from "sqldb-taxi-platform"."bronze_silver"."dim_payment_type"
where payment_type is not null
group by payment_type
having count(*) > 1



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [bronze].[testview_5fb5eb828135bf31fab7f64ef24093d1_12264]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [bronze].[testview_5fb5eb828135bf31fab7f64ef24093d1_12264]
  ;')
[0m15:38:06.750124 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:38:06.750124 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:38:06.750124 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:38:06.806586 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:38:06.807587 [debug] [Thread-1 (]: On test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58: ROLLBACK
[0m15:38:06.808579 [debug] [Thread-1 (]: On test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58: Close
[0m15:38:06.808579 [info ] [Thread-1 (]: 12 of 13 PASS unique_dim_payment_type_payment_type ............................. [[32mPASS[0m in 0.07s]
[0m15:38:06.809579 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58
[0m15:38:06.809579 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e
[0m15:38:06.810579 [info ] [Thread-1 (]: 13 of 13 START test unique_fact_trips_trip_id .................................. [RUN]
[0m15:38:06.811588 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58, now test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e)
[0m15:38:06.811588 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e
[0m15:38:06.814586 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e"
[0m15:38:06.815688 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e
[0m15:38:06.817589 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e"
[0m15:38:06.818586 [debug] [Thread-1 (]: Using sqlserver connection "test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e"
[0m15:38:06.819579 [debug] [Thread-1 (]: On test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e"} */

    -- Create target schema if it does not
  USE [sqldb-taxi-platform];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'bronze')
  BEGIN
    EXEC('CREATE SCHEMA [bronze]')
  END

  

  
  EXEC('create view 
    [bronze].[testview_2a9748c0e241ec04f816d7766bd33ba6_12254]
   as 
    
    
    

select
    trip_id as unique_field,
    count(*) as n_records

from "sqldb-taxi-platform"."bronze_silver"."fact_trips"
where trip_id is not null
group by trip_id
having count(*) > 1



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [bronze].[testview_2a9748c0e241ec04f816d7766bd33ba6_12254]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [bronze].[testview_2a9748c0e241ec04f816d7766bd33ba6_12254]
  ;')
[0m15:38:06.819579 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:38:06.819579 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:38:06.820589 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:38:06.953232 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:38:06.955225 [debug] [Thread-1 (]: On test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e: ROLLBACK
[0m15:38:06.955225 [debug] [Thread-1 (]: On test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e: Close
[0m15:38:06.956232 [info ] [Thread-1 (]: 13 of 13 PASS unique_fact_trips_trip_id ........................................ [[32mPASS[0m in 0.15s]
[0m15:38:06.957232 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e
[0m15:38:06.958225 [debug] [MainThread]: On master: COMMIT
[0m15:38:06.959226 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:38:06.959226 [debug] [MainThread]: Connection 'list_sqldb-taxi-platform_bronze_gold' was properly closed.
[0m15:38:06.959226 [debug] [MainThread]: Connection 'test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e' was properly closed.
[0m15:38:06.960225 [info ] [MainThread]: 
[0m15:38:06.960225 [info ] [MainThread]: Finished running 13 data tests in 0 hours 0 minutes and 5.25 seconds (5.25s).
[0m15:38:06.963491 [debug] [MainThread]: Command end result
[0m15:38:06.985492 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\manifest.json
[0m15:38:06.987429 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\semantic_manifest.json
[0m15:38:06.993431 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\run_results.json
[0m15:38:06.993431 [info ] [MainThread]: 
[0m15:38:06.994261 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:38:06.994261 [info ] [MainThread]: 
[0m15:38:06.995269 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=13
[0m15:38:06.996277 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 3 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:38:06.997275 [debug] [MainThread]: Command `dbt test` succeeded at 15:38:06.997275 after 7.17 seconds
[0m15:38:06.997275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CFE58F850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CFE513350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CFE512750>]}
[0m15:38:06.998267 [debug] [MainThread]: Flushing usage events
[0m15:38:07.743343 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:38:09.457310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD859B0F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD859E6C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD859E4CD0>]}


============================== 15:38:09.460309 | 4f5164d3-c9ae-44e2-952c-56c0b5104579 ==============================
[0m15:38:09.460309 [info ] [MainThread]: Running with dbt=1.10.15
[0m15:38:09.461308 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'profiles_dir': '.', 'log_format': 'default', 'invocation_command': 'dbt docs generate --profiles-dir . --no-partial-parse', 'write_json': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\alexm\\Desktop\\python\\azure-taxi-platform\\dbt_project\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m15:38:09.777876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f5164d3-c9ae-44e2-952c-56c0b5104579', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD87102310>]}
[0m15:38:09.827953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4f5164d3-c9ae-44e2-952c-56c0b5104579', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD849A1610>]}
[0m15:38:09.828952 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m15:38:10.052124 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m15:38:10.053125 [debug] [MainThread]: Partial parsing not enabled
[0m15:38:11.088835 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m15:38:11.089455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4f5164d3-c9ae-44e2-952c-56c0b5104579', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD878D4710>]}
[0m15:38:11.186418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f5164d3-c9ae-44e2-952c-56c0b5104579', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD87855510>]}
[0m15:38:11.209917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f5164d3-c9ae-44e2-952c-56c0b5104579', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD879D3790>]}
[0m15:38:11.210917 [info ] [MainThread]: Found 7 models, 13 data tests, 535 macros
[0m15:38:11.211577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f5164d3-c9ae-44e2-952c-56c0b5104579', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD87902350>]}
[0m15:38:11.213740 [info ] [MainThread]: 
[0m15:38:11.214249 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:38:11.214249 [info ] [MainThread]: 
[0m15:38:11.215247 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m15:38:11.220475 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_sqldb-taxi-platform_bronze_gold'
[0m15:38:11.232046 [debug] [ThreadPool]: dbt-sqlserver
[0m15:38:11.233046 [debug] [ThreadPool]: Using sqlserver connection "list_sqldb-taxi-platform_bronze_gold"
[0m15:38:11.233046 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_gold: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "list_sqldb-taxi-platform_bronze_gold"} */
USE [sqldb-taxi-platform];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze_gold'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m15:38:11.234046 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:38:11.234046 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:38:11.696854 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:38:11.743480 [debug] [ThreadPool]: SQL status: OK in 1.000 seconds
[0m15:38:11.745064 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_gold: ROLLBACK
[0m15:38:11.745576 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_gold: Close
[0m15:38:11.745576 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sqldb-taxi-platform_bronze_gold, now list_sqldb-taxi-platform_bronze_silver)
[0m15:38:11.748575 [debug] [ThreadPool]: dbt-sqlserver
[0m15:38:11.749575 [debug] [ThreadPool]: Using sqlserver connection "list_sqldb-taxi-platform_bronze_silver"
[0m15:38:11.749575 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "list_sqldb-taxi-platform_bronze_silver"} */
USE [sqldb-taxi-platform];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze_silver'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m15:38:11.749575 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:38:11.750575 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:38:11.750575 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:38:11.797196 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:38:11.798236 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_silver: ROLLBACK
[0m15:38:11.799234 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_silver: Close
[0m15:38:11.799234 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sqldb-taxi-platform_bronze_silver, now list_sqldb-taxi-platform_bronze_bronze)
[0m15:38:11.802234 [debug] [ThreadPool]: dbt-sqlserver
[0m15:38:11.802234 [debug] [ThreadPool]: Using sqlserver connection "list_sqldb-taxi-platform_bronze_bronze"
[0m15:38:11.803234 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "list_sqldb-taxi-platform_bronze_bronze"} */
USE [sqldb-taxi-platform];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze_bronze'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m15:38:11.803234 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:38:11.803234 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:38:11.804234 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:38:11.850060 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:38:11.851636 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_bronze: ROLLBACK
[0m15:38:11.852150 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_bronze: Close
[0m15:38:11.853197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f5164d3-c9ae-44e2-952c-56c0b5104579', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD878A1D10>]}
[0m15:38:11.856829 [debug] [Thread-1 (]: Began running node model.taxi_nyc_project.dim_payment_type
[0m15:38:11.857844 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'model.taxi_nyc_project.dim_payment_type'
[0m15:38:11.857965 [debug] [Thread-1 (]: Began compiling node model.taxi_nyc_project.dim_payment_type
[0m15:38:11.865162 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_nyc_project.dim_payment_type"
[0m15:38:11.866180 [debug] [Thread-1 (]: Began executing node model.taxi_nyc_project.dim_payment_type
[0m15:38:11.867335 [debug] [Thread-1 (]: Finished running node model.taxi_nyc_project.dim_payment_type
[0m15:38:11.867438 [debug] [Thread-1 (]: Began running node model.taxi_nyc_project.stg_trips
[0m15:38:11.868322 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_nyc_project.dim_payment_type, now model.taxi_nyc_project.stg_trips)
[0m15:38:11.868849 [debug] [Thread-1 (]: Began compiling node model.taxi_nyc_project.stg_trips
[0m15:38:11.871055 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_nyc_project.stg_trips"
[0m15:38:11.872112 [debug] [Thread-1 (]: Began executing node model.taxi_nyc_project.stg_trips
[0m15:38:11.872639 [debug] [Thread-1 (]: Finished running node model.taxi_nyc_project.stg_trips
[0m15:38:11.873177 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626
[0m15:38:11.873714 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_nyc_project.stg_trips, now test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626)
[0m15:38:11.874253 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626
[0m15:38:11.880616 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626"
[0m15:38:11.882615 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626
[0m15:38:11.882615 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626
[0m15:38:11.883557 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58
[0m15:38:11.884104 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626, now test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58)
[0m15:38:11.884621 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58
[0m15:38:11.889192 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58"
[0m15:38:11.890192 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58
[0m15:38:11.891192 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58
[0m15:38:11.891338 [debug] [Thread-1 (]: Began running node model.taxi_nyc_project.fact_trips
[0m15:38:11.891870 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58, now model.taxi_nyc_project.fact_trips)
[0m15:38:11.892395 [debug] [Thread-1 (]: Began compiling node model.taxi_nyc_project.fact_trips
[0m15:38:11.894559 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_nyc_project.fact_trips"
[0m15:38:11.895560 [debug] [Thread-1 (]: Began executing node model.taxi_nyc_project.fact_trips
[0m15:38:11.896561 [debug] [Thread-1 (]: Finished running node model.taxi_nyc_project.fact_trips
[0m15:38:11.896561 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec
[0m15:38:11.897561 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_nyc_project.fact_trips, now test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec)
[0m15:38:11.897561 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec
[0m15:38:11.900561 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec"
[0m15:38:11.901560 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec
[0m15:38:11.902561 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec
[0m15:38:11.902561 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d
[0m15:38:11.902561 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec, now test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d)
[0m15:38:11.903561 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d
[0m15:38:11.906561 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d"
[0m15:38:11.907561 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d
[0m15:38:11.907561 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d
[0m15:38:11.908603 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b
[0m15:38:11.909122 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d, now test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b)
[0m15:38:11.909122 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b
[0m15:38:11.912648 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b"
[0m15:38:11.913697 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b
[0m15:38:11.913697 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b
[0m15:38:11.914699 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74
[0m15:38:11.914699 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b, now test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74)
[0m15:38:11.914699 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74
[0m15:38:11.918699 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74"
[0m15:38:11.919700 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74
[0m15:38:11.920804 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74
[0m15:38:11.920909 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c
[0m15:38:11.921441 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74, now test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c)
[0m15:38:11.921974 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c
[0m15:38:11.925562 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c"
[0m15:38:11.926562 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c
[0m15:38:11.927561 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c
[0m15:38:11.928562 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae
[0m15:38:11.928562 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c, now test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae)
[0m15:38:11.928562 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae
[0m15:38:11.932195 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae"
[0m15:38:11.933253 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae
[0m15:38:11.933253 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae
[0m15:38:11.934254 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b
[0m15:38:11.934254 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae, now test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b)
[0m15:38:11.935254 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b
[0m15:38:11.938254 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b"
[0m15:38:11.939254 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b
[0m15:38:11.939879 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b
[0m15:38:11.940472 [debug] [Thread-1 (]: Began running node model.taxi_nyc_project.mart_daily_revenue
[0m15:38:11.941019 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b, now model.taxi_nyc_project.mart_daily_revenue)
[0m15:38:11.941019 [debug] [Thread-1 (]: Began compiling node model.taxi_nyc_project.mart_daily_revenue
[0m15:38:11.943537 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_nyc_project.mart_daily_revenue"
[0m15:38:11.944541 [debug] [Thread-1 (]: Began executing node model.taxi_nyc_project.mart_daily_revenue
[0m15:38:11.945539 [debug] [Thread-1 (]: Finished running node model.taxi_nyc_project.mart_daily_revenue
[0m15:38:11.945539 [debug] [Thread-1 (]: Began running node model.taxi_nyc_project.mart_tip_by_payment_type
[0m15:38:11.945539 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_nyc_project.mart_daily_revenue, now model.taxi_nyc_project.mart_tip_by_payment_type)
[0m15:38:11.946538 [debug] [Thread-1 (]: Began compiling node model.taxi_nyc_project.mart_tip_by_payment_type
[0m15:38:11.949500 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_nyc_project.mart_tip_by_payment_type"
[0m15:38:11.950129 [debug] [Thread-1 (]: Began executing node model.taxi_nyc_project.mart_tip_by_payment_type
[0m15:38:11.950711 [debug] [Thread-1 (]: Finished running node model.taxi_nyc_project.mart_tip_by_payment_type
[0m15:38:11.951316 [debug] [Thread-1 (]: Began running node model.taxi_nyc_project.mart_trips_by_hour
[0m15:38:11.952084 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_nyc_project.mart_tip_by_payment_type, now model.taxi_nyc_project.mart_trips_by_hour)
[0m15:38:11.952614 [debug] [Thread-1 (]: Began compiling node model.taxi_nyc_project.mart_trips_by_hour
[0m15:38:11.954792 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_nyc_project.mart_trips_by_hour"
[0m15:38:11.955861 [debug] [Thread-1 (]: Began executing node model.taxi_nyc_project.mart_trips_by_hour
[0m15:38:11.956404 [debug] [Thread-1 (]: Finished running node model.taxi_nyc_project.mart_trips_by_hour
[0m15:38:11.956970 [debug] [Thread-1 (]: Began running node model.taxi_nyc_project.mart_zone_revenue
[0m15:38:11.957516 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_nyc_project.mart_trips_by_hour, now model.taxi_nyc_project.mart_zone_revenue)
[0m15:38:11.958049 [debug] [Thread-1 (]: Began compiling node model.taxi_nyc_project.mart_zone_revenue
[0m15:38:11.960170 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_nyc_project.mart_zone_revenue"
[0m15:38:11.961238 [debug] [Thread-1 (]: Began executing node model.taxi_nyc_project.mart_zone_revenue
[0m15:38:11.961792 [debug] [Thread-1 (]: Finished running node model.taxi_nyc_project.mart_zone_revenue
[0m15:38:11.962315 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c
[0m15:38:11.962315 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_nyc_project.mart_zone_revenue, now test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c)
[0m15:38:11.962853 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c
[0m15:38:11.966055 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c"
[0m15:38:11.967106 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c
[0m15:38:11.967652 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c
[0m15:38:11.968177 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442
[0m15:38:11.968177 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c, now test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442)
[0m15:38:11.968724 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442
[0m15:38:11.972223 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442"
[0m15:38:11.972748 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442
[0m15:38:11.973275 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442
[0m15:38:11.973797 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6
[0m15:38:11.974313 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442, now test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6)
[0m15:38:11.974313 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6
[0m15:38:11.978314 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6"
[0m15:38:11.979314 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6
[0m15:38:11.979314 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6
[0m15:38:11.980314 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e
[0m15:38:11.980314 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6, now test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e)
[0m15:38:11.981353 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e
[0m15:38:11.985677 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e"
[0m15:38:11.986735 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e
[0m15:38:11.987402 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e
[0m15:38:11.987925 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:38:11.988445 [debug] [MainThread]: Connection 'list_sqldb-taxi-platform_bronze_bronze' was properly closed.
[0m15:38:11.989014 [debug] [MainThread]: Connection 'test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e' was properly closed.
[0m15:38:11.991193 [debug] [MainThread]: Command end result
[0m15:38:12.055232 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\manifest.json
[0m15:38:12.058227 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\semantic_manifest.json
[0m15:38:12.064761 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\run_results.json
[0m15:38:12.066857 [debug] [MainThread]: Acquiring new sqlserver connection 'generate_catalog'
[0m15:38:12.067367 [info ] [MainThread]: Building catalog
[0m15:38:12.075193 [debug] [ThreadPool]: Acquiring new sqlserver connection 'sqldb-taxi-platform.information_schema'
[0m15:38:12.136335 [debug] [ThreadPool]: dbt-sqlserver
[0m15:38:12.137335 [debug] [ThreadPool]: Using sqlserver connection "sqldb-taxi-platform.information_schema"
[0m15:38:12.137335 [debug] [ThreadPool]: On sqldb-taxi-platform.information_schema: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "sqldb-taxi-platform.information_schema"} */
with
    principals as (
        select
            name as principal_name,
            principal_id as principal_id
        from
            sys.database_principals with (nolock)
    ),

    schemas as (
        select
            name as schema_name,
            schema_id as schema_id,
            principal_id as principal_id
        from
            sys.schemas with (nolock)
    ),

    tables as (
        select
            object_id,
            name as table_name,
            schema_id as schema_id,
            principal_id as principal_id,
            'BASE TABLE' as table_type
        from
            sys.tables with (nolock)
    ),

    tables_with_metadata as (
        select
            object_id,
            table_name,
            schema_name,
            coalesce(tables.principal_id, schemas.principal_id) as owner_principal_id,
            table_type
        from
            tables
        join schemas on tables.schema_id = schemas.schema_id
    ),

    views as (
        select
            object_id,
            name as table_name,
            schema_id as schema_id,
            principal_id as principal_id,
            'VIEW' as table_type
        from
            sys.views with (nolock)
    ),

    views_with_metadata as (
        select
            object_id,
            table_name,
            schema_name,
            coalesce(views.principal_id, schemas.principal_id) as owner_principal_id,
            table_type
        from
            views
        join schemas on views.schema_id = schemas.schema_id
    ),

    tables_and_views as (
        select
            object_id,
            table_name,
            schema_name,
            principal_name,
            table_type
        from
            tables_with_metadata
        join principals on tables_with_metadata.owner_principal_id = principals.principal_id
        union all
        select
            object_id,
            table_name,
            schema_name,
            principal_name,
            table_type
        from
            views_with_metadata
        join principals on views_with_metadata.owner_principal_id = principals.principal_id
    ),

    cols as (

        select
            c.object_id,
            c.name as column_name,
            c.column_id as column_index,
            t.name as column_type
        from sys.columns as c with (nolock)
        left join sys.types as t on c.system_type_id = t.system_type_id
    )

    select
        DB_NAME() as table_database,
        tv.schema_name as table_schema,
        tv.table_name,
        tv.table_type,
        null as table_comment,
        tv.principal_name as table_owner,
        cols.column_name,
        cols.column_index,
        cols.column_type,
        null as column_comment
    from tables_and_views tv
    join cols on tv.object_id = cols.object_id
    where (
                (
                    upper(tv.schema_name) = upper('bronze_gold')
                    and upper(tv.table_name) = upper('mart_zone_revenue')
                )
             or 
                (
                    upper(tv.schema_name) = upper('bronze_gold')
                    and upper(tv.table_name) = upper('mart_trips_by_hour')
                )
             or 
                (
                    upper(tv.schema_name) = upper('bronze_gold')
                    and upper(tv.table_name) = upper('mart_tip_by_payment_type')
                )
             or 
                (
                    upper(tv.schema_name) = upper('bronze_silver')
                    and upper(tv.table_name) = upper('dim_payment_type')
                )
             or 
                (
                    upper(tv.schema_name) = upper('bronze_gold')
                    and upper(tv.table_name) = upper('mart_daily_revenue')
                )
             or 
                (
                    upper(tv.schema_name) = upper('bronze_bronze')
                    and upper(tv.table_name) = upper('stg_trips')
                )
             or 
                (
                    upper(tv.schema_name) = upper('bronze_silver')
                    and upper(tv.table_name) = upper('fact_trips')
                )
            )

    order by column_index
    
    OPTION (LABEL = 'dbt-sqlserver');

[0m15:38:12.138335 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:38:12.138335 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m15:38:12.138335 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m15:38:12.288433 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:38:12.291662 [debug] [ThreadPool]: On sqldb-taxi-platform.information_schema: ROLLBACK
[0m15:38:12.292174 [debug] [ThreadPool]: On sqldb-taxi-platform.information_schema: Close
[0m15:38:12.302080 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\catalog.json
[0m15:38:12.329224 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\manifest.json
[0m15:38:12.332580 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\semantic_manifest.json
[0m15:38:12.333089 [info ] [MainThread]: Catalog written to C:\Users\alexm\Desktop\python\azure-taxi-platform\dbt_project\target\catalog.json
[0m15:38:12.333811 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 3 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:38:12.334913 [debug] [MainThread]: Command `dbt docs generate` succeeded at 15:38:12.334913 after 2.94 seconds
[0m15:38:12.335483 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m15:38:12.335483 [debug] [MainThread]: Connection 'sqldb-taxi-platform.information_schema' was properly closed.
[0m15:38:12.335995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD85756310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD845FE2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDFEF12950>]}
[0m15:38:12.335995 [debug] [MainThread]: Flushing usage events
[0m15:38:13.069560 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:39:39.722459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020656531510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020656531750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020656530B10>]}


============================== 15:39:39.726465 | f9806b18-826e-4e8c-8ef4-13f3c564c7f4 ==============================
[0m15:39:39.726465 [info ] [MainThread]: Running with dbt=1.10.15
[0m15:39:39.726465 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'log_format': 'default', 'no_print': 'None', 'write_json': 'True', 'invocation_command': 'dbt docs serve --profiles-dir . --no-partial-parse', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\alexm\\Desktop\\python\\azure-taxi-platform\\dbt_project\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m15:39:40.046475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f9806b18-826e-4e8c-8ef4-13f3c564c7f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020657E34F90>]}
[0m15:39:40.094519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f9806b18-826e-4e8c-8ef4-13f3c564c7f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206555215D0>]}
[0m20:11:01.489355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6f6165e490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6f6147db90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6f61474cd0>]}


============================== 20:11:01.497340 | b4879272-2c2d-4dfd-a6ff-fe06ab2f368f ==============================
[0m20:11:01.497340 [info ] [MainThread]: Running with dbt=1.10.0
[0m20:11:01.498525 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_profile', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/dbt_profile', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:11:01.843917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b4879272-2c2d-4dfd-a6ff-fe06ab2f368f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6f6027ce90>]}
[0m20:11:01.891989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b4879272-2c2d-4dfd-a6ff-fe06ab2f368f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6f604da190>]}
[0m20:11:01.896238 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m20:11:01.972698 [debug] [MainThread]: checksum: 7f68a7785a72ec903908acd64ff91bcd043d0ce8a90a7375d2cd5f3d875e6fed, vars: {}, profile: , target: , version: 1.10.0
[0m20:11:02.072293 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m20:11:02.074309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b4879272-2c2d-4dfd-a6ff-fe06ab2f368f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6f5fff2e50>]}
[0m20:11:03.319613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b4879272-2c2d-4dfd-a6ff-fe06ab2f368f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6f5fe5a610>]}
[0m20:11:03.402124 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m20:11:03.413354 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m20:11:03.464418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b4879272-2c2d-4dfd-a6ff-fe06ab2f368f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6f5ddbb290>]}
[0m20:11:03.465657 [info ] [MainThread]: Found 7 models, 13 data tests, 510 macros
[0m20:11:03.466592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4879272-2c2d-4dfd-a6ff-fe06ab2f368f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6f60070c50>]}
[0m20:11:03.468839 [info ] [MainThread]: 
[0m20:11:03.469658 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:11:03.470331 [info ] [MainThread]: 
[0m20:11:03.471148 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m20:11:03.476661 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_sqldb-taxi-platform'
[0m20:11:03.489865 [debug] [ThreadPool]: dbt-sqlserver
[0m20:11:03.491149 [debug] [ThreadPool]: Using sqlserver connection "list_sqldb-taxi-platform"
[0m20:11:03.492135 [debug] [ThreadPool]: On list_sqldb-taxi-platform: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "list_sqldb-taxi-platform"} */
USE [sqldb-taxi-platform];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m20:11:03.493096 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:11:03.494070 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m20:11:04.123902 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m20:11:04.172123 [debug] [ThreadPool]: SQL status: OK in 1.000 seconds
[0m20:11:04.174310 [debug] [ThreadPool]: On list_sqldb-taxi-platform: Close
[0m20:11:04.179652 [debug] [ThreadPool]: dbt-sqlserver
[0m20:11:04.181071 [debug] [ThreadPool]: Using sqlserver connection "list_sqldb-taxi-platform"
[0m20:11:04.181832 [debug] [ThreadPool]: On list_sqldb-taxi-platform: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "list_sqldb-taxi-platform"} */
USE [sqldb-taxi-platform];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m20:11:04.182582 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:11:04.183323 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m20:11:04.483439 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m20:11:04.534696 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:11:04.537125 [debug] [ThreadPool]: On list_sqldb-taxi-platform: Close
[0m20:11:04.541636 [debug] [ThreadPool]: dbt-sqlserver
[0m20:11:04.542995 [debug] [ThreadPool]: Using sqlserver connection "list_sqldb-taxi-platform"
[0m20:11:04.543985 [debug] [ThreadPool]: On list_sqldb-taxi-platform: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "list_sqldb-taxi-platform"} */
USE [sqldb-taxi-platform];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m20:11:04.544766 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:11:04.545594 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m20:11:04.824569 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m20:11:04.873494 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:11:04.876627 [debug] [ThreadPool]: On list_sqldb-taxi-platform: Close
[0m20:11:04.881089 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sqldb-taxi-platform, now list_sqldb-taxi-platform_bronze_gold)
[0m20:11:04.886889 [debug] [ThreadPool]: dbt-sqlserver
[0m20:11:04.888044 [debug] [ThreadPool]: Using sqlserver connection "list_sqldb-taxi-platform_bronze_gold"
[0m20:11:04.888863 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_gold: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "list_sqldb-taxi-platform_bronze_gold"} */
USE [sqldb-taxi-platform];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze_gold'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m20:11:04.889606 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:11:04.890343 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m20:11:05.210801 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m20:11:05.289376 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:11:05.292270 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_gold: ROLLBACK
[0m20:11:05.294108 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_gold: Close
[0m20:11:05.296911 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sqldb-taxi-platform_bronze_gold, now list_sqldb-taxi-platform_bronze_silver)
[0m20:11:05.300478 [debug] [ThreadPool]: dbt-sqlserver
[0m20:11:05.301250 [debug] [ThreadPool]: Using sqlserver connection "list_sqldb-taxi-platform_bronze_silver"
[0m20:11:05.301996 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_silver: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "list_sqldb-taxi-platform_bronze_silver"} */
USE [sqldb-taxi-platform];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze_silver'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m20:11:05.302635 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:11:05.303350 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m20:11:05.621317 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m20:11:05.696958 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:11:05.699623 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_silver: ROLLBACK
[0m20:11:05.700736 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_silver: Close
[0m20:11:05.703189 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sqldb-taxi-platform_bronze_silver, now list_sqldb-taxi-platform_bronze_bronze)
[0m20:11:05.707274 [debug] [ThreadPool]: dbt-sqlserver
[0m20:11:05.708287 [debug] [ThreadPool]: Using sqlserver connection "list_sqldb-taxi-platform_bronze_bronze"
[0m20:11:05.709325 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_bronze: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "list_sqldb-taxi-platform_bronze_bronze"} */
USE [sqldb-taxi-platform];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze_bronze'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m20:11:05.710127 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:11:05.710969 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m20:11:05.987896 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m20:11:06.058338 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:11:06.061455 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_bronze: ROLLBACK
[0m20:11:06.062889 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_bronze: Close
[0m20:11:06.065776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4879272-2c2d-4dfd-a6ff-fe06ab2f368f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6f5fff3650>]}
[0m20:11:06.066811 [debug] [MainThread]: On master: COMMIT
[0m20:11:06.071641 [debug] [Thread-1 (]: Began running node model.taxi_nyc_project.dim_payment_type
[0m20:11:06.072600 [info ] [Thread-1 (]: 1 of 7 START sql table model bronze_silver.dim_payment_type .................... [RUN]
[0m20:11:06.073434 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sqldb-taxi-platform_bronze_bronze, now model.taxi_nyc_project.dim_payment_type)
[0m20:11:06.074229 [debug] [Thread-1 (]: Began compiling node model.taxi_nyc_project.dim_payment_type
[0m20:11:06.080960 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_nyc_project.dim_payment_type"
[0m20:11:06.099290 [debug] [Thread-1 (]: Began executing node model.taxi_nyc_project.dim_payment_type
[0m20:11:06.130466 [debug] [Thread-1 (]: dbt-sqlserver
[0m20:11:06.138077 [debug] [Thread-1 (]: Applying DROP to: "sqldb-taxi-platform"."bronze_silver"."dim_payment_type__dbt_tmp__dbt_tmp_vw"
[0m20:11:06.144329 [debug] [Thread-1 (]: dbt-sqlserver
[0m20:11:06.146424 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.dim_payment_type"
[0m20:11:06.147685 [debug] [Thread-1 (]: On model.taxi_nyc_project.dim_payment_type: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.dim_payment_type"} */

        USE [sqldb-taxi-platform];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'sqldb-taxi-platform'
        and refs.referenced_schema_name = 'bronze_silver'
        and refs.referenced_entity_name = 'dim_payment_type__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m20:11:06.149057 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:11:06.149913 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m20:11:06.436244 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m20:11:06.497175 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:11:06.500022 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.dim_payment_type"
[0m20:11:06.501243 [debug] [Thread-1 (]: On model.taxi_nyc_project.dim_payment_type: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.dim_payment_type"} */

      
      
    
    USE [sqldb-taxi-platform];
    EXEC('DROP view IF EXISTS "bronze_silver"."dim_payment_type__dbt_tmp__dbt_tmp_vw";');

[0m20:11:06.548220 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:11:06.562134 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_nyc_project.dim_payment_type"
[0m20:11:06.586602 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.dim_payment_type"
[0m20:11:06.587766 [debug] [Thread-1 (]: On model.taxi_nyc_project.dim_payment_type: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.dim_payment_type"} */

  
    USE [sqldb-taxi-platform];
    USE [sqldb-taxi-platform];
    
    

    

    
    USE [sqldb-taxi-platform];
    EXEC('
        create view "bronze_silver"."dim_payment_type__dbt_tmp__dbt_tmp_vw" as 

select * from (
    values
        (1, ''Credit card''),
        (2, ''Cash''),
        (3, ''No charge''),
        (4, ''Dispute''),
        (5, ''Unknown''),
        (6, ''Voided trip'')
) as t(payment_type, payment_type_desc);
    ')

EXEC('
            SELECT * INTO "sqldb-taxi-platform"."bronze_silver"."dim_payment_type__dbt_tmp" FROM "sqldb-taxi-platform"."bronze_silver"."dim_payment_type__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS bronze_silver.dim_payment_type__dbt_tmp__dbt_tmp_vw')



    
    use [sqldb-taxi-platform];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'bronze_silver_dim_payment_type__dbt_tmp_cci'
        AND object_id=object_id('bronze_silver_dim_payment_type__dbt_tmp')
    )
    DROP index "bronze_silver"."dim_payment_type__dbt_tmp".bronze_silver_dim_payment_type__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX bronze_silver_dim_payment_type__dbt_tmp_cci
    ON "bronze_silver"."dim_payment_type__dbt_tmp"

   


  
[0m20:11:06.671536 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:11:06.679656 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.dim_payment_type"
[0m20:11:06.681597 [debug] [Thread-1 (]: On model.taxi_nyc_project.dim_payment_type: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.dim_payment_type"} */
USE [sqldb-taxi-platform];
      EXEC sp_rename 'bronze_silver.dim_payment_type', 'dim_payment_type__dbt_backup'
[0m20:11:07.064582 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:11:07.068745 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.dim_payment_type"
[0m20:11:07.069908 [debug] [Thread-1 (]: On model.taxi_nyc_project.dim_payment_type: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.dim_payment_type"} */
USE [sqldb-taxi-platform];
      EXEC sp_rename 'bronze_silver.dim_payment_type__dbt_tmp', 'dim_payment_type'
[0m20:11:07.120905 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:11:07.137400 [debug] [Thread-1 (]: On model.taxi_nyc_project.dim_payment_type: COMMIT
[0m20:11:07.141123 [debug] [Thread-1 (]: Applying DROP to: "sqldb-taxi-platform"."bronze_silver"."dim_payment_type__dbt_backup"
[0m20:11:07.143350 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.dim_payment_type"
[0m20:11:07.144835 [debug] [Thread-1 (]: On model.taxi_nyc_project.dim_payment_type: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.dim_payment_type"} */

      
    USE [sqldb-taxi-platform];
    EXEC('DROP table IF EXISTS "bronze_silver"."dim_payment_type__dbt_backup";');

[0m20:11:07.199785 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:11:07.202998 [debug] [Thread-1 (]: On model.taxi_nyc_project.dim_payment_type: Close
[0m20:11:07.206594 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4879272-2c2d-4dfd-a6ff-fe06ab2f368f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6f5dd67810>]}
[0m20:11:07.208159 [info ] [Thread-1 (]: 1 of 7 OK created sql table model bronze_silver.dim_payment_type ............... [[32mOK[0m in 1.13s]
[0m20:11:07.209797 [debug] [Thread-1 (]: Finished running node model.taxi_nyc_project.dim_payment_type
[0m20:11:07.211153 [debug] [Thread-1 (]: Began running node model.taxi_nyc_project.stg_trips
[0m20:11:07.212177 [info ] [Thread-1 (]: 2 of 7 START sql table model bronze_bronze.stg_trips ........................... [RUN]
[0m20:11:07.213210 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_nyc_project.dim_payment_type, now model.taxi_nyc_project.stg_trips)
[0m20:11:07.213987 [debug] [Thread-1 (]: Began compiling node model.taxi_nyc_project.stg_trips
[0m20:11:07.218274 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_nyc_project.stg_trips"
[0m20:11:07.235651 [debug] [Thread-1 (]: Began executing node model.taxi_nyc_project.stg_trips
[0m20:11:07.239628 [debug] [Thread-1 (]: dbt-sqlserver
[0m20:11:07.242494 [debug] [Thread-1 (]: Applying DROP to: "sqldb-taxi-platform"."bronze_bronze"."stg_trips__dbt_tmp__dbt_tmp_vw"
[0m20:11:07.244628 [debug] [Thread-1 (]: dbt-sqlserver
[0m20:11:07.246004 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.stg_trips"
[0m20:11:07.247203 [debug] [Thread-1 (]: On model.taxi_nyc_project.stg_trips: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.stg_trips"} */

        USE [sqldb-taxi-platform];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'sqldb-taxi-platform'
        and refs.referenced_schema_name = 'bronze_bronze'
        and refs.referenced_entity_name = 'stg_trips__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m20:11:07.248210 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:11:07.249044 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m20:11:07.546935 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m20:11:07.607720 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:11:07.611345 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.stg_trips"
[0m20:11:07.613451 [debug] [Thread-1 (]: On model.taxi_nyc_project.stg_trips: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.stg_trips"} */

      
      
    
    USE [sqldb-taxi-platform];
    EXEC('DROP view IF EXISTS "bronze_bronze"."stg_trips__dbt_tmp__dbt_tmp_vw";');

[0m20:11:07.660782 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:11:07.665532 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_nyc_project.stg_trips"
[0m20:11:07.685437 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.stg_trips"
[0m20:11:07.686456 [debug] [Thread-1 (]: On model.taxi_nyc_project.stg_trips: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.stg_trips"} */

  
    USE [sqldb-taxi-platform];
    USE [sqldb-taxi-platform];
    
    

    

    
    USE [sqldb-taxi-platform];
    EXEC('
        create view "bronze_bronze"."stg_trips__dbt_tmp__dbt_tmp_vw" as 

select
    cast(VendorID as int)                             as vendor_id,
    cast(tpep_pickup_datetime as datetime2)           as pickup_datetime,
    cast(tpep_dropoff_datetime as datetime2)          as dropoff_datetime,
    cast(passenger_count as int)                      as passenger_count,
    cast(trip_distance as float)                      as trip_distance,
    cast(RatecodeID as int)                           as rate_code_id,
    upper(store_and_fwd_flag)                         as store_and_fwd_flag,
    cast(PULocationID as int)                         as pu_location_id,
    cast(DOLocationID as int)                         as do_location_id,
    cast(payment_type as int)                         as payment_type,
    cast(fare_amount as decimal(10,2))                as fare_amount,
    cast(extra as decimal(10,2))                      as extra,
    cast(mta_tax as decimal(10,2))                    as mta_tax,
    cast(tip_amount as decimal(10,2))                 as tip_amount,
    cast(tolls_amount as decimal(10,2))               as tolls_amount,
    cast(improvement_surcharge as decimal(10,2))      as improvement_surcharge,
    cast(total_amount as decimal(10,2))               as total_amount,
    cast(congestion_surcharge as decimal(10,2))       as congestion_surcharge,
    cast(Airport_fee as decimal(10,2))                as airport_fee,
    cast(cbd_congestion_fee as decimal(10,2))         as cbd_congestion_fee
from raw.yellow_trips_2025_08
where
    trip_distance >= 0
    and fare_amount >= 0
    and total_amount >= 0
    and tpep_pickup_datetime is not null
    and tpep_dropoff_datetime is not null
    and tpep_dropoff_datetime >= tpep_pickup_datetime;;
    ')

EXEC('
            SELECT * INTO "sqldb-taxi-platform"."bronze_bronze"."stg_trips__dbt_tmp" FROM "sqldb-taxi-platform"."bronze_bronze"."stg_trips__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS bronze_bronze.stg_trips__dbt_tmp__dbt_tmp_vw')



    
    use [sqldb-taxi-platform];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'bronze_bronze_stg_trips__dbt_tmp_cci'
        AND object_id=object_id('bronze_bronze_stg_trips__dbt_tmp')
    )
    DROP index "bronze_bronze"."stg_trips__dbt_tmp".bronze_bronze_stg_trips__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX bronze_bronze_stg_trips__dbt_tmp_cci
    ON "bronze_bronze"."stg_trips__dbt_tmp"

   


  
[0m20:11:31.658853 [debug] [Thread-1 (]: SQL status: OK in 24.000 seconds
[0m20:11:31.664103 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.stg_trips"
[0m20:11:31.665191 [debug] [Thread-1 (]: On model.taxi_nyc_project.stg_trips: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.stg_trips"} */
USE [sqldb-taxi-platform];
      EXEC sp_rename 'bronze_bronze.stg_trips', 'stg_trips__dbt_backup'
[0m20:11:31.714549 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:11:31.718438 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.stg_trips"
[0m20:11:31.719354 [debug] [Thread-1 (]: On model.taxi_nyc_project.stg_trips: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.stg_trips"} */
USE [sqldb-taxi-platform];
      EXEC sp_rename 'bronze_bronze.stg_trips__dbt_tmp', 'stg_trips'
[0m20:11:31.768276 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:11:31.770892 [debug] [Thread-1 (]: On model.taxi_nyc_project.stg_trips: COMMIT
[0m20:11:31.773670 [debug] [Thread-1 (]: Applying DROP to: "sqldb-taxi-platform"."bronze_bronze"."stg_trips__dbt_backup"
[0m20:11:31.775144 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.stg_trips"
[0m20:11:31.776661 [debug] [Thread-1 (]: On model.taxi_nyc_project.stg_trips: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.stg_trips"} */

      
    USE [sqldb-taxi-platform];
    EXEC('DROP table IF EXISTS "bronze_bronze"."stg_trips__dbt_backup";');

[0m20:11:31.830781 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:11:31.833020 [debug] [Thread-1 (]: On model.taxi_nyc_project.stg_trips: Close
[0m20:11:31.834992 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4879272-2c2d-4dfd-a6ff-fe06ab2f368f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6f5df011d0>]}
[0m20:11:31.836162 [info ] [Thread-1 (]: 2 of 7 OK created sql table model bronze_bronze.stg_trips ...................... [[32mOK[0m in 24.62s]
[0m20:11:31.837253 [debug] [Thread-1 (]: Finished running node model.taxi_nyc_project.stg_trips
[0m20:11:31.838704 [debug] [Thread-1 (]: Began running node model.taxi_nyc_project.fact_trips
[0m20:11:31.839589 [info ] [Thread-1 (]: 3 of 7 START sql table model bronze_silver.fact_trips .......................... [RUN]
[0m20:11:31.840572 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_nyc_project.stg_trips, now model.taxi_nyc_project.fact_trips)
[0m20:11:31.841381 [debug] [Thread-1 (]: Began compiling node model.taxi_nyc_project.fact_trips
[0m20:11:31.845823 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_nyc_project.fact_trips"
[0m20:11:31.867764 [debug] [Thread-1 (]: Began executing node model.taxi_nyc_project.fact_trips
[0m20:11:31.871749 [debug] [Thread-1 (]: dbt-sqlserver
[0m20:11:31.874600 [debug] [Thread-1 (]: Applying DROP to: "sqldb-taxi-platform"."bronze_silver"."fact_trips__dbt_tmp__dbt_tmp_vw"
[0m20:11:31.876665 [debug] [Thread-1 (]: dbt-sqlserver
[0m20:11:31.878196 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.fact_trips"
[0m20:11:31.879629 [debug] [Thread-1 (]: On model.taxi_nyc_project.fact_trips: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.fact_trips"} */

        USE [sqldb-taxi-platform];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'sqldb-taxi-platform'
        and refs.referenced_schema_name = 'bronze_silver'
        and refs.referenced_entity_name = 'fact_trips__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m20:11:31.880771 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:11:31.881720 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m20:11:32.244057 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m20:11:32.303157 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:11:32.305756 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.fact_trips"
[0m20:11:32.307063 [debug] [Thread-1 (]: On model.taxi_nyc_project.fact_trips: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.fact_trips"} */

      
      
    
    USE [sqldb-taxi-platform];
    EXEC('DROP view IF EXISTS "bronze_silver"."fact_trips__dbt_tmp__dbt_tmp_vw";');

[0m20:11:32.353234 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:11:32.356392 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_nyc_project.fact_trips"
[0m20:11:32.381632 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.fact_trips"
[0m20:11:32.382794 [debug] [Thread-1 (]: On model.taxi_nyc_project.fact_trips: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.fact_trips"} */

  
    USE [sqldb-taxi-platform];
    USE [sqldb-taxi-platform];
    
    

    

    
    USE [sqldb-taxi-platform];
    EXEC('
        create view "bronze_silver"."fact_trips__dbt_tmp__dbt_tmp_vw" as 

with base as (

    select
        -- simple surrogate key
        cast(
            row_number() over (
                order by pickup_datetime, pu_location_id, do_location_id
            ) as bigint
        )                                           as trip_id,

        -- time fields
        pickup_datetime,
        dropoff_datetime,
        datediff(minute, pickup_datetime, dropoff_datetime)
                                                    as trip_duration_minutes,
        cast(pickup_datetime as date)               as pickup_date,
        datepart(hour, pickup_datetime)             as pickup_hour,
        datename(weekday, pickup_datetime)          as pickup_day_name,
        datepart(weekday, pickup_datetime)          as pickup_day_of_week,

        -- original numeric fields
        passenger_count,
        trip_distance,
        rate_code_id,
        pu_location_id,
        do_location_id,
        payment_type,
        fare_amount,
        extra,
        mta_tax,
        tip_amount,
        tolls_amount,
        improvement_surcharge,
        total_amount,
        congestion_surcharge,
        airport_fee,
        cbd_congestion_fee

    from "sqldb-taxi-platform"."bronze_bronze"."stg_trips"

)

select
    *,
    case 
        when fare_amount > 0 
            then cast(tip_amount / fare_amount * 100.0 as float)
        else null
    end                                             as tip_pct
from base;;
    ')

EXEC('
            SELECT * INTO "sqldb-taxi-platform"."bronze_silver"."fact_trips__dbt_tmp" FROM "sqldb-taxi-platform"."bronze_silver"."fact_trips__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS bronze_silver.fact_trips__dbt_tmp__dbt_tmp_vw')



    
    use [sqldb-taxi-platform];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'bronze_silver_fact_trips__dbt_tmp_cci'
        AND object_id=object_id('bronze_silver_fact_trips__dbt_tmp')
    )
    DROP index "bronze_silver"."fact_trips__dbt_tmp".bronze_silver_fact_trips__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX bronze_silver_fact_trips__dbt_tmp_cci
    ON "bronze_silver"."fact_trips__dbt_tmp"

   


  
[0m20:12:02.612962 [debug] [Thread-1 (]: SQL status: OK in 30.000 seconds
[0m20:12:02.619342 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.fact_trips"
[0m20:12:02.620952 [debug] [Thread-1 (]: On model.taxi_nyc_project.fact_trips: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.fact_trips"} */
USE [sqldb-taxi-platform];
      EXEC sp_rename 'bronze_silver.fact_trips', 'fact_trips__dbt_backup'
[0m20:12:03.189989 [debug] [Thread-1 (]: SQL status: OK in 1.000 seconds
[0m20:12:03.195354 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.fact_trips"
[0m20:12:03.197493 [debug] [Thread-1 (]: On model.taxi_nyc_project.fact_trips: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.fact_trips"} */
USE [sqldb-taxi-platform];
      EXEC sp_rename 'bronze_silver.fact_trips__dbt_tmp', 'fact_trips'
[0m20:12:03.248295 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:12:03.251249 [debug] [Thread-1 (]: On model.taxi_nyc_project.fact_trips: COMMIT
[0m20:12:03.254261 [debug] [Thread-1 (]: Applying DROP to: "sqldb-taxi-platform"."bronze_silver"."fact_trips__dbt_backup"
[0m20:12:03.255623 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.fact_trips"
[0m20:12:03.256546 [debug] [Thread-1 (]: On model.taxi_nyc_project.fact_trips: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.fact_trips"} */

      
    USE [sqldb-taxi-platform];
    EXEC('DROP table IF EXISTS "bronze_silver"."fact_trips__dbt_backup";');

[0m20:12:03.310788 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:12:03.314367 [debug] [Thread-1 (]: On model.taxi_nyc_project.fact_trips: Close
[0m20:12:03.317130 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4879272-2c2d-4dfd-a6ff-fe06ab2f368f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6f5cf60090>]}
[0m20:12:03.318440 [info ] [Thread-1 (]: 3 of 7 OK created sql table model bronze_silver.fact_trips ..................... [[32mOK[0m in 31.48s]
[0m20:12:03.319544 [debug] [Thread-1 (]: Finished running node model.taxi_nyc_project.fact_trips
[0m20:12:03.321065 [debug] [Thread-1 (]: Began running node model.taxi_nyc_project.mart_daily_revenue
[0m20:12:03.321975 [info ] [Thread-1 (]: 4 of 7 START sql table model bronze_gold.mart_daily_revenue .................... [RUN]
[0m20:12:03.322842 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_nyc_project.fact_trips, now model.taxi_nyc_project.mart_daily_revenue)
[0m20:12:03.323570 [debug] [Thread-1 (]: Began compiling node model.taxi_nyc_project.mart_daily_revenue
[0m20:12:03.327137 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_nyc_project.mart_daily_revenue"
[0m20:12:03.334537 [debug] [Thread-1 (]: Began executing node model.taxi_nyc_project.mart_daily_revenue
[0m20:12:03.338289 [debug] [Thread-1 (]: dbt-sqlserver
[0m20:12:03.340936 [debug] [Thread-1 (]: Applying DROP to: "sqldb-taxi-platform"."bronze_gold"."mart_daily_revenue__dbt_tmp__dbt_tmp_vw"
[0m20:12:03.342296 [debug] [Thread-1 (]: dbt-sqlserver
[0m20:12:03.343340 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_daily_revenue"
[0m20:12:03.344430 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_daily_revenue"} */

        USE [sqldb-taxi-platform];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'sqldb-taxi-platform'
        and refs.referenced_schema_name = 'bronze_gold'
        and refs.referenced_entity_name = 'mart_daily_revenue__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m20:12:03.345221 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:12:03.346133 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m20:12:03.813349 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m20:12:03.882459 [debug] [Thread-1 (]: SQL status: OK in 1.000 seconds
[0m20:12:03.885647 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_daily_revenue"
[0m20:12:03.887018 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_daily_revenue"} */

      
      
    
    USE [sqldb-taxi-platform];
    EXEC('DROP view IF EXISTS "bronze_gold"."mart_daily_revenue__dbt_tmp__dbt_tmp_vw";');

[0m20:12:03.937194 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:12:03.940713 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_nyc_project.mart_daily_revenue"
[0m20:12:03.965759 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_daily_revenue"
[0m20:12:03.966863 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_daily_revenue"} */

  
    USE [sqldb-taxi-platform];
    USE [sqldb-taxi-platform];
    
    

    

    
    USE [sqldb-taxi-platform];
    EXEC('
        create view "bronze_gold"."mart_daily_revenue__dbt_tmp__dbt_tmp_vw" as 

select
    pickup_date                as trip_date,
    count(*)                   as trip_count,
    sum(total_amount)          as total_revenue,
    avg(total_amount)          as avg_revenue_per_trip
from "sqldb-taxi-platform"."bronze_silver"."fact_trips"
group by
    pickup_date;;
    ')

EXEC('
            SELECT * INTO "sqldb-taxi-platform"."bronze_gold"."mart_daily_revenue__dbt_tmp" FROM "sqldb-taxi-platform"."bronze_gold"."mart_daily_revenue__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS bronze_gold.mart_daily_revenue__dbt_tmp__dbt_tmp_vw')



    
    use [sqldb-taxi-platform];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'bronze_gold_mart_daily_revenue__dbt_tmp_cci'
        AND object_id=object_id('bronze_gold_mart_daily_revenue__dbt_tmp')
    )
    DROP index "bronze_gold"."mart_daily_revenue__dbt_tmp".bronze_gold_mart_daily_revenue__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX bronze_gold_mart_daily_revenue__dbt_tmp_cci
    ON "bronze_gold"."mart_daily_revenue__dbt_tmp"

   


  
[0m20:12:04.283422 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:12:04.287631 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_daily_revenue"
[0m20:12:04.288924 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_daily_revenue"} */
USE [sqldb-taxi-platform];
      EXEC sp_rename 'bronze_gold.mart_daily_revenue', 'mart_daily_revenue__dbt_backup'
[0m20:12:04.342428 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:12:04.347686 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_daily_revenue"
[0m20:12:04.348926 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_daily_revenue"} */
USE [sqldb-taxi-platform];
      EXEC sp_rename 'bronze_gold.mart_daily_revenue__dbt_tmp', 'mart_daily_revenue'
[0m20:12:04.401594 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:12:04.404327 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_daily_revenue: COMMIT
[0m20:12:04.407077 [debug] [Thread-1 (]: Applying DROP to: "sqldb-taxi-platform"."bronze_gold"."mart_daily_revenue__dbt_backup"
[0m20:12:04.408539 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_daily_revenue"
[0m20:12:04.409726 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_daily_revenue: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_daily_revenue"} */

      
    USE [sqldb-taxi-platform];
    EXEC('DROP table IF EXISTS "bronze_gold"."mart_daily_revenue__dbt_backup";');

[0m20:12:04.464632 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:12:04.467583 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_daily_revenue: Close
[0m20:12:04.470107 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4879272-2c2d-4dfd-a6ff-fe06ab2f368f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6f5cf07e10>]}
[0m20:12:04.471287 [info ] [Thread-1 (]: 4 of 7 OK created sql table model bronze_gold.mart_daily_revenue ............... [[32mOK[0m in 1.15s]
[0m20:12:04.472322 [debug] [Thread-1 (]: Finished running node model.taxi_nyc_project.mart_daily_revenue
[0m20:12:04.473150 [debug] [Thread-1 (]: Began running node model.taxi_nyc_project.mart_tip_by_payment_type
[0m20:12:04.474132 [info ] [Thread-1 (]: 5 of 7 START sql table model bronze_gold.mart_tip_by_payment_type .............. [RUN]
[0m20:12:04.475123 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_nyc_project.mart_daily_revenue, now model.taxi_nyc_project.mart_tip_by_payment_type)
[0m20:12:04.476013 [debug] [Thread-1 (]: Began compiling node model.taxi_nyc_project.mart_tip_by_payment_type
[0m20:12:04.480268 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_nyc_project.mart_tip_by_payment_type"
[0m20:12:04.494842 [debug] [Thread-1 (]: Began executing node model.taxi_nyc_project.mart_tip_by_payment_type
[0m20:12:04.500364 [debug] [Thread-1 (]: dbt-sqlserver
[0m20:12:04.578053 [debug] [Thread-1 (]: Applying DROP to: "sqldb-taxi-platform"."bronze_gold"."mart_tip_by_payment_type__dbt_tmp__dbt_tmp_vw"
[0m20:12:04.580920 [debug] [Thread-1 (]: dbt-sqlserver
[0m20:12:04.582031 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_tip_by_payment_type"
[0m20:12:04.583180 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_tip_by_payment_type: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_tip_by_payment_type"} */

        USE [sqldb-taxi-platform];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'sqldb-taxi-platform'
        and refs.referenced_schema_name = 'bronze_gold'
        and refs.referenced_entity_name = 'mart_tip_by_payment_type__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m20:12:04.584154 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:12:04.585061 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m20:12:04.866544 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m20:12:04.925880 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:12:04.929492 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_tip_by_payment_type"
[0m20:12:04.931159 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_tip_by_payment_type: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_tip_by_payment_type"} */

      
      
    
    USE [sqldb-taxi-platform];
    EXEC('DROP view IF EXISTS "bronze_gold"."mart_tip_by_payment_type__dbt_tmp__dbt_tmp_vw";');

[0m20:12:04.977616 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:12:04.981791 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_nyc_project.mart_tip_by_payment_type"
[0m20:12:05.002623 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_tip_by_payment_type"
[0m20:12:05.003716 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_tip_by_payment_type: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_tip_by_payment_type"} */

  
    USE [sqldb-taxi-platform];
    USE [sqldb-taxi-platform];
    
    

    

    
    USE [sqldb-taxi-platform];
    EXEC('
        create view "bronze_gold"."mart_tip_by_payment_type__dbt_tmp__dbt_tmp_vw" as 

select
    d.payment_type_desc   as payment_type,
    avg(f.tip_pct)        as avg_tip_pct
from "sqldb-taxi-platform"."bronze_silver"."fact_trips" f
join "sqldb-taxi-platform"."bronze_silver"."dim_payment_type" d
    on f.payment_type = d.payment_type
where f.tip_pct is not null
group by
    d.payment_type_desc;;
    ')

EXEC('
            SELECT * INTO "sqldb-taxi-platform"."bronze_gold"."mart_tip_by_payment_type__dbt_tmp" FROM "sqldb-taxi-platform"."bronze_gold"."mart_tip_by_payment_type__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS bronze_gold.mart_tip_by_payment_type__dbt_tmp__dbt_tmp_vw')



    
    use [sqldb-taxi-platform];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'bronze_gold_mart_tip_by_payment_type__dbt_tmp_cci'
        AND object_id=object_id('bronze_gold_mart_tip_by_payment_type__dbt_tmp')
    )
    DROP index "bronze_gold"."mart_tip_by_payment_type__dbt_tmp".bronze_gold_mart_tip_by_payment_type__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX bronze_gold_mart_tip_by_payment_type__dbt_tmp_cci
    ON "bronze_gold"."mart_tip_by_payment_type__dbt_tmp"

   


  
[0m20:12:05.522246 [debug] [Thread-1 (]: SQL status: OK in 1.000 seconds
[0m20:12:05.526873 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_tip_by_payment_type"
[0m20:12:05.528682 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_tip_by_payment_type: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_tip_by_payment_type"} */
USE [sqldb-taxi-platform];
      EXEC sp_rename 'bronze_gold.mart_tip_by_payment_type', 'mart_tip_by_payment_type__dbt_backup'
[0m20:12:05.580063 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:12:05.583885 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_tip_by_payment_type"
[0m20:12:05.584844 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_tip_by_payment_type: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_tip_by_payment_type"} */
USE [sqldb-taxi-platform];
      EXEC sp_rename 'bronze_gold.mart_tip_by_payment_type__dbt_tmp', 'mart_tip_by_payment_type'
[0m20:12:05.634663 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:12:05.637709 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_tip_by_payment_type: COMMIT
[0m20:12:05.640432 [debug] [Thread-1 (]: Applying DROP to: "sqldb-taxi-platform"."bronze_gold"."mart_tip_by_payment_type__dbt_backup"
[0m20:12:05.642305 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_tip_by_payment_type"
[0m20:12:05.643242 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_tip_by_payment_type: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_tip_by_payment_type"} */

      
    USE [sqldb-taxi-platform];
    EXEC('DROP table IF EXISTS "bronze_gold"."mart_tip_by_payment_type__dbt_backup";');

[0m20:12:05.693478 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:12:05.697314 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_tip_by_payment_type: Close
[0m20:12:05.699610 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4879272-2c2d-4dfd-a6ff-fe06ab2f368f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6f5c582750>]}
[0m20:12:05.700786 [info ] [Thread-1 (]: 5 of 7 OK created sql table model bronze_gold.mart_tip_by_payment_type ......... [[32mOK[0m in 1.22s]
[0m20:12:05.701836 [debug] [Thread-1 (]: Finished running node model.taxi_nyc_project.mart_tip_by_payment_type
[0m20:12:05.702717 [debug] [Thread-1 (]: Began running node model.taxi_nyc_project.mart_trips_by_hour
[0m20:12:05.703589 [info ] [Thread-1 (]: 6 of 7 START sql table model bronze_gold.mart_trips_by_hour .................... [RUN]
[0m20:12:05.704368 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_nyc_project.mart_tip_by_payment_type, now model.taxi_nyc_project.mart_trips_by_hour)
[0m20:12:05.705095 [debug] [Thread-1 (]: Began compiling node model.taxi_nyc_project.mart_trips_by_hour
[0m20:12:05.708134 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_nyc_project.mart_trips_by_hour"
[0m20:12:05.722360 [debug] [Thread-1 (]: Began executing node model.taxi_nyc_project.mart_trips_by_hour
[0m20:12:05.726518 [debug] [Thread-1 (]: dbt-sqlserver
[0m20:12:05.730999 [debug] [Thread-1 (]: Applying DROP to: "sqldb-taxi-platform"."bronze_gold"."mart_trips_by_hour__dbt_tmp__dbt_tmp_vw"
[0m20:12:05.732807 [debug] [Thread-1 (]: dbt-sqlserver
[0m20:12:05.733707 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_trips_by_hour"
[0m20:12:05.734571 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_trips_by_hour: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_trips_by_hour"} */

        USE [sqldb-taxi-platform];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'sqldb-taxi-platform'
        and refs.referenced_schema_name = 'bronze_gold'
        and refs.referenced_entity_name = 'mart_trips_by_hour__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m20:12:05.735322 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:12:05.736167 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m20:12:06.040085 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m20:12:06.103979 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:12:06.106580 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_trips_by_hour"
[0m20:12:06.107847 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_trips_by_hour: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_trips_by_hour"} */

      
      
    
    USE [sqldb-taxi-platform];
    EXEC('DROP view IF EXISTS "bronze_gold"."mart_trips_by_hour__dbt_tmp__dbt_tmp_vw";');

[0m20:12:06.159569 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:12:06.163343 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_nyc_project.mart_trips_by_hour"
[0m20:12:06.186695 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_trips_by_hour"
[0m20:12:06.187784 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_trips_by_hour: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_trips_by_hour"} */

  
    USE [sqldb-taxi-platform];
    USE [sqldb-taxi-platform];
    
    

    

    
    USE [sqldb-taxi-platform];
    EXEC('
        create view "bronze_gold"."mart_trips_by_hour__dbt_tmp__dbt_tmp_vw" as 

select
    pickup_hour      as hour_of_day,
    pickup_day_name  as day_of_week,
    count(*)         as trip_count
from "sqldb-taxi-platform"."bronze_silver"."fact_trips"
group by
    pickup_hour,
    pickup_day_name;;
    ')

EXEC('
            SELECT * INTO "sqldb-taxi-platform"."bronze_gold"."mart_trips_by_hour__dbt_tmp" FROM "sqldb-taxi-platform"."bronze_gold"."mart_trips_by_hour__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS bronze_gold.mart_trips_by_hour__dbt_tmp__dbt_tmp_vw')



    
    use [sqldb-taxi-platform];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'bronze_gold_mart_trips_by_hour__dbt_tmp_cci'
        AND object_id=object_id('bronze_gold_mart_trips_by_hour__dbt_tmp')
    )
    DROP index "bronze_gold"."mart_trips_by_hour__dbt_tmp".bronze_gold_mart_trips_by_hour__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX bronze_gold_mart_trips_by_hour__dbt_tmp_cci
    ON "bronze_gold"."mart_trips_by_hour__dbt_tmp"

   


  
[0m20:12:07.011883 [debug] [Thread-1 (]: SQL status: OK in 1.000 seconds
[0m20:12:07.016090 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_trips_by_hour"
[0m20:12:07.017023 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_trips_by_hour: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_trips_by_hour"} */
USE [sqldb-taxi-platform];
      EXEC sp_rename 'bronze_gold.mart_trips_by_hour', 'mart_trips_by_hour__dbt_backup'
[0m20:12:07.070862 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:12:07.074657 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_trips_by_hour"
[0m20:12:07.075742 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_trips_by_hour: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_trips_by_hour"} */
USE [sqldb-taxi-platform];
      EXEC sp_rename 'bronze_gold.mart_trips_by_hour__dbt_tmp', 'mart_trips_by_hour'
[0m20:12:07.130889 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:12:07.133536 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_trips_by_hour: COMMIT
[0m20:12:07.137338 [debug] [Thread-1 (]: Applying DROP to: "sqldb-taxi-platform"."bronze_gold"."mart_trips_by_hour__dbt_backup"
[0m20:12:07.138538 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_trips_by_hour"
[0m20:12:07.139335 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_trips_by_hour: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_trips_by_hour"} */

      
    USE [sqldb-taxi-platform];
    EXEC('DROP table IF EXISTS "bronze_gold"."mart_trips_by_hour__dbt_backup";');

[0m20:12:07.194565 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:12:07.197113 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_trips_by_hour: Close
[0m20:12:07.199051 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4879272-2c2d-4dfd-a6ff-fe06ab2f368f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6f600edb10>]}
[0m20:12:07.200154 [info ] [Thread-1 (]: 6 of 7 OK created sql table model bronze_gold.mart_trips_by_hour ............... [[32mOK[0m in 1.49s]
[0m20:12:07.201131 [debug] [Thread-1 (]: Finished running node model.taxi_nyc_project.mart_trips_by_hour
[0m20:12:07.201981 [debug] [Thread-1 (]: Began running node model.taxi_nyc_project.mart_zone_revenue
[0m20:12:07.202756 [info ] [Thread-1 (]: 7 of 7 START sql table model bronze_gold.mart_zone_revenue ..................... [RUN]
[0m20:12:07.203661 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_nyc_project.mart_trips_by_hour, now model.taxi_nyc_project.mart_zone_revenue)
[0m20:12:07.204470 [debug] [Thread-1 (]: Began compiling node model.taxi_nyc_project.mart_zone_revenue
[0m20:12:07.207406 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_nyc_project.mart_zone_revenue"
[0m20:12:07.221838 [debug] [Thread-1 (]: Began executing node model.taxi_nyc_project.mart_zone_revenue
[0m20:12:07.225877 [debug] [Thread-1 (]: dbt-sqlserver
[0m20:12:07.229990 [debug] [Thread-1 (]: Applying DROP to: "sqldb-taxi-platform"."bronze_gold"."mart_zone_revenue__dbt_tmp__dbt_tmp_vw"
[0m20:12:07.231842 [debug] [Thread-1 (]: dbt-sqlserver
[0m20:12:07.232798 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_zone_revenue"
[0m20:12:07.233622 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_zone_revenue: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_zone_revenue"} */

        USE [sqldb-taxi-platform];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'sqldb-taxi-platform'
        and refs.referenced_schema_name = 'bronze_gold'
        and refs.referenced_entity_name = 'mart_zone_revenue__dbt_tmp__dbt_tmp_vw'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m20:12:07.234423 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:12:07.235211 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m20:12:07.517890 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m20:12:07.590592 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:12:07.594016 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_zone_revenue"
[0m20:12:07.595682 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_zone_revenue: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_zone_revenue"} */

      
      
    
    USE [sqldb-taxi-platform];
    EXEC('DROP view IF EXISTS "bronze_gold"."mart_zone_revenue__dbt_tmp__dbt_tmp_vw";');

[0m20:12:07.641538 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:12:07.645221 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_nyc_project.mart_zone_revenue"
[0m20:12:07.670091 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_zone_revenue"
[0m20:12:07.671193 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_zone_revenue: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_zone_revenue"} */

  
    USE [sqldb-taxi-platform];
    USE [sqldb-taxi-platform];
    
    

    

    
    USE [sqldb-taxi-platform];
    EXEC('
        create view "bronze_gold"."mart_zone_revenue__dbt_tmp__dbt_tmp_vw" as 

select
    pu_location_id             as pickup_zone_id,
    count(*)                   as trip_count,
    sum(total_amount)          as total_revenue
from "sqldb-taxi-platform"."bronze_silver"."fact_trips"
group by
    pu_location_id;;
    ')

EXEC('
            SELECT * INTO "sqldb-taxi-platform"."bronze_gold"."mart_zone_revenue__dbt_tmp" FROM "sqldb-taxi-platform"."bronze_gold"."mart_zone_revenue__dbt_tmp__dbt_tmp_vw" 
    OPTION (LABEL = ''dbt-sqlserver'');

        ')

    
    EXEC('DROP VIEW IF EXISTS bronze_gold.mart_zone_revenue__dbt_tmp__dbt_tmp_vw')



    
    use [sqldb-taxi-platform];
    if EXISTS (
        SELECT *
        FROM sys.indexes with (nolock)
        WHERE name = 'bronze_gold_mart_zone_revenue__dbt_tmp_cci'
        AND object_id=object_id('bronze_gold_mart_zone_revenue__dbt_tmp')
    )
    DROP index "bronze_gold"."mart_zone_revenue__dbt_tmp".bronze_gold_mart_zone_revenue__dbt_tmp_cci
    CREATE CLUSTERED COLUMNSTORE INDEX bronze_gold_mart_zone_revenue__dbt_tmp_cci
    ON "bronze_gold"."mart_zone_revenue__dbt_tmp"

   


  
[0m20:12:08.012915 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:12:08.017294 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_zone_revenue"
[0m20:12:08.018322 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_zone_revenue: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_zone_revenue"} */
USE [sqldb-taxi-platform];
      EXEC sp_rename 'bronze_gold.mart_zone_revenue', 'mart_zone_revenue__dbt_backup'
[0m20:12:08.068953 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:12:08.072962 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_zone_revenue"
[0m20:12:08.074471 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_zone_revenue: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_zone_revenue"} */
USE [sqldb-taxi-platform];
      EXEC sp_rename 'bronze_gold.mart_zone_revenue__dbt_tmp', 'mart_zone_revenue'
[0m20:12:08.124603 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:12:08.127957 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_zone_revenue: COMMIT
[0m20:12:08.132098 [debug] [Thread-1 (]: Applying DROP to: "sqldb-taxi-platform"."bronze_gold"."mart_zone_revenue__dbt_backup"
[0m20:12:08.133901 [debug] [Thread-1 (]: Using sqlserver connection "model.taxi_nyc_project.mart_zone_revenue"
[0m20:12:08.134704 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_zone_revenue: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "model.taxi_nyc_project.mart_zone_revenue"} */

      
    USE [sqldb-taxi-platform];
    EXEC('DROP table IF EXISTS "bronze_gold"."mart_zone_revenue__dbt_backup";');

[0m20:12:08.183930 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:12:08.186635 [debug] [Thread-1 (]: On model.taxi_nyc_project.mart_zone_revenue: Close
[0m20:12:08.189284 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4879272-2c2d-4dfd-a6ff-fe06ab2f368f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6f5feb9310>]}
[0m20:12:08.190692 [info ] [Thread-1 (]: 7 of 7 OK created sql table model bronze_gold.mart_zone_revenue ................ [[32mOK[0m in 0.99s]
[0m20:12:08.191889 [debug] [Thread-1 (]: Finished running node model.taxi_nyc_project.mart_zone_revenue
[0m20:12:08.194340 [debug] [MainThread]: On master: COMMIT
[0m20:12:08.195653 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:12:08.196435 [debug] [MainThread]: Connection 'model.taxi_nyc_project.mart_zone_revenue' was properly closed.
[0m20:12:08.197260 [info ] [MainThread]: 
[0m20:12:08.197991 [info ] [MainThread]: Finished running 7 table models in 0 hours 1 minutes and 4.73 seconds (64.73s).
[0m20:12:08.199498 [debug] [MainThread]: Command end result
[0m20:12:08.233489 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m20:12:08.238086 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m20:12:08.262935 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m20:12:08.264098 [info ] [MainThread]: 
[0m20:12:08.265462 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:12:08.266545 [info ] [MainThread]: 
[0m20:12:08.267434 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m20:12:08.269061 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 66.8837, "process_in_blocks": "56968", "process_kernel_time": 0.358185, "process_mem_max_rss": "140896", "process_out_blocks": "0", "process_user_time": 3.820647}
[0m20:12:08.269900 [debug] [MainThread]: Command `dbt run` succeeded at 20:12:08.269805 after 66.88 seconds
[0m20:12:08.270609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6f61726590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6f656dc6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6f654f3350>]}
[0m20:12:08.271332 [debug] [MainThread]: Flushing usage events
[0m20:12:08.960399 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:12:13.895398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9e32265fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9e320afe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9e32416490>]}


============================== 20:12:13.900669 | 5af14c2a-fb6e-4998-96d6-6d369e74556c ==============================
[0m20:12:13.900669 [info ] [MainThread]: Running with dbt=1.10.0
[0m20:12:13.902094 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt_profile', 'log_path': '/opt/airflow/dbt_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/dbt_profile', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:12:14.137991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5af14c2a-fb6e-4998-96d6-6d369e74556c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9e311a8e90>]}
[0m20:12:14.185526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5af14c2a-fb6e-4998-96d6-6d369e74556c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9e32fa5bd0>]}
[0m20:12:14.187787 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m20:12:14.255637 [debug] [MainThread]: checksum: 7f68a7785a72ec903908acd64ff91bcd043d0ce8a90a7375d2cd5f3d875e6fed, vars: {}, profile: , target: , version: 1.10.0
[0m20:12:14.433059 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:12:14.434337 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:12:14.465405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5af14c2a-fb6e-4998-96d6-6d369e74556c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9e30d66190>]}
[0m20:12:14.599618 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m20:12:14.607011 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m20:12:14.642183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5af14c2a-fb6e-4998-96d6-6d369e74556c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9e30bc3410>]}
[0m20:12:14.643769 [info ] [MainThread]: Found 7 models, 13 data tests, 510 macros
[0m20:12:14.645112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5af14c2a-fb6e-4998-96d6-6d369e74556c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9e32752550>]}
[0m20:12:14.647693 [info ] [MainThread]: 
[0m20:12:14.648494 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:12:14.649226 [info ] [MainThread]: 
[0m20:12:14.650236 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m20:12:14.655201 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_sqldb-taxi-platform_bronze_gold'
[0m20:12:14.669630 [debug] [ThreadPool]: dbt-sqlserver
[0m20:12:14.671051 [debug] [ThreadPool]: Using sqlserver connection "list_sqldb-taxi-platform_bronze_gold"
[0m20:12:14.672013 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_gold: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "list_sqldb-taxi-platform_bronze_gold"} */
USE [sqldb-taxi-platform];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze_gold'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m20:12:14.673019 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:12:14.673943 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m20:12:15.269063 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m20:12:15.339618 [debug] [ThreadPool]: SQL status: OK in 1.000 seconds
[0m20:12:15.342969 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_gold: ROLLBACK
[0m20:12:15.344717 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_gold: Close
[0m20:12:15.347375 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sqldb-taxi-platform_bronze_gold, now list_sqldb-taxi-platform_bronze_bronze)
[0m20:12:15.350874 [debug] [ThreadPool]: dbt-sqlserver
[0m20:12:15.351639 [debug] [ThreadPool]: Using sqlserver connection "list_sqldb-taxi-platform_bronze_bronze"
[0m20:12:15.352315 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_bronze: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "list_sqldb-taxi-platform_bronze_bronze"} */
USE [sqldb-taxi-platform];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze_bronze'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m20:12:15.353038 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:12:15.353647 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m20:12:15.635016 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m20:12:15.706076 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:12:15.709691 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_bronze: ROLLBACK
[0m20:12:15.711726 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_bronze: Close
[0m20:12:15.714394 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sqldb-taxi-platform_bronze_bronze, now list_sqldb-taxi-platform_bronze_silver)
[0m20:12:15.717239 [debug] [ThreadPool]: dbt-sqlserver
[0m20:12:15.718010 [debug] [ThreadPool]: Using sqlserver connection "list_sqldb-taxi-platform_bronze_silver"
[0m20:12:15.718640 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_silver: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "taxi_nyc_project", "target_name": "dev", "connection_name": "list_sqldb-taxi-platform_bronze_silver"} */
USE [sqldb-taxi-platform];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'bronze_silver'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m20:12:15.719309 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:12:15.719923 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m20:12:16.019353 [debug] [ThreadPool]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m20:12:16.095271 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:12:16.097702 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_silver: ROLLBACK
[0m20:12:16.098914 [debug] [ThreadPool]: On list_sqldb-taxi-platform_bronze_silver: Close
[0m20:12:16.101738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5af14c2a-fb6e-4998-96d6-6d369e74556c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9e30b96a10>]}
[0m20:12:16.102728 [debug] [MainThread]: On master: COMMIT
[0m20:12:16.106510 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec
[0m20:12:16.107464 [info ] [Thread-1 (]: 1 of 13 START test accepted_values_stg_trips_payment_type__1__2__3__4__5__6 .... [RUN]
[0m20:12:16.108509 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sqldb-taxi-platform_bronze_silver, now test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec)
[0m20:12:16.109472 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec
[0m20:12:16.121590 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec"
[0m20:12:16.145984 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec
[0m20:12:16.165675 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec"
[0m20:12:16.186402 [debug] [Thread-1 (]: Using sqlserver connection "test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec"
[0m20:12:16.187642 [debug] [Thread-1 (]: On test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec"} */

    -- Create target schema if it does not
  USE [sqldb-taxi-platform];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'bronze')
  BEGIN
    EXEC('CREATE SCHEMA [bronze]')
  END

  

  
  EXEC('create view 
    [bronze].[testview_f33210bcd4b055fe9687c095053b88a1_9683]
   as 
    
    
    

with all_values as (

    select
        payment_type as value_field,
        count(*) as n_records

    from "sqldb-taxi-platform"."bronze_bronze"."stg_trips"
    group by payment_type

)

select *
from all_values
where value_field not in (
    ''1'',''2'',''3'',''4'',''5'',''6''
)



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [bronze].[testview_f33210bcd4b055fe9687c095053b88a1_9683]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [bronze].[testview_f33210bcd4b055fe9687c095053b88a1_9683]
  ;')
[0m20:12:16.188521 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:12:16.189591 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m20:12:16.469285 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m20:12:16.825667 [debug] [Thread-1 (]: SQL status: OK in 1.000 seconds
[0m20:12:16.830377 [debug] [Thread-1 (]: On test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec: ROLLBACK
[0m20:12:16.831440 [debug] [Thread-1 (]: On test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec: Close
[0m20:12:16.833360 [info ] [Thread-1 (]: 1 of 13 PASS accepted_values_stg_trips_payment_type__1__2__3__4__5__6 .......... [[32mPASS[0m in 0.72s]
[0m20:12:16.834444 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec
[0m20:12:16.835274 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d
[0m20:12:16.835990 [info ] [Thread-1 (]: 2 of 13 START test accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99 ... [RUN]
[0m20:12:16.836837 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.accepted_values_stg_trips_payment_type__1__2__3__4__5__6.96e3ac3bec, now test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d)
[0m20:12:16.837544 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d
[0m20:12:16.841874 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d"
[0m20:12:16.865288 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d
[0m20:12:16.868598 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d"
[0m20:12:16.888166 [debug] [Thread-1 (]: Using sqlserver connection "test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d"
[0m20:12:16.889093 [debug] [Thread-1 (]: On test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d"} */

    -- Create target schema if it does not
  USE [sqldb-taxi-platform];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'bronze')
  BEGIN
    EXEC('CREATE SCHEMA [bronze]')
  END

  

  
  EXEC('create view 
    [bronze].[testview_4dded7e06fdf8cf96858af6f2dabdb0d_2488]
   as 
    
    
    

with all_values as (

    select
        rate_code_id as value_field,
        count(*) as n_records

    from "sqldb-taxi-platform"."bronze_bronze"."stg_trips"
    group by rate_code_id

)

select *
from all_values
where value_field not in (
    ''1'',''2'',''3'',''4'',''5'',''99''
)



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [bronze].[testview_4dded7e06fdf8cf96858af6f2dabdb0d_2488]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [bronze].[testview_4dded7e06fdf8cf96858af6f2dabdb0d_2488]
  ;')
[0m20:12:16.890020 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:12:16.890958 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m20:12:17.199204 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m20:12:17.442204 [debug] [Thread-1 (]: SQL status: OK in 1.000 seconds
[0m20:12:17.444469 [debug] [Thread-1 (]: On test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d: ROLLBACK
[0m20:12:17.445772 [debug] [Thread-1 (]: On test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d: Close
[0m20:12:17.448047 [info ] [Thread-1 (]: 2 of 13 PASS accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99 ......... [[32mPASS[0m in 0.61s]
[0m20:12:17.449302 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d
[0m20:12:17.450340 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626
[0m20:12:17.451216 [info ] [Thread-1 (]: 3 of 13 START test not_null_dim_payment_type_payment_type ...................... [RUN]
[0m20:12:17.452021 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.accepted_values_stg_trips_rate_code_id__1__2__3__4__5__99.5477b4889d, now test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626)
[0m20:12:17.452679 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626
[0m20:12:17.458432 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626"
[0m20:12:17.476200 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626
[0m20:12:17.478954 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626"
[0m20:12:17.493608 [debug] [Thread-1 (]: Using sqlserver connection "test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626"
[0m20:12:17.494827 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626"} */

    -- Create target schema if it does not
  USE [sqldb-taxi-platform];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'bronze')
  BEGIN
    EXEC('CREATE SCHEMA [bronze]')
  END

  

  
  EXEC('create view 
    [bronze].[testview_2ad2dc6a1d72454bc6f07cc7701e665e_9142]
   as 
    
    
    



select payment_type
from "sqldb-taxi-platform"."bronze_silver"."dim_payment_type"
where payment_type is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [bronze].[testview_2ad2dc6a1d72454bc6f07cc7701e665e_9142]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [bronze].[testview_2ad2dc6a1d72454bc6f07cc7701e665e_9142]
  ;')
[0m20:12:17.495653 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:12:17.496413 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m20:12:17.784292 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m20:12:17.842258 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:12:17.844376 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626: ROLLBACK
[0m20:12:17.845316 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626: Close
[0m20:12:17.847161 [info ] [Thread-1 (]: 3 of 13 PASS not_null_dim_payment_type_payment_type ............................ [[32mPASS[0m in 0.40s]
[0m20:12:17.848192 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626
[0m20:12:17.849014 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c
[0m20:12:17.849816 [info ] [Thread-1 (]: 4 of 13 START test not_null_fact_trips_pickup_date ............................. [RUN]
[0m20:12:17.850710 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_dim_payment_type_payment_type.fc8226f626, now test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c)
[0m20:12:17.851436 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c
[0m20:12:17.855485 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c"
[0m20:12:17.869010 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c
[0m20:12:17.872044 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c"
[0m20:12:17.892937 [debug] [Thread-1 (]: Using sqlserver connection "test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c"
[0m20:12:17.894079 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c"} */

    -- Create target schema if it does not
  USE [sqldb-taxi-platform];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'bronze')
  BEGIN
    EXEC('CREATE SCHEMA [bronze]')
  END

  

  
  EXEC('create view 
    [bronze].[testview_7d112b4bacf9180b503a254961208261_17112]
   as 
    
    
    



select pickup_date
from "sqldb-taxi-platform"."bronze_silver"."fact_trips"
where pickup_date is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [bronze].[testview_7d112b4bacf9180b503a254961208261_17112]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [bronze].[testview_7d112b4bacf9180b503a254961208261_17112]
  ;')
[0m20:12:17.894985 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:12:17.895738 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m20:12:18.200314 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m20:12:18.263528 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:12:18.266180 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c: ROLLBACK
[0m20:12:18.267554 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c: Close
[0m20:12:18.269766 [info ] [Thread-1 (]: 4 of 13 PASS not_null_fact_trips_pickup_date ................................... [[32mPASS[0m in 0.42s]
[0m20:12:18.270875 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c
[0m20:12:18.271893 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442
[0m20:12:18.272861 [info ] [Thread-1 (]: 5 of 13 START test not_null_fact_trips_trip_id ................................. [RUN]
[0m20:12:18.273750 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_fact_trips_pickup_date.cb0883437c, now test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442)
[0m20:12:18.274499 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442
[0m20:12:18.278677 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442"
[0m20:12:18.296158 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442
[0m20:12:18.299588 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442"
[0m20:12:18.314891 [debug] [Thread-1 (]: Using sqlserver connection "test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442"
[0m20:12:18.315799 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442"} */

    -- Create target schema if it does not
  USE [sqldb-taxi-platform];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'bronze')
  BEGIN
    EXEC('CREATE SCHEMA [bronze]')
  END

  

  
  EXEC('create view 
    [bronze].[testview_20905412c48dcf3bfd76540d3b87984e_14702]
   as 
    
    
    



select trip_id
from "sqldb-taxi-platform"."bronze_silver"."fact_trips"
where trip_id is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [bronze].[testview_20905412c48dcf3bfd76540d3b87984e_14702]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [bronze].[testview_20905412c48dcf3bfd76540d3b87984e_14702]
  ;')
[0m20:12:18.316691 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:12:18.317567 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m20:12:18.615029 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m20:12:18.975871 [debug] [Thread-1 (]: SQL status: OK in 1.000 seconds
[0m20:12:18.977916 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442: ROLLBACK
[0m20:12:18.978906 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442: Close
[0m20:12:18.980787 [info ] [Thread-1 (]: 5 of 13 PASS not_null_fact_trips_trip_id ....................................... [[32mPASS[0m in 0.71s]
[0m20:12:18.981794 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442
[0m20:12:18.982628 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b
[0m20:12:18.983436 [info ] [Thread-1 (]: 6 of 13 START test not_null_stg_trips_dropoff_datetime ......................... [RUN]
[0m20:12:18.984415 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_fact_trips_trip_id.6b89049442, now test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b)
[0m20:12:18.985163 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b
[0m20:12:18.989154 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b"
[0m20:12:19.003367 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b
[0m20:12:19.007505 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b"
[0m20:12:19.021573 [debug] [Thread-1 (]: Using sqlserver connection "test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b"
[0m20:12:19.022466 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b"} */

    -- Create target schema if it does not
  USE [sqldb-taxi-platform];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'bronze')
  BEGIN
    EXEC('CREATE SCHEMA [bronze]')
  END

  

  
  EXEC('create view 
    [bronze].[testview_4c8d3f315598f1637f069cf3074df17a_6210]
   as 
    
    
    



select dropoff_datetime
from "sqldb-taxi-platform"."bronze_bronze"."stg_trips"
where dropoff_datetime is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [bronze].[testview_4c8d3f315598f1637f069cf3074df17a_6210]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [bronze].[testview_4c8d3f315598f1637f069cf3074df17a_6210]
  ;')
[0m20:12:19.023475 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:12:19.024293 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m20:12:19.325323 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m20:12:19.832492 [debug] [Thread-1 (]: SQL status: OK in 1.000 seconds
[0m20:12:19.835053 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b: ROLLBACK
[0m20:12:19.836247 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b: Close
[0m20:12:19.838121 [info ] [Thread-1 (]: 6 of 13 PASS not_null_stg_trips_dropoff_datetime ............................... [[32mPASS[0m in 0.85s]
[0m20:12:19.839186 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b
[0m20:12:19.840100 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74
[0m20:12:19.841394 [info ] [Thread-1 (]: 7 of 13 START test not_null_stg_trips_fare_amount .............................. [RUN]
[0m20:12:19.842402 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_stg_trips_dropoff_datetime.40138f282b, now test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74)
[0m20:12:19.843155 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74
[0m20:12:19.847093 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74"
[0m20:12:19.861053 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74
[0m20:12:19.864042 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74"
[0m20:12:19.883726 [debug] [Thread-1 (]: Using sqlserver connection "test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74"
[0m20:12:19.884994 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74"} */

    -- Create target schema if it does not
  USE [sqldb-taxi-platform];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'bronze')
  BEGIN
    EXEC('CREATE SCHEMA [bronze]')
  END

  

  
  EXEC('create view 
    [bronze].[testview_9ea19f17f3a1a85ec021164b6969d1d9_12050]
   as 
    
    
    



select fare_amount
from "sqldb-taxi-platform"."bronze_bronze"."stg_trips"
where fare_amount is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [bronze].[testview_9ea19f17f3a1a85ec021164b6969d1d9_12050]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [bronze].[testview_9ea19f17f3a1a85ec021164b6969d1d9_12050]
  ;')
[0m20:12:19.886060 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:12:19.887129 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m20:12:20.220058 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m20:12:20.613280 [debug] [Thread-1 (]: SQL status: OK in 1.000 seconds
[0m20:12:20.615409 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74: ROLLBACK
[0m20:12:20.616392 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74: Close
[0m20:12:20.618309 [info ] [Thread-1 (]: 7 of 13 PASS not_null_stg_trips_fare_amount .................................... [[32mPASS[0m in 0.78s]
[0m20:12:20.619278 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74
[0m20:12:20.620133 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c
[0m20:12:20.620873 [info ] [Thread-1 (]: 8 of 13 START test not_null_stg_trips_pickup_datetime .......................... [RUN]
[0m20:12:20.621706 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_stg_trips_fare_amount.51d6e9de74, now test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c)
[0m20:12:20.622485 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c
[0m20:12:20.626665 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c"
[0m20:12:20.641446 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c
[0m20:12:20.644852 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c"
[0m20:12:20.662076 [debug] [Thread-1 (]: Using sqlserver connection "test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c"
[0m20:12:20.663135 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c"} */

    -- Create target schema if it does not
  USE [sqldb-taxi-platform];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'bronze')
  BEGIN
    EXEC('CREATE SCHEMA [bronze]')
  END

  

  
  EXEC('create view 
    [bronze].[testview_c8f1217ea7ae423f95431cf67128255c_14902]
   as 
    
    
    



select pickup_datetime
from "sqldb-taxi-platform"."bronze_bronze"."stg_trips"
where pickup_datetime is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [bronze].[testview_c8f1217ea7ae423f95431cf67128255c_14902]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [bronze].[testview_c8f1217ea7ae423f95431cf67128255c_14902]
  ;')
[0m20:12:20.664006 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:12:20.664842 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m20:12:20.945629 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m20:12:21.364071 [debug] [Thread-1 (]: SQL status: OK in 1.000 seconds
[0m20:12:21.366434 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c: ROLLBACK
[0m20:12:21.367674 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c: Close
[0m20:12:21.369918 [info ] [Thread-1 (]: 8 of 13 PASS not_null_stg_trips_pickup_datetime ................................ [[32mPASS[0m in 0.75s]
[0m20:12:21.371028 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c
[0m20:12:21.371920 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae
[0m20:12:21.372651 [info ] [Thread-1 (]: 9 of 13 START test not_null_stg_trips_total_amount ............................. [RUN]
[0m20:12:21.373631 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_stg_trips_pickup_datetime.4df9e7a15c, now test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae)
[0m20:12:21.374354 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae
[0m20:12:21.378231 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae"
[0m20:12:21.391647 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae
[0m20:12:21.394505 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae"
[0m20:12:21.408528 [debug] [Thread-1 (]: Using sqlserver connection "test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae"
[0m20:12:21.409469 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae"} */

    -- Create target schema if it does not
  USE [sqldb-taxi-platform];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'bronze')
  BEGIN
    EXEC('CREATE SCHEMA [bronze]')
  END

  

  
  EXEC('create view 
    [bronze].[testview_83c247fd7dcf1f459750c2de25501c63_14888]
   as 
    
    
    



select total_amount
from "sqldb-taxi-platform"."bronze_bronze"."stg_trips"
where total_amount is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [bronze].[testview_83c247fd7dcf1f459750c2de25501c63_14888]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [bronze].[testview_83c247fd7dcf1f459750c2de25501c63_14888]
  ;')
[0m20:12:21.410308 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:12:21.411122 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m20:12:21.720759 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m20:12:22.215635 [debug] [Thread-1 (]: SQL status: OK in 1.000 seconds
[0m20:12:22.217890 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae: ROLLBACK
[0m20:12:22.219167 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae: Close
[0m20:12:22.221010 [info ] [Thread-1 (]: 9 of 13 PASS not_null_stg_trips_total_amount ................................... [[32mPASS[0m in 0.85s]
[0m20:12:22.222046 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae
[0m20:12:22.222841 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b
[0m20:12:22.223673 [info ] [Thread-1 (]: 10 of 13 START test not_null_stg_trips_trip_distance ........................... [RUN]
[0m20:12:22.224532 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_stg_trips_total_amount.7d1537c3ae, now test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b)
[0m20:12:22.225213 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b
[0m20:12:22.229119 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b"
[0m20:12:22.242071 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b
[0m20:12:22.244825 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b"
[0m20:12:22.293555 [debug] [Thread-1 (]: Using sqlserver connection "test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b"
[0m20:12:22.294681 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b"} */

    -- Create target schema if it does not
  USE [sqldb-taxi-platform];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'bronze')
  BEGIN
    EXEC('CREATE SCHEMA [bronze]')
  END

  

  
  EXEC('create view 
    [bronze].[testview_98902cdd2f59126a71dede1190f25913_2173]
   as 
    
    
    



select trip_distance
from "sqldb-taxi-platform"."bronze_bronze"."stg_trips"
where trip_distance is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [bronze].[testview_98902cdd2f59126a71dede1190f25913_2173]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [bronze].[testview_98902cdd2f59126a71dede1190f25913_2173]
  ;')
[0m20:12:22.295747 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:12:22.296523 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m20:12:22.579309 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m20:12:23.299511 [debug] [Thread-1 (]: SQL status: OK in 1.000 seconds
[0m20:12:23.301625 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b: ROLLBACK
[0m20:12:23.302540 [debug] [Thread-1 (]: On test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b: Close
[0m20:12:23.304341 [info ] [Thread-1 (]: 10 of 13 PASS not_null_stg_trips_trip_distance ................................. [[32mPASS[0m in 1.08s]
[0m20:12:23.305308 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b
[0m20:12:23.306073 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6
[0m20:12:23.306932 [info ] [Thread-1 (]: 11 of 13 START test relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_  [RUN]
[0m20:12:23.308038 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.not_null_stg_trips_trip_distance.17ed75132b, now test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6)
[0m20:12:23.308818 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6
[0m20:12:23.315760 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6"
[0m20:12:23.330422 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6
[0m20:12:23.334497 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6"
[0m20:12:23.350316 [debug] [Thread-1 (]: Using sqlserver connection "test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6"
[0m20:12:23.351377 [debug] [Thread-1 (]: On test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6"} */

    -- Create target schema if it does not
  USE [sqldb-taxi-platform];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'bronze')
  BEGIN
    EXEC('CREATE SCHEMA [bronze]')
  END

  

  
  EXEC('create view 
    [bronze].[testview_fe69b692e4963f1fa2cf4dd07e39b696_16864]
   as 
    
    
    

with child as (
    select payment_type as from_field
    from "sqldb-taxi-platform"."bronze_silver"."fact_trips"
    where payment_type is not null
),

parent as (
    select payment_type as to_field
    from "sqldb-taxi-platform"."bronze_silver"."dim_payment_type"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [bronze].[testview_fe69b692e4963f1fa2cf4dd07e39b696_16864]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [bronze].[testview_fe69b692e4963f1fa2cf4dd07e39b696_16864]
  ;')
[0m20:12:23.352286 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:12:23.353008 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m20:12:23.630192 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m20:12:23.694587 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:12:23.697192 [debug] [Thread-1 (]: On test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6: ROLLBACK
[0m20:12:23.698691 [debug] [Thread-1 (]: On test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6: Close
[0m20:12:23.700895 [info ] [Thread-1 (]: 11 of 13 PASS relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_  [[32mPASS[0m in 0.39s]
[0m20:12:23.702161 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6
[0m20:12:23.703072 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58
[0m20:12:23.703789 [info ] [Thread-1 (]: 12 of 13 START test unique_dim_payment_type_payment_type ....................... [RUN]
[0m20:12:23.704738 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.relationships_fact_trips_payment_type__payment_type__ref_dim_payment_type_.fa2dfdd5c6, now test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58)
[0m20:12:23.705396 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58
[0m20:12:23.710850 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58"
[0m20:12:23.728476 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58
[0m20:12:23.731285 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58"
[0m20:12:23.745031 [debug] [Thread-1 (]: Using sqlserver connection "test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58"
[0m20:12:23.745934 [debug] [Thread-1 (]: On test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58"} */

    -- Create target schema if it does not
  USE [sqldb-taxi-platform];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'bronze')
  BEGIN
    EXEC('CREATE SCHEMA [bronze]')
  END

  

  
  EXEC('create view 
    [bronze].[testview_5fb5eb828135bf31fab7f64ef24093d1_10134]
   as 
    
    
    

select
    payment_type as unique_field,
    count(*) as n_records

from "sqldb-taxi-platform"."bronze_silver"."dim_payment_type"
where payment_type is not null
group by payment_type
having count(*) > 1



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [bronze].[testview_5fb5eb828135bf31fab7f64ef24093d1_10134]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [bronze].[testview_5fb5eb828135bf31fab7f64ef24093d1_10134]
  ;')
[0m20:12:23.746701 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:12:23.747423 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m20:12:24.028038 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m20:12:24.088728 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:12:24.091354 [debug] [Thread-1 (]: On test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58: ROLLBACK
[0m20:12:24.092632 [debug] [Thread-1 (]: On test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58: Close
[0m20:12:24.094772 [info ] [Thread-1 (]: 12 of 13 PASS unique_dim_payment_type_payment_type ............................. [[32mPASS[0m in 0.39s]
[0m20:12:24.095940 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58
[0m20:12:24.096756 [debug] [Thread-1 (]: Began running node test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e
[0m20:12:24.097728 [info ] [Thread-1 (]: 13 of 13 START test unique_fact_trips_trip_id .................................. [RUN]
[0m20:12:24.098566 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_nyc_project.unique_dim_payment_type_payment_type.6b71c22d58, now test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e)
[0m20:12:24.099328 [debug] [Thread-1 (]: Began compiling node test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e
[0m20:12:24.103180 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e"
[0m20:12:24.116178 [debug] [Thread-1 (]: Began executing node test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e
[0m20:12:24.119143 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e"
[0m20:12:24.132322 [debug] [Thread-1 (]: Using sqlserver connection "test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e"
[0m20:12:24.133374 [debug] [Thread-1 (]: On test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e: /* {"app": "dbt", "dbt_version": "1.10.0", "profile_name": "taxi_nyc_project", "target_name": "dev", "node_id": "test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e"} */

    -- Create target schema if it does not
  USE [sqldb-taxi-platform];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'bronze')
  BEGIN
    EXEC('CREATE SCHEMA [bronze]')
  END

  

  
  EXEC('create view 
    [bronze].[testview_2a9748c0e241ec04f816d7766bd33ba6_15550]
   as 
    
    
    

select
    trip_id as unique_field,
    count(*) as n_records

from "sqldb-taxi-platform"."bronze_silver"."fact_trips"
where trip_id is not null
group by trip_id
having count(*) > 1



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [bronze].[testview_2a9748c0e241ec04f816d7766bd33ba6_15550]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [bronze].[testview_2a9748c0e241ec04f816d7766bd33ba6_15550]
  ;')
[0m20:12:24.134322 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:12:24.135185 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=sqlserver-taxi-alex.database.windows.net,1433;Database=sqldb-taxi-platform;UID={sqladmin};PWD=***;encrypt=Yes;TrustServerCertificate=No;APP=dbt-sqlserver/1.9.0
[0m20:12:24.420806 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: sqldb-taxi-platform
[0m20:12:24.559155 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:12:24.561213 [debug] [Thread-1 (]: On test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e: ROLLBACK
[0m20:12:24.562211 [debug] [Thread-1 (]: On test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e: Close
[0m20:12:24.564123 [info ] [Thread-1 (]: 13 of 13 PASS unique_fact_trips_trip_id ........................................ [[32mPASS[0m in 0.47s]
[0m20:12:24.565028 [debug] [Thread-1 (]: Finished running node test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e
[0m20:12:24.566710 [debug] [MainThread]: On master: COMMIT
[0m20:12:24.567431 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:12:24.568107 [debug] [MainThread]: Connection 'test.taxi_nyc_project.unique_fact_trips_trip_id.689f42211e' was properly closed.
[0m20:12:24.568820 [info ] [MainThread]: 
[0m20:12:24.569497 [info ] [MainThread]: Finished running 13 data tests in 0 hours 0 minutes and 9.92 seconds (9.92s).
[0m20:12:24.571437 [debug] [MainThread]: Command end result
[0m20:12:24.600733 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m20:12:24.604672 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m20:12:24.612988 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m20:12:24.613807 [info ] [MainThread]: 
[0m20:12:24.614657 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:12:24.615369 [info ] [MainThread]: 
[0m20:12:24.616042 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=13
[0m20:12:24.617285 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 10.776956, "process_in_blocks": "1224", "process_kernel_time": 0.291638, "process_mem_max_rss": "135524", "process_out_blocks": "0", "process_user_time": 2.608547}
[0m20:12:24.618056 [debug] [MainThread]: Command `dbt test` succeeded at 20:12:24.617957 after 10.78 seconds
[0m20:12:24.618752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9e364d8110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9e320b11d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9e364d06d0>]}
[0m20:12:24.619536 [debug] [MainThread]: Flushing usage events
[0m20:12:25.161710 [debug] [MainThread]: An error was encountered while trying to flush usage events
